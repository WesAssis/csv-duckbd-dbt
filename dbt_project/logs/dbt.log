[0m00:27:58.532357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B6E24410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B6EA69D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B6EA6750>]}


============================== 00:27:58.556197 | 9ce88d87-ab0f-48aa-9a04-de0880f53efb ==============================
[0m00:27:58.556197 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:27:58.558193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:27:58.848534 [info ] [MainThread]: dbt version: 1.10.2
[0m00:27:58.848534 [info ] [MainThread]: python version: 3.11.9
[0m00:27:58.849517 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:27:58.850534 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:27:58.851525 [info ] [MainThread]: Using profiles dir at C:\Users\wes\.dbt
[0m00:27:58.852525 [info ] [MainThread]: Using profiles.yml file at C:\Users\wes\.dbt\profiles.yml
[0m00:27:58.853534 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:27:58.969838 [info ] [MainThread]: Configuration:
[0m00:27:58.970889 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m00:27:58.970889 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:27:58.972196 [info ] [MainThread]: Required dependencies:
[0m00:27:58.973170 [debug] [MainThread]: Executing "git --help"
[0m00:27:59.031939 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:27:59.032444 [debug] [MainThread]: STDERR: "b''"
[0m00:27:59.033448 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:27:59.034484 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:27:59.034484 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:27:59.035925 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\wes\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m00:27:59.036934 [debug] [MainThread]: Command `dbt debug` failed at 00:27:59.036934 after 0.64 seconds
[0m00:27:59.038114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B1D40B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B6E1AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B6E1BC10>]}
[0m00:27:59.038114 [debug] [MainThread]: Flushing usage events
[0m00:27:59.927706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:06.766259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D775327D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D775326290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7750B9F50>]}


============================== 00:29:06.769827 | a192ebbd-b10a-4412-81b1-1adb1b393af5 ==============================
[0m00:29:06.769827 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:06.770923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:06.787021 [info ] [MainThread]: dbt version: 1.10.2
[0m00:29:06.788324 [info ] [MainThread]: python version: 3.11.9
[0m00:29:06.788324 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:29:06.789446 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:29:06.790465 [info ] [MainThread]: Using profiles dir at .
[0m00:29:06.791613 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m00:29:06.792874 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:29:06.909623 [info ] [MainThread]: Configuration:
[0m00:29:06.910624 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m00:29:06.911885 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:29:06.912910 [info ] [MainThread]: Required dependencies:
[0m00:29:06.912910 [debug] [MainThread]: Executing "git --help"
[0m00:29:06.959425 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:29:06.960571 [debug] [MainThread]: STDERR: "b''"
[0m00:29:06.961587 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:29:06.962583 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:29:06.963581 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:29:06.964590 [info ] [MainThread]: dbt looked for a profiles.yml file in .\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m00:29:06.965591 [debug] [MainThread]: Command `dbt debug` failed at 00:29:06.965591 after 0.29 seconds
[0m00:29:06.967052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D773FD3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77359EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D773D0B110>]}
[0m00:29:06.968277 [debug] [MainThread]: Flushing usage events
[0m00:29:07.558687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:10.045703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A162617690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16697B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1669A4D50>]}


============================== 00:29:10.050690 | f6e9bbc0-9730-4088-81d5-4494d856ae09 ==============================
[0m00:29:10.050690 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:10.051692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:29:10.054278 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'duckdb_profile'
[0m00:29:10.055291 [debug] [MainThread]: Command `dbt seed` failed at 00:29:10.055291 after 0.10 seconds
[0m00:29:10.056674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1669A5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16692CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A166926A10>]}
[0m00:29:10.057692 [debug] [MainThread]: Flushing usage events
[0m00:29:10.600985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:13.040269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF7026C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF70A6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF70A5810>]}


============================== 00:29:13.043614 | 198727a5-aff8-470d-b4b8-f73f36f61a45 ==============================
[0m00:29:13.043614 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:13.045603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:13.047613 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'duckdb_profile'
[0m00:29:13.049614 [debug] [MainThread]: Command `dbt run` failed at 00:29:13.049614 after 0.09 seconds
[0m00:29:13.049614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF70A7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF702CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF7026A10>]}
[0m00:29:13.050960 [debug] [MainThread]: Flushing usage events
[0m00:29:13.614457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:51.163210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBADB60AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBADB26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBADB1B790>]}


============================== 00:29:51.167218 | 6cc8b19d-105e-4c0c-b0bd-09a03fa14768 ==============================
[0m00:29:51.167218 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:51.168218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:29:51.188636 [info ] [MainThread]: dbt version: 1.10.2
[0m00:29:51.189636 [info ] [MainThread]: python version: 3.11.9
[0m00:29:51.190646 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:29:51.191644 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:29:51.197056 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m00:29:51.198073 [info ] [MainThread]: Using profiles dir at .
[0m00:29:51.199056 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m00:29:51.200074 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:29:51.312346 [info ] [MainThread]: Configuration:
[0m00:29:51.313343 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:29:51.314352 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:29:51.315345 [info ] [MainThread]: Required dependencies:
[0m00:29:51.315345 [debug] [MainThread]: Executing "git --help"
[0m00:29:51.357300 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:29:51.357844 [debug] [MainThread]: STDERR: "b''"
[0m00:29:51.358847 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:29:51.358847 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:29:51.360249 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:29:51.361270 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "duckdb_profile", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!


[0m00:29:51.363705 [debug] [MainThread]: Command `dbt debug` failed at 00:29:51.363705 after 0.31 seconds
[0m00:29:51.363705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAD7D3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBADB1B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBADB1BF90>]}
[0m00:29:51.364717 [debug] [MainThread]: Flushing usage events
[0m00:29:51.940129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:54.397539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396F63E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396F9FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396F9E5D0>]}


============================== 00:29:54.401546 | 53f113c1-5063-4a75-8824-ddecf38a6b29 ==============================
[0m00:29:54.401546 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:54.403629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:29:54.407109 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m00:29:54.408186 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "duckdb_profile", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m00:29:54.410753 [debug] [MainThread]: Command `dbt seed` failed at 00:29:54.410753 after 0.11 seconds
[0m00:29:54.411740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396F2CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396FA6DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396FA6CD0>]}
[0m00:29:54.411740 [debug] [MainThread]: Flushing usage events
[0m00:29:55.136579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:57.575616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0D46CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0D825D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0DBFD50>]}


============================== 00:29:57.579780 | f7d0a741-323d-4d61-a775-f8497900913d ==============================
[0m00:29:57.579780 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:57.580813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:57.585814 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m00:29:57.586812 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "duckdb_profile", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m00:29:57.587797 [debug] [MainThread]: Command `dbt run` failed at 00:29:57.587797 after 0.10 seconds
[0m00:29:57.589217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0D46A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0D46290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD0DC5810>]}
[0m00:29:57.589217 [debug] [MainThread]: Flushing usage events
[0m00:29:58.322405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:52.511512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AC124890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AC124850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AC19F510>]}


============================== 00:30:52.517534 | e563c8f1-1a7f-46b8-8f7b-1f66083c879b ==============================
[0m00:30:52.517534 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:30:52.519638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:30:52.555990 [info ] [MainThread]: dbt version: 1.10.2
[0m00:30:52.555990 [info ] [MainThread]: python version: 3.11.9
[0m00:30:52.556988 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:30:52.559045 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:30:52.841131 [info ] [MainThread]: Using profiles dir at .
[0m00:30:52.842109 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m00:30:52.843367 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:30:52.873921 [info ] [MainThread]: adapter type: duckdb
[0m00:30:52.874903 [info ] [MainThread]: adapter version: 1.9.4
[0m00:30:52.984722 [info ] [MainThread]: Configuration:
[0m00:30:52.985722 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:30:52.986701 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:30:52.987701 [info ] [MainThread]: Required dependencies:
[0m00:30:52.988721 [debug] [MainThread]: Executing "git --help"
[0m00:30:53.048564 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:30:53.049562 [debug] [MainThread]: STDERR: "b''"
[0m00:30:53.050595 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:30:53.050595 [info ] [MainThread]: Connection:
[0m00:30:53.051612 [info ] [MainThread]:   database: database
[0m00:30:53.052612 [info ] [MainThread]:   schema: main
[0m00:30:53.052612 [info ] [MainThread]:   path: ../duckdb/database.duckdb
[0m00:30:53.054040 [info ] [MainThread]:   config_options: None
[0m00:30:53.055516 [info ] [MainThread]:   extensions: None
[0m00:30:53.056521 [info ] [MainThread]:   settings: {}
[0m00:30:53.056521 [info ] [MainThread]:   external_root: .
[0m00:30:53.057513 [info ] [MainThread]:   use_credential_provider: None
[0m00:30:53.058526 [info ] [MainThread]:   attach: None
[0m00:30:53.060524 [info ] [MainThread]:   filesystems: None
[0m00:30:53.061516 [info ] [MainThread]:   remote: None
[0m00:30:53.062525 [info ] [MainThread]:   plugins: None
[0m00:30:53.063530 [info ] [MainThread]:   disable_transactions: False
[0m00:30:53.065518 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:30:53.403945 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:30:56.983536 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:30:56.984538 [debug] [MainThread]: On debug: select 1 as id
[0m00:30:56.984538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:30:57.066568 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m00:30:57.066568 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m00:30:57.067576 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:30:57.068587 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:30:57.069584 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: The file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb" exists, but it is not a valid DuckDB database file!

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:30:57.071870 [debug] [MainThread]: Command `dbt debug` failed at 00:30:57.071870 after 4.65 seconds
[0m00:30:57.071870 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:30:57.072871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AC124850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AAECE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AC5E0950>]}
[0m00:30:57.073872 [debug] [MainThread]: Flushing usage events
[0m00:30:57.667934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:00.202790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3D25F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3D26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3074310>]}


============================== 00:31:00.207183 | 82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7 ==============================
[0m00:31:00.207183 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:31:00.209188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:00.489962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3DEA950>]}
[0m00:31:00.558554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CEA35E50>]}
[0m00:31:00.560558 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:31:01.020716 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:31:01.021953 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:31:01.022690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3FBD010>]}
[0m00:31:03.442782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D4010290>]}
[0m00:31:03.503041 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:03.507689 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:03.590767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D45B6010>]}
[0m00:31:03.591868 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:31:03.592868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82dd8cdb-d773-47b2-bb28-d0cc2fb25ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3D248D0>]}
[0m00:31:03.595543 [info ] [MainThread]: 
[0m00:31:03.597819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:03.599049 [info ] [MainThread]: 
[0m00:31:03.600307 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:31:03.602325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:31:03.676485 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:31:03.676485 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:03.677487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:03.686458 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:03.686458 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:31:03.687477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:03.688485 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m00:31:03.688485 [info ] [MainThread]: 
[0m00:31:03.689480 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m00:31:03.690476 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: The file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb" exists, but it is not a valid DuckDB database file!
[0m00:31:03.692486 [debug] [MainThread]: Command `dbt seed` failed at 00:31:03.692486 after 3.58 seconds
[0m00:31:03.693478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3D2D410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3DA72D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3DA6D90>]}
[0m00:31:03.693478 [debug] [MainThread]: Flushing usage events
[0m00:31:04.254561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:06.812178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB2A4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB226290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB29FD50>]}


============================== 00:31:06.816180 | e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7 ==============================
[0m00:31:06.816180 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:31:06.818191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:31:07.050082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB437A50>]}
[0m00:31:07.116850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5EE5950>]}
[0m00:31:07.120117 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:31:07.390648 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:31:07.556324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:07.556324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:07.588840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB791910>]}
[0m00:31:07.648693 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:07.650701 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:07.672441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB8D5310>]}
[0m00:31:07.672441 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:31:07.673429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86ced5d-4ece-48a6-bb69-d0d5fbf57aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB224690>]}
[0m00:31:07.675447 [info ] [MainThread]: 
[0m00:31:07.676432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:07.676432 [info ] [MainThread]: 
[0m00:31:07.678534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:31:07.679638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:31:07.752903 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:31:07.752903 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:07.753903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:07.761781 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:07.761781 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:31:07.763776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:07.763776 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m00:31:07.764755 [info ] [MainThread]: 
[0m00:31:07.764755 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m00:31:07.765767 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: The file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb" exists, but it is not a valid DuckDB database file!
[0m00:31:07.767758 [debug] [MainThread]: Command `dbt run` failed at 00:31:07.766776 after 1.04 seconds
[0m00:31:07.767758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB22D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB2A74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB9A8110>]}
[0m00:31:07.768759 [debug] [MainThread]: Flushing usage events
[0m00:31:08.326257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:48.740958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B09525710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0951B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0959FDD0>]}


============================== 00:31:48.745440 | 36f5ae85-0372-41f9-ad46-1796d9e7d8b5 ==============================
[0m00:31:48.745440 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:31:48.747424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:48.762942 [info ] [MainThread]: dbt version: 1.10.2
[0m00:31:48.763970 [info ] [MainThread]: python version: 3.11.9
[0m00:31:48.765960 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:31:48.766969 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:31:48.853673 [info ] [MainThread]: Using profiles dir at .
[0m00:31:48.855664 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m00:31:48.855664 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:31:48.858672 [info ] [MainThread]: adapter type: duckdb
[0m00:31:48.859673 [info ] [MainThread]: adapter version: 1.9.4
[0m00:31:48.969525 [info ] [MainThread]: Configuration:
[0m00:31:48.971534 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:31:48.972513 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:31:48.973535 [info ] [MainThread]: Required dependencies:
[0m00:31:48.974525 [debug] [MainThread]: Executing "git --help"
[0m00:31:49.010729 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:31:49.011725 [debug] [MainThread]: STDERR: "b''"
[0m00:31:49.011725 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:31:49.012735 [info ] [MainThread]: Connection:
[0m00:31:49.014711 [info ] [MainThread]:   database: database
[0m00:31:49.015718 [info ] [MainThread]:   schema: main
[0m00:31:49.017721 [info ] [MainThread]:   path: ../duckdb/database.duckdb
[0m00:31:49.018722 [info ] [MainThread]:   config_options: None
[0m00:31:49.019724 [info ] [MainThread]:   extensions: None
[0m00:31:49.019724 [info ] [MainThread]:   settings: {}
[0m00:31:49.020715 [info ] [MainThread]:   external_root: .
[0m00:31:49.021728 [info ] [MainThread]:   use_credential_provider: None
[0m00:31:49.022726 [info ] [MainThread]:   attach: None
[0m00:31:49.022726 [info ] [MainThread]:   filesystems: None
[0m00:31:49.023726 [info ] [MainThread]:   remote: None
[0m00:31:49.024719 [info ] [MainThread]:   plugins: None
[0m00:31:49.025730 [info ] [MainThread]:   disable_transactions: False
[0m00:31:49.026727 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:31:49.287632 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:31:49.346986 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:31:49.348316 [debug] [MainThread]: On debug: select 1 as id
[0m00:31:49.348316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:49.408861 [debug] [MainThread]: SQL status: OK in 0.060 seconds
[0m00:31:49.409881 [debug] [MainThread]: On debug: Close
[0m00:31:49.409881 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:31:49.410884 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:31:49.413223 [debug] [MainThread]: Command `dbt debug` succeeded at 00:31:49.413223 after 0.76 seconds
[0m00:31:49.414237 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:31:49.415238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B09D74C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B034300D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B03430050>]}
[0m00:31:49.415238 [debug] [MainThread]: Flushing usage events
[0m00:31:49.977928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:52.494897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35225FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3529FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3529FD50>]}


============================== 00:31:52.498266 | 7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5 ==============================
[0m00:31:52.498266 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:31:52.500422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:31:52.734364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3538E1D0>]}
[0m00:31:52.804509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2FF25010>]}
[0m00:31:52.806601 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:31:53.068250 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:31:53.182606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:53.183609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:53.214652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3584C650>]}
[0m00:31:53.271968 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:53.275372 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:53.295622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35927A50>]}
[0m00:31:53.296000 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:31:53.297039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB352EAE90>]}
[0m00:31:53.299030 [info ] [MainThread]: 
[0m00:31:53.299778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:53.301114 [info ] [MainThread]: 
[0m00:31:53.302121 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:31:53.303117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:31:53.378428 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:31:53.379426 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:53.379426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:53.432034 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m00:31:53.434034 [debug] [ThreadPool]: On list_database: Close
[0m00:31:53.434034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:31:53.435265 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:31:53.441591 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:53.442612 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:31:53.442612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:53.444953 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:31:53.447015 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:53.448030 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:31:53.449025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:53.449025 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:53.450016 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:31:53.451561 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:31:53.452067 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:31:53.453075 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:53.454076 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:31:53.454076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:53.455077 [debug] [ThreadPool]: On create_database_main: Close
[0m00:31:53.460600 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:31:53.466015 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:31:53.467054 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:31:53.467054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:53.468518 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:31:53.468518 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:31:53.469512 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:31:53.494311 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m00:31:53.495317 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:31:53.497315 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:31:53.497315 [debug] [ThreadPool]: On list_database_main: Close
[0m00:31:53.499542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB354BD450>]}
[0m00:31:53.500562 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:53.500562 [debug] [MainThread]: On master: BEGIN
[0m00:31:53.500562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:53.501562 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:31:53.502561 [debug] [MainThread]: On master: COMMIT
[0m00:31:53.502561 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:53.502561 [debug] [MainThread]: On master: COMMIT
[0m00:31:53.503569 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:53.504571 [debug] [MainThread]: On master: Close
[0m00:31:53.514558 [debug] [Thread-1 (]: Began running node seed.dbt_project.input
[0m00:31:53.515579 [info ] [Thread-1 (]: 1 of 1 START seed file main.input .............................................. [RUN]
[0m00:31:53.516587 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.dbt_project.input'
[0m00:31:53.517577 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.input
[0m00:31:53.517577 [debug] [Thread-1 (]: Began executing node seed.dbt_project.input
[0m00:31:53.580020 [debug] [Thread-1 (]: Compilation Error in seed input (seeds\input.csv)
  value was undefined because a callable raised a StopIteration exception
[0m00:31:53.591547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f9f1cea-1ccd-47aa-be8b-eb5a246f4af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35CC0E10>]}
[0m00:31:53.594006 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.input ...................................... [[31mERROR[0m in 0.06s]
[0m00:31:53.595049 [debug] [Thread-1 (]: Finished running node seed.dbt_project.input
[0m00:31:53.596085 [debug] [Thread-4 (]: Marking all children of 'seed.dbt_project.input' to be skipped because of status 'error'.  Reason: Compilation Error in seed input (seeds\input.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m00:31:53.598075 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:53.598075 [debug] [MainThread]: On master: BEGIN
[0m00:31:53.599084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:53.600204 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:31:53.601247 [debug] [MainThread]: On master: COMMIT
[0m00:31:53.602237 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:53.602237 [debug] [MainThread]: On master: COMMIT
[0m00:31:53.603251 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:53.604232 [debug] [MainThread]: On master: Close
[0m00:31:53.605516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:53.605516 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:31:53.606519 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:31:53.606519 [debug] [MainThread]: Connection 'seed.dbt_project.input' was properly closed.
[0m00:31:53.607538 [info ] [MainThread]: 
[0m00:31:53.607538 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m00:31:53.609538 [debug] [MainThread]: Command end result
[0m00:31:53.693042 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:53.695049 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:53.701772 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:31:53.701772 [info ] [MainThread]: 
[0m00:31:53.702783 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:31:53.703783 [info ] [MainThread]: 
[0m00:31:53.706073 [error] [MainThread]: [31mFailure in seed input (seeds\input.csv)[0m
[0m00:31:53.706073 [error] [MainThread]:   Compilation Error in seed input (seeds\input.csv)
  value was undefined because a callable raised a StopIteration exception
[0m00:31:53.707070 [info ] [MainThread]: 
[0m00:31:53.708072 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:53.710082 [debug] [MainThread]: Command `dbt seed` failed at 00:31:53.710082 after 1.30 seconds
[0m00:31:53.711070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35E21E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35E23CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35E23010>]}
[0m00:31:53.711070 [debug] [MainThread]: Flushing usage events
[0m00:31:54.262242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:56.792849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644B61DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644B9F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644B9F450>]}


============================== 00:31:56.796474 | 8c543319-2600-47da-b58b-76bb596d8cb7 ==============================
[0m00:31:56.796474 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:31:56.798931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:57.028574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644BF9610>]}
[0m00:31:57.095858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163F894A50>]}
[0m00:31:57.098915 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:31:57.358242 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:31:57.472774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:57.473780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:57.505988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021646091E50>]}
[0m00:31:57.564920 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:57.567939 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:57.589631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216461D5E90>]}
[0m00:31:57.589631 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:31:57.590927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644B24690>]}
[0m00:31:57.592382 [info ] [MainThread]: 
[0m00:31:57.593421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:57.594899 [info ] [MainThread]: 
[0m00:31:57.596143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:31:57.597352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:31:57.671600 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:31:57.672598 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:31:57.673597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:57.691758 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m00:31:57.693619 [debug] [ThreadPool]: On list_database: Close
[0m00:31:57.694619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:31:57.695600 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:31:57.701836 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:57.702877 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:31:57.702877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:57.704867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:31:57.705867 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:57.706876 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:31:57.706876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:57.707867 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:57.707867 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:31:57.708868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:57.710900 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:31:57.711251 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:31:57.711251 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:31:57.712285 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:57.713340 [debug] [ThreadPool]: On create_database_main: Close
[0m00:31:57.718865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:31:57.723333 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:31:57.724375 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:31:57.724375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:57.725355 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:31:57.725355 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:31:57.725355 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:31:57.741387 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:31:57.742388 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:31:57.743551 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:31:57.744784 [debug] [ThreadPool]: On list_database_main: Close
[0m00:31:57.744784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644BF2750>]}
[0m00:31:57.745937 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:57.746938 [debug] [MainThread]: On master: BEGIN
[0m00:31:57.746938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:57.747928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:31:57.748920 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.748920 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:57.749918 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.749918 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:57.750917 [debug] [MainThread]: On master: Close
[0m00:31:57.756065 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m00:31:57.757078 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m00:31:57.759072 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m00:31:57.759072 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m00:31:57.766456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m00:31:57.768796 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m00:31:57.797515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m00:31:57.801398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:31:57.802427 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m00:31:57.802427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:57.803427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:57.804436 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:31:57.804436 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      -- modelo chamado resultado
SELECT
    *,
    UPPER(column1) AS coluna_maiuscula
FROM "database"."main"."input"
    );
  
  
[0m00:31:57.813983 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      -- modelo chamado resultado
SELECT
    *,
    UPPER(column1) AS coluna_maiuscula
FROM "database"."main"."input"
    );
  
  
[0m00:31:57.814994 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:31:57.814994 [debug] [Thread-1 (]: On model.dbt_project.transform: ROLLBACK
[0m00:31:57.823405 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.transform'
[0m00:31:57.823405 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m00:31:57.825947 [debug] [Thread-1 (]: Runtime Error in model transform (models\transform\transform.sql)
  Catalog Error: Table with name input does not exist!
  Did you mean "pg_catalog.pg_enum"?
  
  LINE 15: FROM "database"."main"."input"
                ^
[0m00:31:57.827987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c543319-2600-47da-b58b-76bb596d8cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644BEAF50>]}
[0m00:31:57.828987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform ........................... [[31mERROR[0m in 0.07s]
[0m00:31:57.830965 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m00:31:57.831960 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models\transform\transform.sql)
  Catalog Error: Table with name input does not exist!
  Did you mean "pg_catalog.pg_enum"?
  
  LINE 15: FROM "database"."main"."input"
                ^.
[0m00:31:57.834980 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:57.834980 [debug] [MainThread]: On master: BEGIN
[0m00:31:57.835980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:57.836973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:31:57.837969 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.837969 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:57.838968 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.839968 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:57.839968 [debug] [MainThread]: On master: Close
[0m00:31:57.840978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:57.840978 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:31:57.841969 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:31:57.841969 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m00:31:57.842982 [info ] [MainThread]: 
[0m00:31:57.842982 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:31:57.844369 [debug] [MainThread]: Command end result
[0m00:31:57.941739 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:31:57.944741 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:31:57.950092 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:31:57.951104 [info ] [MainThread]: 
[0m00:31:57.952099 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:31:57.952099 [info ] [MainThread]: 
[0m00:31:57.953093 [error] [MainThread]: [31mFailure in model transform (models\transform\transform.sql)[0m
[0m00:31:57.956434 [error] [MainThread]:   Runtime Error in model transform (models\transform\transform.sql)
  Catalog Error: Table with name input does not exist!
  Did you mean "pg_catalog.pg_enum"?
  
  LINE 15: FROM "database"."main"."input"
                ^
[0m00:31:57.957461 [info ] [MainThread]: 
[0m00:31:57.957461 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\transform\transform.sql
[0m00:31:57.958539 [info ] [MainThread]: 
[0m00:31:57.959557 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:57.960540 [debug] [MainThread]: Command `dbt run` failed at 00:31:57.960540 after 1.25 seconds
[0m00:31:57.961916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021642E74710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021646580390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021646582690>]}
[0m00:31:57.961916 [debug] [MainThread]: Flushing usage events
[0m00:31:58.571560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:54.546324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FA59FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FA59EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FA59F750>]}


============================== 00:34:54.550339 | 701ffa63-70c1-4991-b7b9-fba930c63b8a ==============================
[0m00:34:54.550339 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:34:54.551352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:34:54.566123 [info ] [MainThread]: dbt version: 1.10.2
[0m00:34:54.566123 [info ] [MainThread]: python version: 3.11.9
[0m00:34:54.567545 [info ] [MainThread]: python path: C:\Users\wes\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:34:54.568544 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:34:54.655825 [info ] [MainThread]: Using profiles dir at .
[0m00:34:54.656799 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m00:34:54.657818 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m00:34:54.660797 [info ] [MainThread]: adapter type: duckdb
[0m00:34:54.661655 [info ] [MainThread]: adapter version: 1.9.4
[0m00:34:54.774222 [info ] [MainThread]: Configuration:
[0m00:34:54.775222 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:34:54.776488 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:34:54.777482 [info ] [MainThread]: Required dependencies:
[0m00:34:54.778499 [debug] [MainThread]: Executing "git --help"
[0m00:34:54.823395 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:34:54.823395 [debug] [MainThread]: STDERR: "b''"
[0m00:34:54.824909 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:34:54.825903 [info ] [MainThread]: Connection:
[0m00:34:54.827073 [info ] [MainThread]:   database: database
[0m00:34:54.828117 [info ] [MainThread]:   schema: main
[0m00:34:54.829136 [info ] [MainThread]:   path: ../duckdb/database.duckdb
[0m00:34:54.829136 [info ] [MainThread]:   config_options: None
[0m00:34:54.830439 [info ] [MainThread]:   extensions: None
[0m00:34:54.831641 [info ] [MainThread]:   settings: {}
[0m00:34:54.832660 [info ] [MainThread]:   external_root: .
[0m00:34:54.833651 [info ] [MainThread]:   use_credential_provider: None
[0m00:34:54.834654 [info ] [MainThread]:   attach: None
[0m00:34:54.836025 [info ] [MainThread]:   filesystems: None
[0m00:34:54.836025 [info ] [MainThread]:   remote: None
[0m00:34:54.837494 [info ] [MainThread]:   plugins: None
[0m00:34:54.838499 [info ] [MainThread]:   disable_transactions: False
[0m00:34:54.839501 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:34:55.112154 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:34:55.172402 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:34:55.172402 [debug] [MainThread]: On debug: select 1 as id
[0m00:34:55.173381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:55.188640 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m00:34:55.190640 [debug] [MainThread]: On debug: Close
[0m00:34:55.190640 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:34:55.191632 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:34:55.192640 [debug] [MainThread]: Command `dbt debug` succeeded at 00:34:55.192640 after 0.73 seconds
[0m00:34:55.193948 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:34:55.193948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FAD74410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FA5624D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FA9F01D0>]}
[0m00:34:55.193948 [debug] [MainThread]: Flushing usage events
[0m00:34:55.840055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:58.408055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73C62490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73C26310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73C60A90>]}


============================== 00:34:58.412975 | 78e12031-319c-47a9-ae0c-93d5d13c0bb1 ==============================
[0m00:34:58.412975 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:34:58.414982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:34:58.649411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73CEB950>]}
[0m00:34:58.720189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6E974810>]}
[0m00:34:58.722549 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:34:58.991265 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:34:59.146490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:59.147474 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m00:34:59.385604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7536C590>]}
[0m00:34:59.441951 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:34:59.445457 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:34:59.465911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7550CB50>]}
[0m00:34:59.467311 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:34:59.468807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7540B710>]}
[0m00:34:59.470915 [info ] [MainThread]: 
[0m00:34:59.471927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:59.472341 [info ] [MainThread]: 
[0m00:34:59.473374 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:59.474371 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:34:59.609381 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:34:59.609381 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:34:59.610396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:59.628010 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m00:34:59.630013 [debug] [ThreadPool]: On list_database: Close
[0m00:34:59.631010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:34:59.631010 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:34:59.637634 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:34:59.638636 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:34:59.638636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:59.640628 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:34:59.641619 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:34:59.642830 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:34:59.642830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:59.643863 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:34:59.643863 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:34:59.644846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:59.645919 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:34:59.646944 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:34:59.646944 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:34:59.648025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:59.648025 [debug] [ThreadPool]: On create_database_main: Close
[0m00:34:59.653308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:34:59.658396 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:34:59.659396 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:34:59.660383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:59.661374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:59.662374 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:34:59.662374 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:34:59.677453 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:34:59.678492 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:34:59.679492 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:34:59.680481 [debug] [ThreadPool]: On list_database_main: Close
[0m00:34:59.681493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73E0D090>]}
[0m00:34:59.682492 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:59.683480 [debug] [MainThread]: On master: BEGIN
[0m00:34:59.683480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:59.684487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:59.685610 [debug] [MainThread]: On master: COMMIT
[0m00:34:59.685610 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:59.686647 [debug] [MainThread]: On master: COMMIT
[0m00:34:59.686647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:59.687645 [debug] [MainThread]: On master: Close
[0m00:34:59.692643 [debug] [Thread-1 (]: Began running node seed.dbt_project.input
[0m00:34:59.693639 [info ] [Thread-1 (]: 1 of 1 START seed file main.input .............................................. [RUN]
[0m00:34:59.695633 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.dbt_project.input'
[0m00:34:59.696641 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.input
[0m00:34:59.696641 [debug] [Thread-1 (]: Began executing node seed.dbt_project.input
[0m00:34:59.721681 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.input"
[0m00:34:59.722671 [debug] [Thread-1 (]: On seed.dbt_project.input: BEGIN
[0m00:34:59.722671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:59.725064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:59.726080 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.input"
[0m00:34:59.727090 [debug] [Thread-1 (]: On seed.dbt_project.input: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "seed.dbt_project.input"} */

    create table "database"."main"."input" ("column1" text,"column2" integer,"column3" text)
  
[0m00:34:59.731755 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:59.742468 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.input"
[0m00:34:59.743475 [debug] [Thread-1 (]: On seed.dbt_project.input: 
          COPY "database"."main"."input" FROM 'D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\seeds\input.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:34:59.769307 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m00:34:59.773337 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.input"
[0m00:34:59.788862 [debug] [Thread-1 (]: On seed.dbt_project.input: COMMIT
[0m00:34:59.789862 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.input"
[0m00:34:59.789862 [debug] [Thread-1 (]: On seed.dbt_project.input: COMMIT
[0m00:34:59.811219 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:59.813363 [debug] [Thread-1 (]: On seed.dbt_project.input: Close
[0m00:34:59.815606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e12031-319c-47a9-ae0c-93d5d13c0bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73ECBF50>]}
[0m00:34:59.816605 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.input .......................................... [[32mINSERT 2[0m in 0.12s]
[0m00:34:59.818602 [debug] [Thread-1 (]: Finished running node seed.dbt_project.input
[0m00:34:59.821141 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:59.822199 [debug] [MainThread]: On master: BEGIN
[0m00:34:59.822199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:59.823915 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:59.823915 [debug] [MainThread]: On master: COMMIT
[0m00:34:59.824951 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:59.825968 [debug] [MainThread]: On master: COMMIT
[0m00:34:59.827086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:59.827086 [debug] [MainThread]: On master: Close
[0m00:34:59.828099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:59.828099 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:34:59.828099 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:34:59.829079 [debug] [MainThread]: Connection 'seed.dbt_project.input' was properly closed.
[0m00:34:59.829079 [info ] [MainThread]: 
[0m00:34:59.830089 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m00:34:59.831090 [debug] [MainThread]: Command end result
[0m00:34:59.851093 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:34:59.854170 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:34:59.859189 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:34:59.860223 [info ] [MainThread]: 
[0m00:34:59.860223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:59.861591 [info ] [MainThread]: 
[0m00:34:59.861591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:34:59.863721 [debug] [MainThread]: Command `dbt seed` succeeded at 00:34:59.863721 after 1.55 seconds
[0m00:34:59.863721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB738E4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73DABB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DBE0050>]}
[0m00:34:59.865111 [debug] [MainThread]: Flushing usage events
[0m00:35:00.423595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:35:03.030117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61EE36A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61EE725D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61EE70E10>]}


============================== 00:35:03.034127 | c99155da-22b6-49fc-a93d-f5ed5a08629c ==============================
[0m00:35:03.034127 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:35:03.035068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:35:03.268313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D620002D10>]}
[0m00:35:03.333730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61ABB5B10>]}
[0m00:35:03.336759 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:35:03.594110 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:35:03.737423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:35:03.738414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:35:03.770816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D62052FDD0>]}
[0m00:35:03.828360 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:35:03.831365 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:35:03.850348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D62012CF10>]}
[0m00:35:03.851348 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:35:03.852358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D62054C750>]}
[0m00:35:03.854364 [info ] [MainThread]: 
[0m00:35:03.855361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:35:03.855361 [info ] [MainThread]: 
[0m00:35:03.856354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:35:03.857359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:35:03.929840 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:35:03.929840 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:35:03.930830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:03.958894 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:35:03.960885 [debug] [ThreadPool]: On list_database: Close
[0m00:35:03.961886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:35:03.962893 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:35:03.970259 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:35:03.970259 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:35:03.971268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:35:03.973257 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:35:03.974257 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:35:03.975268 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:35:03.976267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:35:03.976267 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:35:03.977258 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:35:03.978267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:35:03.979267 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:35:03.979267 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:35:03.980236 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:35:03.980236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:35:03.981260 [debug] [ThreadPool]: On create_database_main: Close
[0m00:35:03.987127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:35:03.993152 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:35:03.994155 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:35:03.994155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:03.995160 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:35:03.995160 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:35:03.996154 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:35:04.010929 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:35:04.012957 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:35:04.013971 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:35:04.014970 [debug] [ThreadPool]: On list_database_main: Close
[0m00:35:04.015973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61EEB45D0>]}
[0m00:35:04.016957 [debug] [MainThread]: Using duckdb connection "master"
[0m00:35:04.016957 [debug] [MainThread]: On master: BEGIN
[0m00:35:04.017959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:35:04.018966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:35:04.018966 [debug] [MainThread]: On master: COMMIT
[0m00:35:04.018966 [debug] [MainThread]: Using duckdb connection "master"
[0m00:35:04.019978 [debug] [MainThread]: On master: COMMIT
[0m00:35:04.020981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:35:04.020981 [debug] [MainThread]: On master: Close
[0m00:35:04.025967 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m00:35:04.027481 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m00:35:04.028497 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m00:35:04.029507 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m00:35:04.036512 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m00:35:04.037506 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m00:35:04.066602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m00:35:04.067597 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:35:04.068785 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m00:35:04.069792 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:35:04.070797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:35:04.070797 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:35:04.071798 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      -- modelo chamado resultado
SELECT
    *,
    UPPER(column1) AS coluna_maiuscula
FROM "database"."main"."input"
    );
  
  
[0m00:35:04.075767 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:35:04.082037 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:35:04.082037 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m00:35:04.086037 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:35:04.098036 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m00:35:04.099040 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:35:04.100020 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m00:35:04.117752 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:35:04.124752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:35:04.124752 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m00:35:04.127261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:35:04.129270 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m00:35:04.131271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99155da-22b6-49fc-a93d-f5ed5a08629c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D62012C250>]}
[0m00:35:04.132270 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.10s]
[0m00:35:04.134412 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m00:35:04.136430 [debug] [MainThread]: Using duckdb connection "master"
[0m00:35:04.136430 [debug] [MainThread]: On master: BEGIN
[0m00:35:04.137487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:35:04.137487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:35:04.138488 [debug] [MainThread]: On master: COMMIT
[0m00:35:04.138488 [debug] [MainThread]: Using duckdb connection "master"
[0m00:35:04.139480 [debug] [MainThread]: On master: COMMIT
[0m00:35:04.140576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:35:04.140576 [debug] [MainThread]: On master: Close
[0m00:35:04.141585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:04.142586 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:35:04.142586 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:35:04.143598 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m00:35:04.143598 [info ] [MainThread]: 
[0m00:35:04.144722 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:35:04.144722 [debug] [MainThread]: Command end result
[0m00:35:04.225350 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:35:04.227362 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:35:04.234751 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:35:04.234751 [info ] [MainThread]: 
[0m00:35:04.236059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:35:04.236059 [info ] [MainThread]: 
[0m00:35:04.237408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:35:04.238507 [debug] [MainThread]: Command `dbt run` succeeded at 00:35:04.238507 after 1.30 seconds
[0m00:35:04.238507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D619DA5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D619D90050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61D833D90>]}
[0m00:35:04.239547 [debug] [MainThread]: Flushing usage events
[0m00:35:04.808296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:30.469658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE9EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE9F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B89F67D0>]}


============================== 00:46:30.478063 | 698df897-32d9-4c27-a5ea-b82267b188ad ==============================
[0m00:46:30.478063 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:46:30.483077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m00:46:30.854887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698df897-32d9-4c27-a5ea-b82267b188ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BC7BA210>]}
[0m00:46:30.923492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698df897-32d9-4c27-a5ea-b82267b188ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B8B55990>]}
[0m00:46:30.928081 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:46:31.391842 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:46:31.575800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:46:31.576779 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m00:46:31.804922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698df897-32d9-4c27-a5ea-b82267b188ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BE3236D0>]}
[0m00:46:31.869518 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:46:31.874230 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:46:31.923901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698df897-32d9-4c27-a5ea-b82267b188ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BE70CA90>]}
[0m00:46:31.926120 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:46:31.927121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698df897-32d9-4c27-a5ea-b82267b188ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE24710>]}
[0m00:46:31.929933 [info ] [MainThread]: 
[0m00:46:31.931046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:46:31.932150 [info ] [MainThread]: 
[0m00:46:31.933163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:46:31.934944 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:46:32.081435 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:46:32.081435 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:46:32.082435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:32.453508 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:46:32.454014 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:46:32.455022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:32.456241 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m00:46:32.456241 [info ] [MainThread]: 
[0m00:46:32.457260 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m00:46:32.459716 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 24940)
[0m00:46:32.460869 [debug] [MainThread]: Command `dbt seed` failed at 00:46:32.460869 after 2.09 seconds
[0m00:46:32.461864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE2D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE9F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233BCE9F850>]}
[0m00:46:32.461864 [debug] [MainThread]: Flushing usage events
[0m00:46:33.347153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:24.371279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C30D9F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C30D61E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C30D62810>]}


============================== 00:48:24.375285 | 87637445-b9e5-473e-ad0a-0ded85c9b098 ==============================
[0m00:48:24.375285 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:48:24.377286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:48:24.628613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C306B8890>]}
[0m00:48:24.695186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2B9E5210>]}
[0m00:48:24.697187 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:48:24.978200 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:48:25.134454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:48:25.135454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:48:25.169644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C312F1B50>]}
[0m00:48:25.232352 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:48:25.234392 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:48:25.254978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3121F590>]}
[0m00:48:25.255959 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:48:25.256960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3126E910>]}
[0m00:48:25.258146 [info ] [MainThread]: 
[0m00:48:25.259654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:48:25.259654 [info ] [MainThread]: 
[0m00:48:25.260981 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:48:25.262989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:48:25.340819 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:48:25.341814 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:48:25.341814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:25.379108 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:48:25.382649 [debug] [ThreadPool]: On list_database: Close
[0m00:48:25.383646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:48:25.385326 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:48:25.391488 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:48:25.392498 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:48:25.393506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:25.395240 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:48:25.397263 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:48:25.398277 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:48:25.399265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:48:25.400264 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:48:25.400264 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:48:25.403631 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:48:25.404653 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:48:25.405665 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:48:25.405665 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:48:25.407674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:48:25.407674 [debug] [ThreadPool]: On create_database_main: Close
[0m00:48:25.414575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:48:25.420647 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:48:25.420647 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:48:25.421655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:25.421655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:48:25.422966 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:48:25.422966 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:48:25.446115 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m00:48:25.448135 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:48:25.451020 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:48:25.451020 [debug] [ThreadPool]: On list_database_main: Close
[0m00:48:25.453066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3121FFD0>]}
[0m00:48:25.454065 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:25.455419 [debug] [MainThread]: On master: BEGIN
[0m00:48:25.455419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:25.456448 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:48:25.457506 [debug] [MainThread]: On master: COMMIT
[0m00:48:25.457506 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:25.458519 [debug] [MainThread]: On master: COMMIT
[0m00:48:25.459511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:48:25.459511 [debug] [MainThread]: On master: Close
[0m00:48:25.475946 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m00:48:25.475946 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m00:48:25.476942 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m00:48:25.478251 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m00:48:25.484312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m00:48:25.487053 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m00:48:25.515304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m00:48:25.518320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:48:25.519313 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m00:48:25.519313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:48:25.520969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:48:25.520969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:48:25.521986 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      -- modelo chamado resultado
SELECT
    *,
    UPPER(column1) AS coluna_maiuscula
FROM "database"."main"."input"
    );
  
  
[0m00:48:25.526343 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      -- modelo chamado resultado
SELECT
    *,
    UPPER(column1) AS coluna_maiuscula
FROM "database"."main"."input"
    );
  
  
[0m00:48:25.526343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:48:25.527324 [debug] [Thread-1 (]: On model.dbt_project.transform: ROLLBACK
[0m00:48:25.540277 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.transform'
[0m00:48:25.541265 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m00:48:25.543436 [debug] [Thread-1 (]: Runtime Error in model transform (models\transform\transform.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "nome"
  
  LINE 14:     UPPER(column1) AS coluna_maiuscula
                     ^
[0m00:48:25.545443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87637445-b9e5-473e-ad0a-0ded85c9b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C31280B10>]}
[0m00:48:25.546443 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform ........................... [[31mERROR[0m in 0.07s]
[0m00:48:25.548932 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m00:48:25.549962 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models\transform\transform.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "nome"
  
  LINE 14:     UPPER(column1) AS coluna_maiuscula
                     ^.
[0m00:48:25.553223 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:25.553223 [debug] [MainThread]: On master: BEGIN
[0m00:48:25.554264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:25.554264 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:48:25.555265 [debug] [MainThread]: On master: COMMIT
[0m00:48:25.555265 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:25.556268 [debug] [MainThread]: On master: COMMIT
[0m00:48:25.556268 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:48:25.557267 [debug] [MainThread]: On master: Close
[0m00:48:25.557267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:25.558270 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:48:25.558270 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:48:25.558270 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m00:48:25.559268 [info ] [MainThread]: 
[0m00:48:25.560262 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m00:48:25.560262 [debug] [MainThread]: Command end result
[0m00:48:25.656401 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:48:25.659654 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:48:25.665973 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:48:25.665973 [info ] [MainThread]: 
[0m00:48:25.667983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:48:25.669332 [info ] [MainThread]: 
[0m00:48:25.669332 [error] [MainThread]: [31mFailure in model transform (models\transform\transform.sql)[0m
[0m00:48:25.670357 [error] [MainThread]:   Runtime Error in model transform (models\transform\transform.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "nome"
  
  LINE 14:     UPPER(column1) AS coluna_maiuscula
                     ^
[0m00:48:25.670357 [info ] [MainThread]: 
[0m00:48:25.671379 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\transform\transform.sql
[0m00:48:25.672382 [info ] [MainThread]: 
[0m00:48:25.673372 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:48:25.674367 [debug] [MainThread]: Command `dbt run` failed at 00:48:25.674367 after 1.40 seconds
[0m00:48:25.675383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2ABF5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3178DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3178FF50>]}
[0m00:48:25.676376 [debug] [MainThread]: Flushing usage events
[0m00:48:26.229762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:22.162585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023654071190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365409F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365409FF90>]}


============================== 00:49:22.166606 | 6b9b7422-4b19-4b9b-834a-91a858a1664f ==============================
[0m00:49:22.166606 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:49:22.167597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:49:22.401785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364EEFAAD0>]}
[0m00:49:22.474124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364ECE6010>]}
[0m00:49:22.477103 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:49:22.747879 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:49:22.879077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:49:22.879077 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m00:49:22.880082 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\transform\transform.sql
[0m00:49:23.342086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023654938A90>]}
[0m00:49:23.398968 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:49:23.401487 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:49:23.422063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236547EB6D0>]}
[0m00:49:23.422063 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:49:23.423539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023654593010>]}
[0m00:49:23.424541 [info ] [MainThread]: 
[0m00:49:23.425698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:49:23.425698 [info ] [MainThread]: 
[0m00:49:23.426716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:49:23.428725 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:49:23.505263 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:49:23.506262 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:49:23.506262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:23.536204 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:49:23.537206 [debug] [ThreadPool]: On list_database: Close
[0m00:49:23.538203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m00:49:23.539209 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m00:49:23.545200 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:49:23.546204 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m00:49:23.546204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:49:23.548204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:49:23.549206 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:49:23.550200 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m00:49:23.551209 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:49:23.552206 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:49:23.552206 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m00:49:23.553414 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:49:23.554424 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:49:23.554424 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m00:49:23.555424 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m00:49:23.556439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:49:23.557434 [debug] [ThreadPool]: On create_database_main: Close
[0m00:49:23.562874 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m00:49:23.567871 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:49:23.568873 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m00:49:23.568873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:23.569874 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:49:23.571211 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m00:49:23.571211 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m00:49:23.585212 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:49:23.586215 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m00:49:23.587225 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m00:49:23.588225 [debug] [ThreadPool]: On list_database_main: Close
[0m00:49:23.589224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023654578750>]}
[0m00:49:23.590560 [debug] [MainThread]: Using duckdb connection "master"
[0m00:49:23.591561 [debug] [MainThread]: On master: BEGIN
[0m00:49:23.591561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:49:23.592734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:49:23.592734 [debug] [MainThread]: On master: COMMIT
[0m00:49:23.593737 [debug] [MainThread]: Using duckdb connection "master"
[0m00:49:23.593737 [debug] [MainThread]: On master: COMMIT
[0m00:49:23.594736 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:49:23.594736 [debug] [MainThread]: On master: Close
[0m00:49:23.598965 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m00:49:23.600282 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m00:49:23.601282 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m00:49:23.602437 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m00:49:23.608831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m00:49:23.609834 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m00:49:23.640396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m00:49:23.641398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.642401 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m00:49:23.643397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:49:23.643397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:49:23.644402 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.645396 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      select
    *,
    upper(nome) as coluna_maiuscula
from "database"."main"."input"
    );
  
  
[0m00:49:23.651696 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:49:23.658143 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.659149 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m00:49:23.661530 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:49:23.664547 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.664547 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m00:49:23.665551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:49:23.679546 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m00:49:23.680551 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.680551 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m00:49:23.699548 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:49:23.705076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m00:49:23.706080 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m00:49:23.717990 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m00:49:23.720983 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m00:49:23.723339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b9b7422-4b19-4b9b-834a-91a858a1664f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023654535C10>]}
[0m00:49:23.723339 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.12s]
[0m00:49:23.724360 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m00:49:23.726637 [debug] [MainThread]: Using duckdb connection "master"
[0m00:49:23.727729 [debug] [MainThread]: On master: BEGIN
[0m00:49:23.728776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:49:23.728776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:49:23.730012 [debug] [MainThread]: On master: COMMIT
[0m00:49:23.730012 [debug] [MainThread]: Using duckdb connection "master"
[0m00:49:23.731012 [debug] [MainThread]: On master: COMMIT
[0m00:49:23.732015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:49:23.732015 [debug] [MainThread]: On master: Close
[0m00:49:23.732015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:23.733339 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m00:49:23.733339 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m00:49:23.734340 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m00:49:23.734340 [info ] [MainThread]: 
[0m00:49:23.735340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m00:49:23.737567 [debug] [MainThread]: Command end result
[0m00:49:23.757513 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:49:23.761518 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:49:23.767520 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m00:49:23.768520 [info ] [MainThread]: 
[0m00:49:23.769521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:49:23.770519 [info ] [MainThread]: 
[0m00:49:23.771519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:49:23.772521 [debug] [MainThread]: Command `dbt run` succeeded at 00:49:23.772521 after 1.70 seconds
[0m00:49:23.773519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364DED5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364DEC0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364DEC11D0>]}
[0m00:49:23.773519 [debug] [MainThread]: Flushing usage events
[0m00:49:24.369734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:05.496161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E762AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E79FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E79FC90>]}


============================== 00:50:05.501444 | 47a59f89-3bf3-438d-8acf-3f0089773f55 ==============================
[0m00:50:05.501444 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:50:05.502586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:05.750113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47a59f89-3bf3-438d-8acf-3f0089773f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E804750>]}
[0m00:50:05.824201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47a59f89-3bf3-438d-8acf-3f0089773f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8193B4B10>]}
[0m00:50:05.828837 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:50:06.102979 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:50:06.266566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:50:06.267618 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m00:50:06.485217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47a59f89-3bf3-438d-8acf-3f0089773f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E9B8E90>]}
[0m00:50:06.547593 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:50:06.551955 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:50:06.595159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47a59f89-3bf3-438d-8acf-3f0089773f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81EE53490>]}
[0m00:50:06.596591 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:50:06.597651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47a59f89-3bf3-438d-8acf-3f0089773f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E724B90>]}
[0m00:50:06.599688 [info ] [MainThread]: 
[0m00:50:06.600692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:50:06.601678 [info ] [MainThread]: 
[0m00:50:06.603090 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:50:06.605197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:50:06.745072 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:50:06.746080 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:50:06.746080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:06.869620 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:50:06.870612 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:50:06.871654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:06.872613 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m00:50:06.872613 [info ] [MainThread]: 
[0m00:50:06.873611 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m00:50:06.873611 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m00:50:06.875976 [debug] [MainThread]: Command `dbt seed` failed at 00:50:06.875976 after 1.47 seconds
[0m00:50:06.876974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E7A7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E72D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81EF38110>]}
[0m00:50:06.876974 [debug] [MainThread]: Flushing usage events
[0m00:50:07.482524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:28.140448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EA44890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EA46290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EABF8D0>]}


============================== 00:52:28.149549 | 91caa075-a8fc-455b-9315-6730d1def99c ==============================
[0m00:52:28.149549 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:52:28.150624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:52:28.414530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91caa075-a8fc-455b-9315-6730d1def99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EBE7210>]}
[0m00:52:28.481728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91caa075-a8fc-455b-9315-6730d1def99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093A7B4F50>]}
[0m00:52:28.484727 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:52:28.765853 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:52:28.925613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:52:28.926828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:52:28.958968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91caa075-a8fc-455b-9315-6730d1def99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EB193D0>]}
[0m00:52:29.017625 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m00:52:29.035374 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m00:52:29.077143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91caa075-a8fc-455b-9315-6730d1def99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209400DAC50>]}
[0m00:52:29.078143 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m00:52:29.078651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91caa075-a8fc-455b-9315-6730d1def99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EA44A10>]}
[0m00:52:29.079679 [info ] [MainThread]: 
[0m00:52:29.080669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:52:29.081985 [info ] [MainThread]: 
[0m00:52:29.083442 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:52:29.084456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m00:52:29.166401 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m00:52:29.167404 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:52:29.167404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:29.268541 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m00:52:29.268541 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:52:29.269530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:29.270520 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m00:52:29.270520 [info ] [MainThread]: 
[0m00:52:29.271509 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m00:52:29.272653 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m00:52:29.274673 [debug] [MainThread]: Command `dbt seed` failed at 00:52:29.274673 after 1.23 seconds
[0m00:52:29.275674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EA4D690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EAC7B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094001FF50>]}
[0m00:52:29.276674 [debug] [MainThread]: Flushing usage events
[0m00:52:29.916497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:06.771032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA719EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA719F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA719F8D0>]}


============================== 01:11:06.778753 | b359121a-1163-409b-b960-c1658011b8ac ==============================
[0m01:11:06.778753 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:11:06.782813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:11:07.158224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b359121a-1163-409b-b960-c1658011b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA7207A50>]}
[0m01:11:07.224630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b359121a-1163-409b-b960-c1658011b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA1DD6510>]}
[0m01:11:07.228926 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:11:07.643951 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:11:07.827894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:11:07.828904 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m01:11:08.050931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b359121a-1163-409b-b960-c1658011b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA7915ED0>]}
[0m01:11:08.110147 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:11:08.115281 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:11:08.165149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b359121a-1163-409b-b960-c1658011b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA7A0CBD0>]}
[0m01:11:08.166148 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:11:08.167151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b359121a-1163-409b-b960-c1658011b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA7909050>]}
[0m01:11:08.169170 [info ] [MainThread]: 
[0m01:11:08.170148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:08.171151 [info ] [MainThread]: 
[0m01:11:08.172520 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:11:08.174992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:11:08.332132 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:11:08.333142 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:11:08.333142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:08.513134 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:11:08.514134 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:11:08.515138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:08.515138 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:11:08.516519 [info ] [MainThread]: 
[0m01:11:08.516519 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m01:11:08.517717 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m01:11:08.520091 [debug] [MainThread]: Command `dbt seed` failed at 01:11:08.518911 after 1.85 seconds
[0m01:11:08.520091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA712D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA719F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA7A30110>]}
[0m01:11:08.521091 [debug] [MainThread]: Flushing usage events
[0m01:11:09.269869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:28.180918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998826CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998825B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998825650>]}


============================== 01:14:28.187794 | e2287ebb-b6ca-484e-9213-8edc8d539194 ==============================
[0m01:14:28.187794 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:14:28.190561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m01:14:28.506030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2287ebb-b6ca-484e-9213-8edc8d539194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998902B50>]}
[0m01:14:28.575443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2287ebb-b6ca-484e-9213-8edc8d539194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9935051D0>]}
[0m01:14:28.579447 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:14:28.896496 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:14:29.072457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:14:29.073488 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m01:14:29.299308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2287ebb-b6ca-484e-9213-8edc8d539194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998F45590>]}
[0m01:14:29.359182 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:14:29.363166 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:14:29.408584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2287ebb-b6ca-484e-9213-8edc8d539194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99A10CCD0>]}
[0m01:14:29.409478 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:14:29.410460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2287ebb-b6ca-484e-9213-8edc8d539194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99A00BC90>]}
[0m01:14:29.412691 [info ] [MainThread]: 
[0m01:14:29.414711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:29.415713 [info ] [MainThread]: 
[0m01:14:29.416686 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:14:29.417846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:14:29.565164 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:14:29.565164 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:14:29.566166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:29.684224 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:14:29.685223 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:14:29.686223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:29.686223 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:14:29.687728 [info ] [MainThread]: 
[0m01:14:29.687728 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m01:14:29.689734 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m01:14:29.691741 [debug] [MainThread]: Command `dbt seed` failed at 01:14:29.691741 after 1.61 seconds
[0m01:14:29.691741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9984E4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99882D710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F998F50110>]}
[0m01:14:29.692734 [debug] [MainThread]: Flushing usage events
[0m01:14:30.302420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:40.449124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D252944450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256C9FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256C62AD0>]}


============================== 01:14:40.453414 | 231bd9d5-27c8-407e-96de-c08cdf714da1 ==============================
[0m01:14:40.453414 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:14:40.454417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m01:14:40.693166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '231bd9d5-27c8-407e-96de-c08cdf714da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256E0F5D0>]}
[0m01:14:40.762694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '231bd9d5-27c8-407e-96de-c08cdf714da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D252954AD0>]}
[0m01:14:40.764695 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:14:41.032696 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:14:41.168419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:41.169447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:41.206479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '231bd9d5-27c8-407e-96de-c08cdf714da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256CF9190>]}
[0m01:14:41.266225 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:14:41.269234 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:14:41.288435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '231bd9d5-27c8-407e-96de-c08cdf714da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D258327850>]}
[0m01:14:41.289441 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:14:41.290437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '231bd9d5-27c8-407e-96de-c08cdf714da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256C24810>]}
[0m01:14:41.292429 [info ] [MainThread]: 
[0m01:14:41.293429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:41.294434 [info ] [MainThread]: 
[0m01:14:41.295429 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:14:41.296428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:14:41.371072 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:14:41.372063 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:14:41.372063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:41.462773 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:14:41.463780 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:14:41.464784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:41.465791 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:14:41.465791 [info ] [MainThread]: 
[0m01:14:41.466800 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m01:14:41.468788 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m01:14:41.469775 [debug] [MainThread]: Command `dbt seed` failed at 01:14:41.469775 after 1.12 seconds
[0m01:14:41.470782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256CA7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256C2D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D258398110>]}
[0m01:14:41.470782 [debug] [MainThread]: Flushing usage events
[0m01:14:42.038750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:07.692514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E41E0EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E41E0FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E41DD1DD0>]}


============================== 01:17:07.699681 | 77c9dc99-12de-410f-9787-d9bb9ef3e341 ==============================
[0m01:17:07.699681 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:17:07.704415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:17:08.044621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c9dc99-12de-410f-9787-d9bb9ef3e341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E41D8BA90>]}
[0m01:17:08.112019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c9dc99-12de-410f-9787-d9bb9ef3e341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E3DB06390>]}
[0m01:17:08.115353 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:17:08.465361 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:17:08.648893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:17:08.649899 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m01:17:08.875427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c9dc99-12de-410f-9787-d9bb9ef3e341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E4344C9D0>]}
[0m01:17:08.935487 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:17:08.939502 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:17:08.982243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c9dc99-12de-410f-9787-d9bb9ef3e341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E436E7010>]}
[0m01:17:08.983248 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:17:08.984253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c9dc99-12de-410f-9787-d9bb9ef3e341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E4364FF10>]}
[0m01:17:08.986260 [info ] [MainThread]: 
[0m01:17:08.987256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:08.988262 [info ] [MainThread]: 
[0m01:17:08.989248 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:17:08.990247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:17:09.135330 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:17:09.136494 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:17:09.136494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:09.263048 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:17:09.263048 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:17:09.264055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:09.265280 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:17:09.265280 [info ] [MainThread]: 
[0m01:17:09.266279 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m01:17:09.267291 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22816)
[0m01:17:09.269286 [debug] [MainThread]: Command `dbt seed` failed at 01:17:09.269286 after 1.67 seconds
[0m01:17:09.269286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E41E17390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E432E23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43608110>]}
[0m01:17:09.270288 [debug] [MainThread]: Flushing usage events
[0m01:17:09.903825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:47.774156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DE27550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DE27610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DE25810>]}


============================== 01:18:47.781157 | dc9aa0d4-0392-43b6-9e7e-45dd361c7641 ==============================
[0m01:18:47.781157 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:18:47.782245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:18:48.039395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9aa0d4-0392-43b6-9e7e-45dd361c7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DF92C90>]}
[0m01:18:48.109259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9aa0d4-0392-43b6-9e7e-45dd361c7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025519B44850>]}
[0m01:18:48.113351 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:18:48.419576 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:18:48.594613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:48.595614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:48.628257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9aa0d4-0392-43b6-9e7e-45dd361c7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551F3F2B90>]}
[0m01:18:48.686073 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:18:48.691911 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:18:48.726478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9aa0d4-0392-43b6-9e7e-45dd361c7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DF00C90>]}
[0m01:18:48.727460 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:18:48.728461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9aa0d4-0392-43b6-9e7e-45dd361c7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DE24710>]}
[0m01:18:48.729602 [info ] [MainThread]: 
[0m01:18:48.730629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:48.731943 [info ] [MainThread]: 
[0m01:18:48.732959 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:18:48.735097 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:18:48.820929 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:18:48.820929 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:18:48.821907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:48.947525 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:18:48.948522 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:18:48.949540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:48.950536 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:18:48.951531 [info ] [MainThread]: 
[0m01:18:48.952707 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m01:18:48.953844 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 11724)
[0m01:18:48.955179 [debug] [MainThread]: Command `dbt seed` failed at 01:18:48.955179 after 1.28 seconds
[0m01:18:48.956190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551DE2D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551F382590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551F329090>]}
[0m01:18:48.956190 [debug] [MainThread]: Flushing usage events
[0m01:18:49.582764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:46.171040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0626C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C055A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0626290>]}


============================== 01:20:46.178051 | fb670ef1-3854-4f5c-ac93-618473b8d0b7 ==============================
[0m01:20:46.178051 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:20:46.179502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:20:46.510133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb670ef1-3854-4f5c-ac93-618473b8d0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C06F2E90>]}
[0m01:20:46.579326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb670ef1-3854-4f5c-ac93-618473b8d0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BB3913D0>]}
[0m01:20:46.582339 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:20:47.019886 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:20:47.232602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:47.232602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:47.264978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb670ef1-3854-4f5c-ac93-618473b8d0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0C2EF10>]}
[0m01:20:47.329576 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:20:47.333850 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:20:47.375564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb670ef1-3854-4f5c-ac93-618473b8d0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0B80E50>]}
[0m01:20:47.375564 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:20:47.376607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb670ef1-3854-4f5c-ac93-618473b8d0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0B4DE10>]}
[0m01:20:47.377637 [info ] [MainThread]: 
[0m01:20:47.378642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:47.379649 [info ] [MainThread]: 
[0m01:20:47.379649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:20:47.380647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:20:47.464101 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:20:47.465396 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:20:47.466397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:47.603272 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:20:47.604273 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:20:47.606285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:47.607279 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:20:47.607279 [info ] [MainThread]: 
[0m01:20:47.607279 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m01:20:47.608282 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 6896)
[0m01:20:47.609281 [debug] [MainThread]: Command `dbt seed` failed at 01:20:47.609281 after 1.53 seconds
[0m01:20:47.610494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C06A2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C062D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C0662C10>]}
[0m01:20:47.610494 [debug] [MainThread]: Flushing usage events
[0m01:20:48.231926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:48.601876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150DE115FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2460E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2461C90>]}


============================== 01:21:48.607219 | 73859c7a-24d6-48aa-a837-d7d7f7282d58 ==============================
[0m01:21:48.607219 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:21:48.608219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:21:48.855525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73859c7a-24d6-48aa-a837-d7d7f7282d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E245A550>]}
[0m01:21:48.934629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73859c7a-24d6-48aa-a837-d7d7f7282d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150DE1350D0>]}
[0m01:21:48.938092 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:21:49.215498 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:21:49.357171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:21:49.358456 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m01:21:49.574460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73859c7a-24d6-48aa-a837-d7d7f7282d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2BEB050>]}
[0m01:21:49.630748 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:21:49.635052 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:21:49.670938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73859c7a-24d6-48aa-a837-d7d7f7282d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2CF0F50>]}
[0m01:21:49.672374 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:21:49.672374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73859c7a-24d6-48aa-a837-d7d7f7282d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2951050>]}
[0m01:21:49.674722 [info ] [MainThread]: 
[0m01:21:49.674722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:49.674722 [info ] [MainThread]: 
[0m01:21:49.676096 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:21:49.677357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:21:49.819289 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:21:49.819289 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:21:49.820328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:49.928540 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:21:49.928540 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:21:49.929543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:49.931008 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:21:49.931008 [info ] [MainThread]: 
[0m01:21:49.932137 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m01:21:49.932137 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22748)
[0m01:21:49.934141 [debug] [MainThread]: Command `dbt seed` failed at 01:21:49.934141 after 1.42 seconds
[0m01:21:49.935131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E24A2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E242D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2C9DC90>]}
[0m01:21:49.935131 [debug] [MainThread]: Flushing usage events
[0m01:21:50.539691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:21.945981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F39F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F39F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F324110>]}


============================== 01:22:21.949984 | 6047639d-a880-49a0-8eeb-05c0e42eb620 ==============================
[0m01:22:21.949984 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:22:21.950987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:22:22.178100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6047639d-a880-49a0-8eeb-05c0e42eb620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A86E95250>]}
[0m01:22:22.244958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6047639d-a880-49a0-8eeb-05c0e42eb620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8B045250>]}
[0m01:22:22.246958 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:22:22.518855 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:22:22.705285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:22:22.706286 [debug] [MainThread]: Partial parsing: updated file: dbt_project://seeds\input.csv
[0m01:22:22.929152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6047639d-a880-49a0-8eeb-05c0e42eb620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8D51CC50>]}
[0m01:22:22.987082 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:22:22.989613 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:22:23.009223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6047639d-a880-49a0-8eeb-05c0e42eb620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F3F8C10>]}
[0m01:22:23.009742 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:22:23.010762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6047639d-a880-49a0-8eeb-05c0e42eb620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8FA73A90>]}
[0m01:22:23.011754 [info ] [MainThread]: 
[0m01:22:23.012744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:23.012744 [info ] [MainThread]: 
[0m01:22:23.013937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:22:23.014945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:22:23.142690 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:22:23.143686 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:22:23.143686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:23.238556 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:22:23.238556 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:22:23.239694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:23.240559 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:22:23.240559 [info ] [MainThread]: 
[0m01:22:23.241561 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m01:22:23.241561 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22748)
[0m01:22:23.242562 [debug] [MainThread]: Command `dbt seed` failed at 01:22:23.242562 after 1.39 seconds
[0m01:22:23.243565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F32D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F325E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8F324410>]}
[0m01:22:23.243565 [debug] [MainThread]: Flushing usage events
[0m01:22:23.801113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:38.146920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D80026C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D80062F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D80062E90>]}


============================== 01:23:38.155694 | 822f5be9-b2f6-4893-9f30-4662e27b9cc4 ==============================
[0m01:23:38.155694 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:23:38.157702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:23:38.539303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '822f5be9-b2f6-4893-9f30-4662e27b9cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D800F4410>]}
[0m01:23:38.608030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '822f5be9-b2f6-4893-9f30-4662e27b9cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFADA4910>]}
[0m01:23:38.611312 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:23:39.094836 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:23:39.287975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:39.288976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:39.320977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822f5be9-b2f6-4893-9f30-4662e27b9cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8064C210>]}
[0m01:23:39.382693 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:23:39.388223 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:23:39.431906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822f5be9-b2f6-4893-9f30-4662e27b9cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D800F3790>]}
[0m01:23:39.431906 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:23:39.433302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822f5be9-b2f6-4893-9f30-4662e27b9cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D805913D0>]}
[0m01:23:39.435313 [info ] [MainThread]: 
[0m01:23:39.435313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:39.436294 [info ] [MainThread]: 
[0m01:23:39.437525 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:23:39.438535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:23:39.524353 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:23:39.524353 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:23:39.525346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:39.684487 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:23:39.684487 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:23:39.685491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:39.686498 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:23:39.687492 [info ] [MainThread]: 
[0m01:23:39.687492 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m01:23:39.688493 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 22748)
[0m01:23:39.689493 [debug] [MainThread]: Command `dbt seed` failed at 01:23:39.689493 after 1.65 seconds
[0m01:23:39.690481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D80026290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8002D7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8051FF50>]}
[0m01:23:39.690481 [debug] [MainThread]: Flushing usage events
[0m01:23:40.479469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:24:05.762201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AE726CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5A93D5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5A93E73D0>]}


============================== 01:24:05.769650 | 397fa991-1603-48c3-bb81-843ac3e05e48 ==============================
[0m01:24:05.769650 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:24:05.771654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:24:06.029706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397fa991-1603-48c3-bb81-843ac3e05e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AE761210>]}
[0m01:24:06.098429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397fa991-1603-48c3-bb81-843ac3e05e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5A93F5C90>]}
[0m01:24:06.102122 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:24:06.382649 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:24:06.539941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:24:06.540945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:24:06.573289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397fa991-1603-48c3-bb81-843ac3e05e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AED2F450>]}
[0m01:24:06.631504 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:24:06.635035 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:24:06.679166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397fa991-1603-48c3-bb81-843ac3e05e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AEDD6CD0>]}
[0m01:24:06.680162 [info ] [MainThread]: Found 1 model, 1 seed, 428 macros
[0m01:24:06.681165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397fa991-1603-48c3-bb81-843ac3e05e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5A99822D0>]}
[0m01:24:06.682165 [info ] [MainThread]: 
[0m01:24:06.683161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:06.683161 [info ] [MainThread]: 
[0m01:24:06.684164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:24:06.686161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:24:06.771266 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:24:06.772306 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:24:06.772306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:06.900808 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:24:06.901811 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:24:06.903803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:06.904805 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:24:06.905801 [info ] [MainThread]: 
[0m01:24:06.906803 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m01:24:06.908083 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 26652)
[0m01:24:06.909600 [debug] [MainThread]: Command `dbt seed` failed at 01:24:06.909600 after 1.25 seconds
[0m01:24:06.910952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AE761A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AE72D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5AE7272D0>]}
[0m01:24:06.911467 [debug] [MainThread]: Flushing usage events
[0m01:24:07.499918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:03.534132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F7024250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F7026F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F7096F10>]}


============================== 01:29:03.541167 | 1d076b14-1947-45de-be7f-a8f8772efbbb ==============================
[0m01:29:03.541167 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:29:03.542155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:29:03.888721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d076b14-1947-45de-be7f-a8f8772efbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F71E5E10>]}
[0m01:29:03.959862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d076b14-1947-45de-be7f-a8f8772efbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F1CE57D0>]}
[0m01:29:03.964181 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:29:04.397900 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:29:04.570261 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:29:04.571274 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://seeds\input.csv
[0m01:29:04.786458 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.transform' (models\transform\transform.sql) depends on a node named 'input' which was not found
[0m01:29:04.787461 [debug] [MainThread]: Command `dbt run` failed at 01:29:04.787461 after 1.36 seconds
[0m01:29:04.787461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F70A1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F70A3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F5D0E850>]}
[0m01:29:04.788462 [debug] [MainThread]: Flushing usage events
[0m01:29:05.576485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:21.773875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC67771590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC67763050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC67763A90>]}


============================== 01:31:21.780889 | 8d336f6c-d433-4034-877f-109aa251270a ==============================
[0m01:31:21.780889 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:31:21.782109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:22.123473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d336f6c-d433-4034-877f-109aa251270a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC678DEE10>]}
[0m01:31:22.194202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d336f6c-d433-4034-877f-109aa251270a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC624321D0>]}
[0m01:31:22.198426 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:31:22.640761 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:31:22.830043 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:31:22.831232 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://seeds\input.csv
[0m01:31:23.045222 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.transform' (models\transform\transform.sql) depends on a node named 'input' which was not found
[0m01:31:23.046220 [debug] [MainThread]: Command `dbt run` failed at 01:31:23.046220 after 1.39 seconds
[0m01:31:23.047222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC677A3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC677A0B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC673D18D0>]}
[0m01:31:23.047222 [debug] [MainThread]: Flushing usage events
[0m01:31:23.667241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:33:41.128136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144528248D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014452897210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014452827790>]}


============================== 01:33:41.135928 | 43bc8d65-3716-42d1-997d-b354f3d5d58e ==============================
[0m01:33:41.135928 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:33:41.135928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:41.139335 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'duckdb_profile'
[0m01:33:41.139335 [debug] [MainThread]: Command `dbt run` failed at 01:33:41.139335 after 0.12 seconds
[0m01:33:41.140818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001445282D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144528A3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144528A38D0>]}
[0m01:33:41.140818 [debug] [MainThread]: Flushing usage events
[0m01:33:41.797394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:54.740463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A25663250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A252E0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A256A6B50>]}


============================== 01:34:54.745778 | dcaca908-d7c4-4b71-80ea-1132821037dc ==============================
[0m01:34:54.745778 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:34:54.747210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:34:55.112726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A2582D350>]}
[0m01:34:55.185496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A21355AD0>]}
[0m01:34:55.189483 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:34:55.478086 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:34:55.630855 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m01:34:55.631357 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://seeds\input.csv
[0m01:34:55.632396 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\transform\transform.sql
[0m01:34:55.913824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A25B28B10>]}
[0m01:34:55.967271 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:34:55.971823 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:34:56.024638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A25F0EA90>]}
[0m01:34:56.024638 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:34:56.025637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A25DE4610>]}
[0m01:34:56.027881 [info ] [MainThread]: 
[0m01:34:56.028975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:34:56.029986 [info ] [MainThread]: 
[0m01:34:56.030989 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:34:56.031987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:34:56.202886 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:34:56.202886 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:34:56.203894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:56.249400 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m01:34:56.253398 [debug] [ThreadPool]: On list_database: Close
[0m01:34:56.254399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m01:34:56.256730 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m01:34:56.262741 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:34:56.263750 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m01:34:56.263750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:56.267043 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:34:56.269071 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:34:56.269071 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m01:34:56.270064 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:56.270064 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:34:56.271410 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m01:34:56.273429 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:34:56.274434 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:34:56.274434 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:34:56.275432 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:34:56.275432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:56.276641 [debug] [ThreadPool]: On create_database_main: Close
[0m01:34:56.277661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m01:34:56.284109 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:34:56.285113 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m01:34:56.285113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:56.287115 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:34:56.287115 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:34:56.287115 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m01:34:56.321761 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m01:34:56.323757 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m01:34:56.325696 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m01:34:56.326387 [debug] [ThreadPool]: On list_database_main: Close
[0m01:34:56.328453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A25DA54D0>]}
[0m01:34:56.329444 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:56.329444 [debug] [MainThread]: On master: BEGIN
[0m01:34:56.330452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:56.330452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:56.331454 [debug] [MainThread]: On master: COMMIT
[0m01:34:56.331454 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:56.332443 [debug] [MainThread]: On master: COMMIT
[0m01:34:56.333452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:34:56.333452 [debug] [MainThread]: On master: Close
[0m01:34:56.344515 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m01:34:56.345515 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m01:34:56.346517 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m01:34:56.347933 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m01:34:56.353416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m01:34:56.356491 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m01:34:56.389362 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m01:34:56.394624 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.395671 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m01:34:56.395671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:34:56.396670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:34:56.397666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.398666 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      select * from input
    );
  
  
[0m01:34:56.401750 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:34:56.407763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.407763 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m01:34:56.411746 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:34:56.415746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.415746 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m01:34:56.416744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:34:56.429743 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:34:56.430745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.431743 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:34:56.438758 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:34:56.446803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:34:56.446803 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m01:34:56.454161 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:34:56.456727 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m01:34:56.459766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcaca908-d7c4-4b71-80ea-1132821037dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A23FA6250>]}
[0m01:34:56.460748 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.11s]
[0m01:34:56.461744 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m01:34:56.463748 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:56.465141 [debug] [MainThread]: On master: BEGIN
[0m01:34:56.465141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:34:56.466144 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:56.466144 [debug] [MainThread]: On master: COMMIT
[0m01:34:56.467512 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:56.467512 [debug] [MainThread]: On master: COMMIT
[0m01:34:56.468504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:34:56.469536 [debug] [MainThread]: On master: Close
[0m01:34:56.469536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:56.470523 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m01:34:56.470523 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m01:34:56.470523 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m01:34:56.471750 [info ] [MainThread]: 
[0m01:34:56.471750 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m01:34:56.473859 [debug] [MainThread]: Command end result
[0m01:34:56.498580 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:34:56.501872 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:34:56.506951 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m01:34:56.508234 [info ] [MainThread]: 
[0m01:34:56.509615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:34:56.510688 [info ] [MainThread]: 
[0m01:34:56.511691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:34:56.514068 [debug] [MainThread]: Command `dbt run` succeeded at 01:34:56.514068 after 1.88 seconds
[0m01:34:56.515094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A239745D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1F555F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1F540050>]}
[0m01:34:56.516108 [debug] [MainThread]: Flushing usage events
[0m01:34:57.278809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:38.115019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B26C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B248D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B97210>]}


============================== 01:35:38.122118 | 42fcf6a6-3d11-423a-a13d-437e0af12689 ==============================
[0m01:35:38.122118 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:35:38.123120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:35:38.371978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42fcf6a6-3d11-423a-a13d-437e0af12689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5BC1050>]}
[0m01:35:38.442108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42fcf6a6-3d11-423a-a13d-437e0af12689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F1855D50>]}
[0m01:35:38.446926 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:35:38.751232 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:35:38.997824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:35:38.998828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:35:39.022093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fcf6a6-3d11-423a-a13d-437e0af12689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F70F2550>]}
[0m01:35:39.072629 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:35:39.077368 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:35:39.115110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42fcf6a6-3d11-423a-a13d-437e0af12689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F701F550>]}
[0m01:35:39.116088 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:35:39.117357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fcf6a6-3d11-423a-a13d-437e0af12689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B249D0>]}
[0m01:35:39.118390 [info ] [MainThread]: 
[0m01:35:39.119729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:35:39.119729 [info ] [MainThread]: 
[0m01:35:39.120763 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:35:39.121836 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:35:39.206869 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:35:39.206869 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:35:39.207899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:39.450417 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:35:39.450417 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:35:39.451709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:39.452760 [debug] [MainThread]: Connection 'list_database' was properly closed.
[0m01:35:39.452760 [info ] [MainThread]: 
[0m01:35:39.453750 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m01:35:39.454750 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "d:\projects\dbt + duckdb + rag\dbt_project\..\duckdb\database.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\python3.11.exe (PID 17552)
[0m01:35:39.455750 [debug] [MainThread]: Command `dbt run` failed at 01:35:39.455750 after 1.43 seconds
[0m01:35:39.456754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B97390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F7029090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F5B2D750>]}
[0m01:35:39.456754 [debug] [MainThread]: Flushing usage events
[0m01:35:40.043686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:48.099229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A926CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A926290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A5E0390>]}


============================== 01:36:48.107261 | 00b04679-3ee3-4732-9c10-ddda08aeb595 ==============================
[0m01:36:48.107261 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:36:48.108274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:36:48.420548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A986690>]}
[0m01:36:48.487816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0655E4AD0>]}
[0m01:36:48.492038 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:36:48.859334 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:36:49.002849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:36:49.002849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:36:49.027363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06AF2FB90>]}
[0m01:36:49.086366 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:36:49.089834 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:36:49.124791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06AE91390>]}
[0m01:36:49.125792 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:36:49.126774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06ABACB90>]}
[0m01:36:49.127770 [info ] [MainThread]: 
[0m01:36:49.129024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:49.129024 [info ] [MainThread]: 
[0m01:36:49.130060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:36:49.131072 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:36:49.213709 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:36:49.214707 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:36:49.215707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:49.260289 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m01:36:49.263451 [debug] [ThreadPool]: On list_database: Close
[0m01:36:49.264816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m01:36:49.265767 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m01:36:49.272279 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:36:49.273288 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m01:36:49.273288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:49.277268 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:36:49.279281 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:36:49.279281 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m01:36:49.280279 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:49.281279 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:36:49.281279 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m01:36:49.283455 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:36:49.284301 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:36:49.285315 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:36:49.286322 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:36:49.287323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:49.288333 [debug] [ThreadPool]: On create_database_main: Close
[0m01:36:49.290339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m01:36:49.295332 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:36:49.296338 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m01:36:49.296338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:49.297340 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:36:49.298340 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:36:49.298340 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m01:36:49.331148 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m01:36:49.332733 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m01:36:49.335765 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m01:36:49.335765 [debug] [ThreadPool]: On list_database_main: Close
[0m01:36:49.337918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06ADE2790>]}
[0m01:36:49.339068 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.340108 [debug] [MainThread]: On master: BEGIN
[0m01:36:49.340108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:49.341108 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:49.342107 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.343118 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.343118 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.344409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:49.344409 [debug] [MainThread]: On master: Close
[0m01:36:49.351662 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m01:36:49.353787 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m01:36:49.354802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m01:36:49.354802 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m01:36:49.360841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m01:36:49.363426 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m01:36:49.396427 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m01:36:49.398364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.399399 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m01:36:49.400400 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:36:49.401381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:36:49.401381 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.402762 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      select * from input
    );
  
  
[0m01:36:49.404140 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:36:49.410278 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.411284 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m01:36:49.413445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:36:49.416444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.417445 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m01:36:49.418449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:36:49.432965 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:36:49.433968 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.433968 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:36:49.453228 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m01:36:49.515520 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:36:49.516520 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m01:36:49.528647 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m01:36:49.531647 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m01:36:49.534649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00b04679-3ee3-4732-9c10-ddda08aeb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06ABED1D0>]}
[0m01:36:49.535782 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.18s]
[0m01:36:49.535782 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m01:36:49.538732 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.539731 [debug] [MainThread]: On master: BEGIN
[0m01:36:49.539731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:49.540732 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:49.541730 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.541730 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.541730 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.542731 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:49.543733 [debug] [MainThread]: On master: Close
[0m01:36:49.544733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:49.544733 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m01:36:49.545742 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m01:36:49.545742 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m01:36:49.546738 [info ] [MainThread]: 
[0m01:36:49.546738 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m01:36:49.547734 [debug] [MainThread]: Command end result
[0m01:36:49.570406 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:36:49.572407 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:36:49.578410 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m01:36:49.579409 [info ] [MainThread]: 
[0m01:36:49.580518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:36:49.580518 [info ] [MainThread]: 
[0m01:36:49.580518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:36:49.582533 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:49.581532 after 1.58 seconds
[0m01:36:49.582533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A926F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A925CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06A9A1210>]}
[0m01:36:49.583512 [debug] [MainThread]: Flushing usage events
[0m01:36:50.221744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:20.295456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24825B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24893D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24893550>]}


============================== 01:37:20.298455 | 1bd24377-91cb-426d-a809-7fae44529804 ==============================
[0m01:37:20.298455 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:37:20.299455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:37:20.531610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24862690>]}
[0m01:37:20.599212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A1F545DD0>]}
[0m01:37:20.602583 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:37:20.887145 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:37:20.989959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:20.991006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:21.015944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24DA5190>]}
[0m01:37:21.067317 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:37:21.069705 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:37:21.093686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24E2E590>]}
[0m01:37:21.094794 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:37:21.095802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24DF19D0>]}
[0m01:37:21.096809 [info ] [MainThread]: 
[0m01:37:21.097806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:21.097806 [info ] [MainThread]: 
[0m01:37:21.098915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:37:21.100912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:37:21.172520 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:37:21.172520 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:37:21.173539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:21.199257 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m01:37:21.201626 [debug] [ThreadPool]: On list_database: Close
[0m01:37:21.202863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m01:37:21.203873 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m01:37:21.210354 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:37:21.210354 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m01:37:21.211356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:21.212356 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:21.214356 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:37:21.214356 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m01:37:21.215376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:21.216356 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:37:21.216356 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m01:37:21.217358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:21.218789 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:37:21.218789 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:37:21.219797 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:37:21.219797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:21.220791 [debug] [ThreadPool]: On create_database_main: Close
[0m01:37:21.221788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m01:37:21.228224 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:37:21.229222 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m01:37:21.229222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:21.230233 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:21.230233 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:37:21.231232 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m01:37:21.245918 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m01:37:21.247920 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m01:37:21.248920 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m01:37:21.248920 [debug] [ThreadPool]: On list_database_main: Close
[0m01:37:21.250917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24DA53D0>]}
[0m01:37:21.251940 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:21.251940 [debug] [MainThread]: On master: BEGIN
[0m01:37:21.251940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:21.254262 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:21.254262 [debug] [MainThread]: On master: COMMIT
[0m01:37:21.254262 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:21.255261 [debug] [MainThread]: On master: COMMIT
[0m01:37:21.256266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:21.256266 [debug] [MainThread]: On master: Close
[0m01:37:21.261150 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m01:37:21.262159 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m01:37:21.263131 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m01:37:21.263131 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m01:37:21.269870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m01:37:21.270866 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m01:37:21.301356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m01:37:21.302690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.302690 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m01:37:21.302690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:21.304080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:21.305079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.305079 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      select * from input
    );
  
  
[0m01:37:21.310696 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:37:21.317146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.317146 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m01:37:21.318175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:37:21.321635 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.322636 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m01:37:21.323630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:37:21.339280 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:37:21.339280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.340320 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:37:21.348988 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:37:21.410406 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:37:21.410406 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m01:37:21.418182 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:37:21.420495 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m01:37:21.422847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bd24377-91cb-426d-a809-7fae44529804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2536C690>]}
[0m01:37:21.423884 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.16s]
[0m01:37:21.424899 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m01:37:21.427165 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:21.427165 [debug] [MainThread]: On master: BEGIN
[0m01:37:21.428186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:21.429210 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:21.429210 [debug] [MainThread]: On master: COMMIT
[0m01:37:21.429210 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:21.430221 [debug] [MainThread]: On master: COMMIT
[0m01:37:21.431211 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:21.431211 [debug] [MainThread]: On master: Close
[0m01:37:21.432223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:21.432223 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m01:37:21.432223 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m01:37:21.433230 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m01:37:21.433230 [info ] [MainThread]: 
[0m01:37:21.433230 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m01:37:21.434426 [debug] [MainThread]: Command end result
[0m01:37:21.454690 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:37:21.457702 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:37:21.462738 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m01:37:21.463945 [info ] [MainThread]: 
[0m01:37:21.463945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:21.465098 [info ] [MainThread]: 
[0m01:37:21.465098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:37:21.467425 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:21.467425 after 1.26 seconds
[0m01:37:21.468458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A24AB9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A1E7B60D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2287C3D0>]}
[0m01:37:21.468458 [debug] [MainThread]: Flushing usage events
[0m01:37:22.036420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:36.178704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29426CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29426290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29462DD0>]}


============================== 01:40:36.186209 | 5ea9613b-6b50-4afb-be52-5033d5ec3dc1 ==============================
[0m01:40:36.186209 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:40:36.188222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:40:36.604279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA295DF610>]}
[0m01:40:36.686602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA24165550>]}
[0m01:40:36.691262 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m01:40:37.242028 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:40:37.447624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:40:37.448622 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\transform\transform.sql
[0m01:40:37.721734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2969C710>]}
[0m01:40:37.780333 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:40:37.785334 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:40:37.829895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29D0A950>]}
[0m01:40:37.831237 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:40:37.832431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29502710>]}
[0m01:40:37.833419 [info ] [MainThread]: 
[0m01:40:37.834866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:37.835888 [info ] [MainThread]: 
[0m01:40:37.835888 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:40:37.837897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m01:40:38.006944 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m01:40:38.006944 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m01:40:38.007949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:38.060646 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m01:40:38.063154 [debug] [ThreadPool]: On list_database: Close
[0m01:40:38.065155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m01:40:38.066150 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m01:40:38.073168 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:40:38.074419 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m01:40:38.074926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:38.079366 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:40:38.081442 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:40:38.082446 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m01:40:38.082446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:38.083652 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:40:38.083652 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m01:40:38.085985 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:40:38.087963 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:40:38.088968 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m01:40:38.088968 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m01:40:38.089978 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:38.091115 [debug] [ThreadPool]: On create_database_main: Close
[0m01:40:38.093331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m01:40:38.099180 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:40:38.100510 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m01:40:38.101537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:38.102536 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:40:38.102536 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m01:40:38.103785 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m01:40:38.140987 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m01:40:38.143129 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m01:40:38.145123 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m01:40:38.146360 [debug] [ThreadPool]: On list_database_main: Close
[0m01:40:38.148720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA296BA390>]}
[0m01:40:38.148720 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:38.150168 [debug] [MainThread]: On master: BEGIN
[0m01:40:38.151217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:38.152427 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:38.153423 [debug] [MainThread]: On master: COMMIT
[0m01:40:38.153423 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:38.154416 [debug] [MainThread]: On master: COMMIT
[0m01:40:38.155420 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:40:38.157422 [debug] [MainThread]: On master: Close
[0m01:40:38.165405 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m01:40:38.166587 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m01:40:38.167592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m01:40:38.168592 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m01:40:38.175583 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m01:40:38.178582 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m01:40:38.220381 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m01:40:38.223554 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.224593 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m01:40:38.225592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:38.226592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:40:38.227596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.228584 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m01:40:38.235587 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:40:38.243591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.244595 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m01:40:38.247724 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:40:38.252725 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.254168 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m01:40:38.255391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:40:38.273746 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:40:38.274743 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.274743 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m01:40:38.290978 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:40:38.296492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m01:40:38.297491 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m01:40:38.305695 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:40:38.310933 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m01:40:38.313963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea9613b-6b50-4afb-be52-5033d5ec3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA29CC0190>]}
[0m01:40:38.315010 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.14s]
[0m01:40:38.316011 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m01:40:38.319024 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:38.319024 [debug] [MainThread]: On master: BEGIN
[0m01:40:38.320046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:38.321058 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:38.321058 [debug] [MainThread]: On master: COMMIT
[0m01:40:38.322433 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:38.323445 [debug] [MainThread]: On master: COMMIT
[0m01:40:38.323445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:40:38.324444 [debug] [MainThread]: On master: Close
[0m01:40:38.325447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:38.326482 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m01:40:38.326482 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m01:40:38.327496 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m01:40:38.327496 [info ] [MainThread]: 
[0m01:40:38.328483 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m01:40:38.328483 [debug] [MainThread]: Command end result
[0m01:40:38.350746 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m01:40:38.353950 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m01:40:38.360233 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m01:40:38.361225 [info ] [MainThread]: 
[0m01:40:38.362401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:38.362401 [info ] [MainThread]: 
[0m01:40:38.363609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:40:38.364618 [debug] [MainThread]: Command `dbt run` succeeded at 01:40:38.364618 after 2.29 seconds
[0m01:40:38.365641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA291CEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA291CE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA23430290>]}
[0m01:40:38.366622 [debug] [MainThread]: Flushing usage events
[0m01:40:38.996636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:31.737439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511762450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511726290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511726010>]}


============================== 21:44:31.763726 | 3a83d5b2-44f2-48c3-8e59-a5507bd6b48e ==============================
[0m21:44:31.763726 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:44:31.765702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:44:32.748090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155118DF090>]}
[0m21:44:32.828536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001550D465090>]}
[0m21:44:32.857932 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:44:33.299634 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:44:34.694197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:34.694197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:34.718716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511D435D0>]}
[0m21:44:35.058352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511C70E90>]}
[0m21:44:35.059289 [info ] [MainThread]: Found 1 model, 428 macros
[0m21:44:35.060286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511C96D50>]}
[0m21:44:35.062286 [info ] [MainThread]: 
[0m21:44:35.063039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:35.064058 [info ] [MainThread]: 
[0m21:44:35.065067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:44:35.068806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m21:44:38.799653 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:44:38.799653 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m21:44:38.800654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:38.958765 [debug] [ThreadPool]: SQL status: OK in 0.159 seconds
[0m21:44:38.960081 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:44:38.960081 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m21:44:39.007057 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m21:44:39.009999 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m21:44:39.029762 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m21:44:39.030810 [debug] [ThreadPool]: On list_database_main: Close
[0m21:44:39.032828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a83d5b2-44f2-48c3-8e59-a5507bd6b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511A0CB90>]}
[0m21:44:39.049152 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m21:44:39.050486 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m21:44:39.052501 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m21:44:39.058501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m21:44:39.059504 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m21:44:39.061862 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m21:44:39.064185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:39.064185 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m21:44:39.065165 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m21:44:39.066178 [debug] [MainThread]: Command end result
[0m21:44:39.125641 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m21:44:39.187469 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m21:44:39.195982 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m21:44:39.646070 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m21:44:39.647073 [info ] [MainThread]: Building catalog
[0m21:44:39.655423 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m21:44:39.662117 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:44:39.663104 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m21:44:39.663104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:39.665591 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:44:39.665591 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:44:39.666619 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m21:44:39.684721 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m21:44:39.688723 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m21:44:39.690034 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m21:44:39.690034 [debug] [ThreadPool]: On database.information_schema: Close
[0m21:44:39.701971 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m21:44:39.777742 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m21:44:39.780776 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m21:44:39.781775 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m21:44:39.782772 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:44:39.782772 after 8.16 seconds
[0m21:44:39.782772 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:44:39.783786 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m21:44:39.783786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015511998910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001550B640050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001550D351590>]}
[0m21:44:39.784768 [debug] [MainThread]: Flushing usage events
[0m21:44:40.655465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:42.521502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C39D5E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C39ACE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C39D5C690>]}


============================== 21:45:42.526738 | 1b341ee6-0826-4596-9607-4c804b8e9bef ==============================
[0m21:45:42.526738 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:45:42.529200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:45:42.828052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b341ee6-0826-4596-9607-4c804b8e9bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C39D1BF90>]}
[0m21:45:42.897772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b341ee6-0826-4596-9607-4c804b8e9bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C34A95A50>]}
[0m22:15:06.762349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36EB6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36EB6E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36EB4110>]}


============================== 22:15:06.768920 | bf89d5d2-7c25-40c2-8ce1-6efc9095467a ==============================
[0m22:15:06.768920 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:15:06.769907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:07.058879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36F23890>]}
[0m22:15:07.141225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C32C32850>]}
[0m22:15:07.147975 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:15:07.613451 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:15:07.883197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:07.885294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:07.932070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C384F18D0>]}
[0m22:15:08.014973 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:15:08.023249 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:15:08.110364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C38134D90>]}
[0m22:15:08.111375 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:15:08.112376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C384A2D10>]}
[0m22:15:08.114374 [info ] [MainThread]: 
[0m22:15:08.114374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:08.115687 [info ] [MainThread]: 
[0m22:15:08.116794 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:15:08.118026 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:15:08.258722 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:15:08.260115 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:15:08.261108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:08.305217 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m22:15:08.307264 [debug] [ThreadPool]: On list_database: Close
[0m22:15:08.308305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:15:08.310526 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:15:08.316576 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:15:08.316576 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:15:08.317577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:08.322169 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:15:08.323721 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:15:08.323721 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:15:08.324757 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:08.325754 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:15:08.325754 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:15:08.328753 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:15:08.329755 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:15:08.329755 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:15:08.330755 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:15:08.331062 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:08.331062 [debug] [ThreadPool]: On create_database_main: Close
[0m22:15:08.333668 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:15:08.339978 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:15:08.341011 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:15:08.341011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:08.342010 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:15:08.343538 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:15:08.344569 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:15:08.380446 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m22:15:08.383456 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:15:08.386051 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:15:08.386051 [debug] [ThreadPool]: On list_database_main: Close
[0m22:15:08.388085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C388B4F10>]}
[0m22:15:08.389091 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:08.390084 [debug] [MainThread]: On master: BEGIN
[0m22:15:08.391097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:08.391097 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:08.392083 [debug] [MainThread]: On master: COMMIT
[0m22:15:08.395065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:08.395065 [debug] [MainThread]: On master: COMMIT
[0m22:15:08.396584 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:08.397839 [debug] [MainThread]: On master: Close
[0m22:15:08.405634 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:15:08.406698 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m22:15:08.407224 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:15:08.408235 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:15:08.414834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:15:08.416561 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:15:08.448411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m22:15:08.452264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.453437 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m22:15:08.454534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:08.455542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:15:08.455542 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.456729 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:15:08.460703 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:15:08.466732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.466732 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m22:15:08.469719 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:08.473286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.474286 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m22:15:08.475279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:15:08.489942 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:15:08.490321 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.490321 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:15:08.507934 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:15:08.572364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:15:08.572364 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m22:15:08.584608 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m22:15:08.587507 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m22:15:08.601301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf89d5d2-7c25-40c2-8ce1-6efc9095467a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C38ABF510>]}
[0m22:15:08.602300 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.18s]
[0m22:15:08.603311 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:15:08.605838 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:08.606858 [debug] [MainThread]: On master: BEGIN
[0m22:15:08.606858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:08.608100 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:08.608100 [debug] [MainThread]: On master: COMMIT
[0m22:15:08.609165 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:08.609165 [debug] [MainThread]: On master: COMMIT
[0m22:15:08.610145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:08.610145 [debug] [MainThread]: On master: Close
[0m22:15:08.610145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:08.611653 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:15:08.611653 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:15:08.611653 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:15:08.611653 [info ] [MainThread]: 
[0m22:15:08.612941 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m22:15:08.612941 [debug] [MainThread]: Command end result
[0m22:15:08.634972 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:15:08.639226 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:15:08.646770 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:15:08.647763 [info ] [MainThread]: 
[0m22:15:08.647763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:08.648764 [info ] [MainThread]: 
[0m22:15:08.648764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:15:08.650763 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:08.649766 after 1.99 seconds
[0m22:15:08.650763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36F4E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C36F4FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C31D16E90>]}
[0m22:15:08.651764 [debug] [MainThread]: Flushing usage events
[0m22:15:09.262813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:33.959042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F60620D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F60A1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F60A0990>]}


============================== 22:16:33.967539 | 6e755f75-0021-475f-8877-2b9b8a7e7723 ==============================
[0m22:16:33.967539 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:16:33.969553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m22:16:34.338276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F60F8390>]}
[0m22:16:34.409152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F0CB5F50>]}
[0m22:16:34.413156 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:16:34.845619 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:16:35.011854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:35.013368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:35.037415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F662EF10>]}
[0m22:16:35.088532 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:16:35.092542 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:16:35.139709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F620BF90>]}
[0m22:16:35.140775 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:16:35.140775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F61B0C50>]}
[0m22:16:35.142265 [info ] [MainThread]: 
[0m22:16:35.143557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:35.143557 [info ] [MainThread]: 
[0m22:16:35.144578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:16:35.145658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:16:35.231451 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:16:35.231451 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:16:35.232697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:35.315766 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m22:16:35.318956 [debug] [ThreadPool]: On list_database: Close
[0m22:16:35.319956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:16:35.321955 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:16:35.328218 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:16:35.328218 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:16:35.329227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:35.334047 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:16:35.335052 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:16:35.336065 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:16:35.337429 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:16:35.338427 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:16:35.339417 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:16:35.341867 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:16:35.343404 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:16:35.344454 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:16:35.344454 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:16:35.345854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:35.345854 [debug] [ThreadPool]: On create_database_main: Close
[0m22:16:35.347860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:16:35.352878 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:16:35.354414 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:16:35.354414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:35.356438 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:16:35.356438 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:16:35.357825 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:16:35.395529 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m22:16:35.398080 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:16:35.401416 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:16:35.402415 [debug] [ThreadPool]: On list_database_main: Close
[0m22:16:35.404786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F6A94490>]}
[0m22:16:35.405873 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:35.405873 [debug] [MainThread]: On master: BEGIN
[0m22:16:35.405873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:35.407382 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:16:35.407382 [debug] [MainThread]: On master: COMMIT
[0m22:16:35.408896 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:35.408896 [debug] [MainThread]: On master: COMMIT
[0m22:16:35.409887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:35.410887 [debug] [MainThread]: On master: Close
[0m22:16:35.420436 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:16:35.421526 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m22:16:35.422526 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:16:35.422526 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:16:35.429061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:16:35.430102 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:16:35.462174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m22:16:35.465254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.466284 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m22:16:35.467284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:35.468284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:16:35.468284 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.469283 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:16:35.474394 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:16:35.480400 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.481403 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m22:16:35.483958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:16:35.486955 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.487958 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m22:16:35.488966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:16:35.503519 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:16:35.504535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.505542 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:16:35.517089 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:16:35.581673 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:16:35.582673 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m22:16:35.590259 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:16:35.592729 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m22:16:35.594923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e755f75-0021-475f-8877-2b9b8a7e7723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F6BBF190>]}
[0m22:16:35.596037 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 0.17s]
[0m22:16:35.597477 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:16:35.599487 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:35.599487 [debug] [MainThread]: On master: BEGIN
[0m22:16:35.600592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:35.600592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:16:35.602056 [debug] [MainThread]: On master: COMMIT
[0m22:16:35.602056 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:35.603113 [debug] [MainThread]: On master: COMMIT
[0m22:16:35.603113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:35.604581 [debug] [MainThread]: On master: Close
[0m22:16:35.606057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:35.606057 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:16:35.606057 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:16:35.607552 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:16:35.607552 [info ] [MainThread]: 
[0m22:16:35.608552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m22:16:35.608552 [debug] [MainThread]: Command end result
[0m22:16:35.635262 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:16:35.641261 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:16:35.648675 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:16:35.649233 [info ] [MainThread]: 
[0m22:16:35.649765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:35.650284 [info ] [MainThread]: 
[0m22:16:35.650802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:16:35.652461 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:35.651912 after 1.79 seconds
[0m22:16:35.652972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F6097BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F6097390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258EFF860D0>]}
[0m22:16:35.653659 [debug] [MainThread]: Flushing usage events
[0m22:16:36.407106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:27.358059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D462B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D497750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D4978D0>]}


============================== 22:26:27.367509 | 9f101992-5700-4337-9c8a-036d8553bcec ==============================
[0m22:26:27.367509 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:26:27.368511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:26:27.762289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D4F7F90>]}
[0m22:26:27.841871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D4E2990>]}
[0m22:26:27.847257 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:26:28.130336 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:26:28.419460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:26:28.419460 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\transform\shema.yml
[0m22:26:28.490850 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'exemplo_teste' in the 'models' section of file 'models\transform\shema.yml'
[0m22:26:28.549541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D70D990>]}
[0m22:26:28.621742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53DA13B10>]}
[0m22:26:28.621742 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:26:28.622915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D932A50>]}
[0m22:26:28.625409 [info ] [MainThread]: 
[0m22:26:28.625409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:28.626948 [info ] [MainThread]: 
[0m22:26:28.628976 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:26:28.630969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:26:28.853247 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:26:28.854255 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:26:28.854255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:28.973324 [debug] [ThreadPool]: SQL status: OK in 0.119 seconds
[0m22:26:28.973324 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:26:28.974328 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:26:29.015539 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m22:26:29.017589 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:26:29.019587 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:26:29.019587 [debug] [ThreadPool]: On list_database_main: Close
[0m22:26:29.022010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f101992-5700-4337-9c8a-036d8553bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D9D5250>]}
[0m22:26:29.032386 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:26:29.033410 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:26:29.034403 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:26:29.039724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:26:29.055012 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:26:29.056001 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:26:29.058377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:29.058377 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:26:29.059367 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:26:29.060378 [debug] [MainThread]: Command end result
[0m22:26:29.204577 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:26:29.208726 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:26:29.216086 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:26:29.223104 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:26:29.224619 [info ] [MainThread]: Building catalog
[0m22:26:29.232812 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m22:26:29.238959 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:26:29.238959 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m22:26:29.240003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:29.241449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:26:29.242648 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:26:29.242648 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:26:29.255208 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m22:26:29.257760 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m22:26:29.258756 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m22:26:29.258756 [debug] [ThreadPool]: On database.information_schema: Close
[0m22:26:29.269396 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:26:29.291021 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:26:29.294023 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:26:29.295025 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:26:29.296679 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:26:29.296679 after 2.06 seconds
[0m22:26:29.296679 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:26:29.297684 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m22:26:29.297684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53B4801D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A534EE0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53D954CD0>]}
[0m22:26:29.299199 [debug] [MainThread]: Flushing usage events
[0m22:26:29.967825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:36.442628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5BA277D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5BA9B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5BA9B290>]}


============================== 22:26:36.447181 | e810f335-1b68-416f-b6e0-a177a7ccff24 ==============================
[0m22:26:36.447181 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:26:36.448303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:36.678425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e810f335-1b68-416f-b6e0-a177a7ccff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5BB8F2D0>]}
[0m22:26:36.744626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e810f335-1b68-416f-b6e0-a177a7ccff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE567552D0>]}
[0m22:29:16.316336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA8277D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA862410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA863810>]}


============================== 22:29:16.321161 | 56037934-86ec-44b0-a1ff-56f6a8890954 ==============================
[0m22:29:16.321161 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:29:16.323172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m22:29:16.624829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCAA330D0>]}
[0m22:29:16.697621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6645850>]}
[0m22:29:16.703610 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:29:17.001913 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:29:17.242917 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:29:17.244121 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\transform\schema.yml
[0m22:29:17.318825 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'exemplo_teste' in the 'models' section of file 'models\transform\schema.yml'
[0m22:29:17.377589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCAB0CB50>]}
[0m22:29:17.408119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCAE25E50>]}
[0m22:29:17.409118 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:29:17.411708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA954B10>]}
[0m22:29:17.413733 [info ] [MainThread]: 
[0m22:29:17.414734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:17.414734 [info ] [MainThread]: 
[0m22:29:17.415733 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:29:17.417728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:29:17.543632 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:29:17.544649 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:29:17.544649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:17.701864 [debug] [ThreadPool]: SQL status: OK in 0.157 seconds
[0m22:29:17.703116 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:29:17.704117 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:29:17.747563 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m22:29:17.749923 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:29:17.752479 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:29:17.752479 [debug] [ThreadPool]: On list_database_main: Close
[0m22:29:17.754792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56037934-86ec-44b0-a1ff-56f6a8890954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCAEF5E10>]}
[0m22:29:17.762917 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:29:17.763441 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:29:17.764454 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:29:17.771384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:29:17.772393 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:29:17.772393 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:29:17.774965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:17.775958 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:29:17.776959 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:29:17.776959 [debug] [MainThread]: Command end result
[0m22:29:17.887315 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:29:17.891849 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:29:17.898422 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:29:17.902976 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:29:17.904292 [info ] [MainThread]: Building catalog
[0m22:29:17.913252 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m22:29:17.920252 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:29:17.921250 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m22:29:17.922257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:17.923249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:29:17.923249 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:29:17.924692 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:29:17.935688 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m22:29:17.939054 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m22:29:17.940073 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m22:29:17.940589 [debug] [ThreadPool]: On database.information_schema: Close
[0m22:29:17.949239 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:29:17.968917 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:29:17.971943 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:29:17.972942 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:29:17.973939 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:29:17.973939 after 1.75 seconds
[0m22:29:17.974939 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:29:17.974939 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m22:29:17.974939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA9F25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC47A0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA784890>]}
[0m22:29:17.976444 [debug] [MainThread]: Flushing usage events
[0m22:29:18.623417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:05.183313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1B27C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1B62DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1BA1210>]}


============================== 22:30:05.187333 | b99d08f0-dd48-48ec-b25b-b412657b9246 ==============================
[0m22:30:05.187333 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:30:05.188332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:05.189847 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project/profiles.yml
  
[0m22:30:05.192342 [debug] [MainThread]: Command `dbt docs generate` failed at 22:30:05.191359 after 0.13 seconds
[0m22:30:05.192342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1B2D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1BA1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D1BA3B90>]}
[0m22:30:05.193543 [debug] [MainThread]: Flushing usage events
[0m22:30:06.319409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:18.373133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4C9FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4C26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4CA4310>]}


============================== 22:30:18.377308 | 813be3ee-98af-409c-b6a6-1abf2b86de39 ==============================
[0m22:30:18.377308 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:30:18.378493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m22:30:18.380488 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project/profiles.yml
  
[0m22:30:18.381486 [debug] [MainThread]: Command `dbt docs serve` failed at 22:30:18.381486 after 0.09 seconds
[0m22:30:18.381486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4C2D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4C9EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4C9FBD0>]}
[0m22:30:18.382487 [debug] [MainThread]: Flushing usage events
[0m22:30:20.041040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:45.593746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04C27A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04C62F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04C61D50>]}


============================== 22:30:45.598316 | f1130116-4d93-429d-86fe-96e5de711add ==============================
[0m22:30:45.598316 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:30:45.599306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m22:30:45.870340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04CF7CD0>]}
[0m22:30:45.936701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFF975AD0>]}
[0m22:30:45.941095 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:30:46.214083 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:30:46.338262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:46.338262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:46.361742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB06250550>]}
[0m22:30:46.383010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB06132790>]}
[0m22:30:46.383010 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:30:46.385554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB062002D0>]}
[0m22:30:46.386554 [info ] [MainThread]: 
[0m22:30:46.388054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:46.388054 [info ] [MainThread]: 
[0m22:30:46.389223 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:30:46.391447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:30:46.468249 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:30:46.469757 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:30:46.469757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:46.487805 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:30:46.488810 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:30:46.489805 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:30:46.504455 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:30:46.506452 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:30:46.507452 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:30:46.507452 [debug] [ThreadPool]: On list_database_main: Close
[0m22:30:46.509450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1130116-4d93-429d-86fe-96e5de711add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB061A25D0>]}
[0m22:30:46.513777 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:30:46.515343 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:30:46.515343 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:30:46.521607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:30:46.523135 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:30:46.524144 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:30:46.526188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:46.526188 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:30:46.526188 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:30:46.527183 [debug] [MainThread]: Command end result
[0m22:30:46.576704 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:30:46.579209 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:30:46.585202 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:30:46.588758 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:30:46.589757 [info ] [MainThread]: Building catalog
[0m22:30:46.597740 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m22:30:46.603995 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:30:46.603995 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m22:30:46.604995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:46.605995 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:30:46.605995 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:30:46.606994 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:30:46.615034 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:30:46.617032 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m22:30:46.618035 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m22:30:46.619040 [debug] [ThreadPool]: On database.information_schema: Close
[0m22:30:46.627369 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:30:46.702199 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:30:46.704751 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:30:46.705793 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:30:46.707782 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:30:46.707782 after 1.20 seconds
[0m22:30:46.707782 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:30:46.708793 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m22:30:46.708793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04EF90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFEBE0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB06556A50>]}
[0m22:30:46.709782 [debug] [MainThread]: Flushing usage events
[0m22:30:47.280788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:52.550932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF09C61650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF09CA2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF09C611D0>]}


============================== 22:30:52.555010 | 27777e8f-8db3-4bc7-86aa-828b2a114b69 ==============================
[0m22:30:52.555010 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:30:52.556061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:30:52.784580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27777e8f-8db3-4bc7-86aa-828b2a114b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF04AFB350>]}
[0m22:30:52.849170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27777e8f-8db3-4bc7-86aa-828b2a114b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF048E4990>]}
[0m22:35:02.401931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E062590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E026290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E093450>]}


============================== 22:35:02.409236 | 90620751-ee95-4de0-b993-7e91895a75ac ==============================
[0m22:35:02.409236 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:35:02.410258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:02.629538 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('description' was unexpected)

Error encountered in D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\dbt_project.yml
[0m22:35:02.631522 [debug] [MainThread]: Command `dbt docs generate` failed at 22:35:02.631522 after 0.35 seconds
[0m22:35:02.632519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E02D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E249B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381E249A50>]}
[0m22:35:02.632519 [debug] [MainThread]: Flushing usage events
[0m22:35:03.321085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:18.002179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68662010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68626290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68486F90>]}


============================== 22:36:18.006170 | bf3b6d72-7ae8-44dc-bdae-208e25c701f7 ==============================
[0m22:36:18.006170 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:36:18.008192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:36:18.317080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64598F90>]}
[0m22:36:18.389057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64345250>]}
[0m22:36:18.394057 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:36:18.879661 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:36:19.049888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:19.049888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:19.073381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68C50750>]}
[0m22:36:19.128461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68B326D0>]}
[0m22:36:19.129462 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:36:19.130989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68627F50>]}
[0m22:36:19.133017 [info ] [MainThread]: 
[0m22:36:19.134006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:19.134006 [info ] [MainThread]: 
[0m22:36:19.136258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:36:19.137694 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:36:19.236361 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:36:19.236361 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:36:19.236361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:19.378644 [debug] [ThreadPool]: SQL status: OK in 0.142 seconds
[0m22:36:19.379790 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:36:19.379790 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:36:19.422361 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m22:36:19.425380 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:36:19.427363 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:36:19.428402 [debug] [ThreadPool]: On list_database_main: Close
[0m22:36:19.428402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3b6d72-7ae8-44dc-bdae-208e25c701f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68BA2590>]}
[0m22:36:19.438115 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:36:19.438626 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:36:19.439637 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:36:19.446163 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:36:19.448442 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:36:19.449446 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:36:19.451964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:19.451964 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:36:19.451964 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:36:19.453082 [debug] [MainThread]: Command end result
[0m22:36:19.507032 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:36:19.511561 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:36:19.522822 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:36:19.528658 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:36:19.529661 [info ] [MainThread]: Building catalog
[0m22:36:19.537593 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m22:36:19.545132 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:36:19.546136 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m22:36:19.546136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:19.548242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:36:19.549237 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:36:19.549237 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:36:19.563529 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m22:36:19.567527 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m22:36:19.568530 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m22:36:19.568530 [debug] [ThreadPool]: On database.information_schema: Close
[0m22:36:19.580235 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:36:19.656855 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:36:19.658857 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:36:19.659859 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:36:19.662862 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:36:19.661874 after 1.78 seconds
[0m22:36:19.662862 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:36:19.662862 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m22:36:19.664392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64427510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A68FDF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A62540050>]}
[0m22:36:19.665417 [debug] [MainThread]: Flushing usage events
[0m22:36:20.279140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:42.325931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE7B25D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE7B26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE7B9B2D0>]}


============================== 22:36:42.329951 | 39ec2405-3ce4-424e-86cc-d3b388673778 ==============================
[0m22:36:42.329951 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:36:42.331949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:36:42.597340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39ec2405-3ce4-424e-86cc-d3b388673778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE7B3A750>]}
[0m22:36:42.668444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39ec2405-3ce4-424e-86cc-d3b388673778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE27F5910>]}
[0m22:39:22.596043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC097F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAACE1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC021210>]}


============================== 22:39:22.603320 | 875754ee-b865-4938-9049-88d8e519c2bd ==============================
[0m22:39:22.603320 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:39:22.606432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:22.975306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC22C9D0>]}
[0m22:39:23.039733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA6D45A90>]}
[0m22:39:23.044963 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:39:23.517498 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:39:23.713817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:39:23.714825 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\transform\schema.yml
[0m22:39:23.923914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC29CA10>]}
[0m22:39:23.987339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC6EF450>]}
[0m22:39:23.988672 [info ] [MainThread]: Found 1 model, 428 macros
[0m22:39:23.990193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC2EC950>]}
[0m22:39:23.991214 [info ] [MainThread]: 
[0m22:39:23.992209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:23.993467 [info ] [MainThread]: 
[0m22:39:23.994539 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:39:23.998670 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:39:24.147533 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:39:24.148533 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:39:24.148533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:24.277338 [debug] [ThreadPool]: SQL status: OK in 0.128 seconds
[0m22:39:24.278352 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:39:24.278352 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:39:24.318568 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m22:39:24.322086 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:39:24.323985 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:39:24.325253 [debug] [ThreadPool]: On list_database_main: Close
[0m22:39:24.328000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875754ee-b865-4938-9049-88d8e519c2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC8B44D0>]}
[0m22:39:24.339541 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:39:24.340541 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m22:39:24.342069 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:39:24.348101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:39:24.356102 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:39:24.357081 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:39:24.358559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:24.359580 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:39:24.359580 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:39:24.360832 [debug] [MainThread]: Command end result
[0m22:39:24.419426 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:39:24.422760 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:39:24.430604 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\run_results.json
[0m22:39:24.437335 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:39:24.438358 [info ] [MainThread]: Building catalog
[0m22:39:24.450466 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m22:39:24.457892 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:39:24.457892 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m22:39:24.457892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:24.460760 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:39:24.460760 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m22:39:24.461821 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:39:24.472356 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m22:39:24.476365 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m22:39:24.477365 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m22:39:24.477365 [debug] [ThreadPool]: On database.information_schema: Close
[0m22:39:24.489771 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:39:24.510156 [debug] [MainThread]: Wrote artifact WritableManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\manifest.json
[0m22:39:24.512669 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\semantic_manifest.json
[0m22:39:24.513684 [info ] [MainThread]: Catalog written to D:\PROJECTS\DBT + DUCKDB + RAG\dbt_project\target\catalog.json
[0m22:39:24.514696 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:39:24.514696 after 2.05 seconds
[0m22:39:24.515756 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:39:24.515756 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m22:39:24.515756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAC78D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA5F20050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA8A1E950>]}
[0m22:39:24.516787 [debug] [MainThread]: Flushing usage events
[0m22:39:25.342949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:31.579271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210A096FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210A0551D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210A0576D0>]}


============================== 22:39:31.583356 | d222c16f-0697-4795-aa99-95cd8701c957 ==============================
[0m22:39:31.583356 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:39:31.584861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECTS\\DBT + DUCKDB + RAG\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:31.816075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd222c16f-0697-4795-aa99-95cd8701c957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022104F0AE90>]}
[0m22:39:31.882731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd222c16f-0697-4795-aa99-95cd8701c957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022104CF4C10>]}
[0m21:45:03.637774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE140C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCD64690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78024C2D0>]}


============================== 21:45:03.715938 | 8cba3c16-6abd-4e91-9a2c-774a260b6c13 ==============================
[0m21:45:03.715938 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:45:03.716651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m21:45:05.485956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cba3c16-6abd-4e91-9a2c-774a260b6c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE48A2C0>]}
[0m21:45:05.528055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cba3c16-6abd-4e91-9a2c-774a260b6c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E780176AD0>]}
[0m21:45:05.609251 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:45:05.725955 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:45:05.774783 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:45:05.775387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8cba3c16-6abd-4e91-9a2c-774a260b6c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E780500250>]}
[0m21:45:06.634535 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.stg_cars' (models\silver\stg_cars.sql) depends on a source named 'bronze.raw_cars' which was not found
[0m21:45:06.635415 [debug] [MainThread]: Command `dbt docs generate` failed at 21:45:06.635311 after 3.09 seconds
[0m21:45:06.635691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7818A8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7818A9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7804158D0>]}
[0m21:45:06.635939 [debug] [MainThread]: Flushing usage events
[0m21:45:07.399357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:31.152915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA42C46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA1D45BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA5113D90>]}


============================== 21:45:31.155882 | df5a38a8-cc19-419e-b990-7e9751d93e38 ==============================
[0m21:45:31.155882 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:45:31.156427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None'}
[0m21:45:31.301268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA44802B0>]}
[0m21:45:31.341774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA517A7A0>]}
[0m21:45:31.343558 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:45:31.451021 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:45:31.495221 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:45:31.495735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA61F1250>]}
[0m21:45:32.132787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA65A7980>]}
[0m21:45:32.373961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA6810590>]}
[0m21:45:32.374330 [info ] [MainThread]: Found 1 model, 429 macros
[0m21:45:32.374703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA65CE680>]}
[0m21:45:32.375799 [info ] [MainThread]: 
[0m21:45:32.376156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:32.376392 [info ] [MainThread]: 
[0m21:45:32.376746 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:45:32.377353 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m21:45:33.024059 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:45:33.024359 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m21:45:33.024560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:33.045489 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m21:45:33.045803 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:45:33.046017 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m21:45:33.053466 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:45:33.054446 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m21:45:33.055220 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m21:45:33.055460 [debug] [ThreadPool]: On list_database_main: Close
[0m21:45:33.056212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5a38a8-cc19-419e-b990-7e9751d93e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA68BB410>]}
[0m21:45:33.058196 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m21:45:33.058569 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.transform'
[0m21:45:33.058880 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m21:45:33.062612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m21:45:33.068062 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m21:45:33.068534 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m21:45:33.069445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:33.069827 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m21:45:33.070171 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m21:45:33.070904 [debug] [MainThread]: Command end result
[0m21:45:33.105221 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m21:45:33.114607 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m21:45:33.118608 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m21:45:33.426355 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m21:45:33.427207 [info ] [MainThread]: Building catalog
[0m21:45:33.438717 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m21:45:33.443203 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:45:33.443637 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m21:45:33.443867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:33.444346 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:33.444551 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:45:33.444758 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m21:45:33.447922 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:45:33.449372 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m21:45:33.449857 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m21:45:33.450082 [debug] [ThreadPool]: On database.information_schema: Close
[0m21:45:33.456235 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\dbt\csv-duckbd-dbt\dbt_project\target\catalog.json
[0m21:45:33.467207 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m21:45:33.468484 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m21:45:33.468725 [info ] [MainThread]: Catalog written to D:\dbt\csv-duckbd-dbt\dbt_project\target\catalog.json
[0m21:45:33.469337 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:45:33.469258 after 2.40 seconds
[0m21:45:33.469584 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:45:33.469770 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m21:45:33.469986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA6D14F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA68CA670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA43FB430>]}
[0m21:45:33.470218 [debug] [MainThread]: Flushing usage events
[0m21:45:34.321433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:41.704406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AECAF46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA545BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AED943D90>]}


============================== 21:45:41.707421 | 14ed421f-0d5a-4ec2-88d2-7e8f21cc72da ==============================
[0m21:45:41.707421 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:45:41.708366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m21:45:41.848393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14ed421f-0d5a-4ec2-88d2-7e8f21cc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AECCB02B0>]}
[0m21:45:41.889257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14ed421f-0d5a-4ec2-88d2-7e8f21cc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AED9968B0>]}
[0m21:59:03.830420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC3E442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC1905BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC45BAFD0>]}


============================== 21:59:03.833918 | 4f1df569-8aeb-48ac-8710-2cea38986914 ==============================
[0m21:59:03.833918 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:59:03.834312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m21:59:03.984793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC3FFC2B0>]}
[0m21:59:04.028131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC5DB2580>]}
[0m21:59:04.040171 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:59:04.207566 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:59:04.460919 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 7 files added, 0 files changed.
[0m21:59:04.461308 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\gold\avg_price_by_manufacturer_year.sql
[0m21:59:04.461592 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\silver\stg_cars.yml
[0m21:59:04.461835 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\transform\schema.yml
[0m21:59:04.462034 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\silver\stg_cars.sql
[0m21:59:04.462243 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\transform\transform.sql
[0m21:59:04.462434 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\gold\car_mileage_segments.sql
[0m21:59:04.462659 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\gold\gold_models.yml
[0m21:59:04.462873 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\bronze\transform.sql
[0m21:59:04.742782 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:59:04.743148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC63F0950>]}
[0m21:59:04.886248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC6326990>]}
[0m21:59:04.938284 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m21:59:04.940714 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m21:59:04.976429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC6119710>]}
[0m21:59:04.976787 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m21:59:04.977031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC661AC30>]}
[0m21:59:04.978226 [info ] [MainThread]: 
[0m21:59:04.978492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:04.978696 [info ] [MainThread]: 
[0m21:59:04.978996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:59:04.982420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m21:59:05.434138 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m21:59:05.434443 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m21:59:05.434688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:05.448897 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:59:05.449828 [debug] [ThreadPool]: On list_database: Close
[0m21:59:05.450384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m21:59:05.450735 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m21:59:05.454697 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:59:05.454948 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m21:59:05.455151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:05.455656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:59:05.456461 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:59:05.456681 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m21:59:05.456977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:59:05.457182 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:59:05.457366 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m21:59:05.457680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:59:05.458216 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m21:59:05.458436 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:59:05.458637 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m21:59:05.458905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:59:05.459110 [debug] [ThreadPool]: On create_database_main: Close
[0m21:59:05.459956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m21:59:05.463146 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:59:05.463438 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m21:59:05.463796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:05.464178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:59:05.464402 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:59:05.464641 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m21:59:05.471323 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:59:05.472140 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m21:59:05.481264 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m21:59:05.481529 [debug] [ThreadPool]: On list_database_main: Close
[0m21:59:05.482618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC66D2F90>]}
[0m21:59:05.482921 [debug] [MainThread]: Using duckdb connection "master"
[0m21:59:05.483111 [debug] [MainThread]: On master: BEGIN
[0m21:59:05.483294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:05.483635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:59:05.483836 [debug] [MainThread]: On master: COMMIT
[0m21:59:05.484015 [debug] [MainThread]: Using duckdb connection "master"
[0m21:59:05.484187 [debug] [MainThread]: On master: COMMIT
[0m21:59:05.484473 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:59:05.484689 [debug] [MainThread]: On master: Close
[0m21:59:05.486604 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m21:59:05.486981 [info ] [Thread-1 (]: 1 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m21:59:05.487325 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_cars'
[0m21:59:05.487561 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m21:59:05.491870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m21:59:05.492527 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m21:59:05.512741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m21:59:05.513458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m21:59:05.513709 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m21:59:05.513966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:59:05.514743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:59:05.514996 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m21:59:05.515241 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- Usando a data atual para tornar o cálculo dinâmico
    DATE_DIFF(CURRENT_DATE(), DATE(CAST("Year of manufacture" AS INT64), 1, 1), YEAR) AS car_age_years

FROM source
    );
  
  
[0m21:59:05.515855 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- Usando a data atual para tornar o cálculo dinâmico
    DATE_DIFF(CURRENT_DATE(), DATE(CAST("Year of manufacture" AS INT64), 1, 1), YEAR) AS car_age_years

FROM source
    );
  
  
[0m21:59:05.516126 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:59:05.516426 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: ROLLBACK
[0m21:59:05.571439 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_cars'
[0m21:59:05.571784 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m21:59:05.574227 [debug] [Thread-1 (]: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: Wrong number of arguments provided to DATE function
[0m21:59:05.576358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC6779BD0>]}
[0m21:59:05.576824 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model main.stg_cars ............................ [[31mERROR[0m in 0.09s]
[0m21:59:05.577208 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m21:59:05.577486 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m21:59:05.577854 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_cars' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: Wrong number of arguments provided to DATE function.
[0m21:59:05.578184 [info ] [Thread-1 (]: 2 of 4 START sql table model main.transform .................................... [RUN]
[0m21:59:05.579045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.transform)
[0m21:59:05.579315 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m21:59:05.580440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m21:59:05.581075 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m21:59:05.582925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m21:59:05.583441 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.583688 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m21:59:05.583902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:05.584310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:59:05.584561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.584792 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m21:59:05.585665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:59:05.589772 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.590052 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m21:59:05.590471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:59:05.592001 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.592255 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m21:59:05.592618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:59:05.602509 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m21:59:05.602793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.603021 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m21:59:05.613674 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:59:05.617197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m21:59:05.617475 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m21:59:05.619308 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:59:05.620959 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m21:59:05.621419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1df569-8aeb-48ac-8710-2cea38986914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC6B55590>]}
[0m21:59:05.621901 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.transform ............................... [[32mOK[0m in 0.04s]
[0m21:59:05.622329 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m21:59:05.622634 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m21:59:05.622955 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.avg_price_by_manufacturer_year ....................... [[33mSKIP[0m]
[0m21:59:05.623237 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m21:59:05.623479 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m21:59:05.623747 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.car_mileage_segments ................................. [[33mSKIP[0m]
[0m21:59:05.624011 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m21:59:05.624767 [debug] [MainThread]: Using duckdb connection "master"
[0m21:59:05.624997 [debug] [MainThread]: On master: BEGIN
[0m21:59:05.625194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:05.625504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:59:05.625714 [debug] [MainThread]: On master: COMMIT
[0m21:59:05.625898 [debug] [MainThread]: Using duckdb connection "master"
[0m21:59:05.626069 [debug] [MainThread]: On master: COMMIT
[0m21:59:05.626338 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:59:05.626526 [debug] [MainThread]: On master: Close
[0m21:59:05.626768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:05.626957 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m21:59:05.627133 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m21:59:05.627304 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m21:59:05.627520 [info ] [MainThread]: 
[0m21:59:05.627752 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m21:59:05.628265 [debug] [MainThread]: Command end result
[0m21:59:05.641567 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m21:59:05.642878 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m21:59:05.646668 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m21:59:05.646921 [info ] [MainThread]: 
[0m21:59:05.647332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:59:05.647964 [info ] [MainThread]: 
[0m21:59:05.648228 [error] [MainThread]: [31mFailure in model stg_cars (models\silver\stg_cars.sql)[0m
[0m21:59:05.648468 [error] [MainThread]:   Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: Wrong number of arguments provided to DATE function
[0m21:59:05.648653 [info ] [MainThread]: 
[0m21:59:05.648864 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.sql
[0m21:59:05.649044 [info ] [MainThread]: 
[0m21:59:05.649247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m21:59:05.649572 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:59:05.650020 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 21:59:05.649955 after 1.90 seconds
[0m21:59:05.650262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC64F3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC608B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC5D62350>]}
[0m21:59:05.650503 [debug] [MainThread]: Flushing usage events
[0m21:59:06.310623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:18.819193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A45B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A2025BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A4D2AFD0>]}


============================== 22:02:18.822721 | e9ee7d62-b0bd-4d32-8c9f-ef012c49c197 ==============================
[0m22:02:18.822721 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:02:18.823088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None'}
[0m22:02:18.962482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A476C2B0>]}
[0m22:02:19.005189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A651E580>]}
[0m22:02:19.006923 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:02:19.117753 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:02:19.234721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:19.235226 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\silver\stg_cars.sql
[0m22:02:19.500072 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:02:19.500484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A657B850>]}
[0m22:02:19.565160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6A13020>]}
[0m22:02:19.617249 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:02:19.618690 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:02:19.632460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6657CB0>]}
[0m22:02:19.632796 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:02:19.633051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6CB35F0>]}
[0m22:02:19.634272 [info ] [MainThread]: 
[0m22:02:19.634547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:19.634755 [info ] [MainThread]: 
[0m22:02:19.635077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:02:19.638984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:02:19.672090 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:02:19.672411 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:02:19.672627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:19.687487 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:02:19.688426 [debug] [ThreadPool]: On list_database: Close
[0m22:02:19.689051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:02:19.689384 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:02:19.693322 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:02:19.693569 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:02:19.693775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:19.694289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:02:19.695066 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:02:19.695287 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:02:19.695573 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:02:19.695774 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:02:19.695969 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:02:19.696268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:02:19.696923 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:02:19.697171 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:02:19.697363 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:02:19.697775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:02:19.698011 [debug] [ThreadPool]: On create_database_main: Close
[0m22:02:19.716585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:02:19.720268 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:02:19.720499 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:02:19.720706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:19.721054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:02:19.721316 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:02:19.721548 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:02:19.728126 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m22:02:19.728941 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:02:19.729670 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:02:19.729894 [debug] [ThreadPool]: On list_database_main: Close
[0m22:02:19.730626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6D03290>]}
[0m22:02:19.731021 [debug] [MainThread]: Using duckdb connection "master"
[0m22:02:19.731222 [debug] [MainThread]: On master: BEGIN
[0m22:02:19.731485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:19.731836 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:02:19.732040 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.732224 [debug] [MainThread]: Using duckdb connection "master"
[0m22:02:19.732401 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.732659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:02:19.732865 [debug] [MainThread]: On master: Close
[0m22:02:19.743914 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m22:02:19.744290 [info ] [Thread-1 (]: 1 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m22:02:19.744634 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_cars'
[0m22:02:19.744874 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m22:02:19.749434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m22:02:19.750052 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m22:02:19.772349 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m22:02:19.772992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:02:19.773260 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m22:02:19.773481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:02:19.774031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:02:19.774287 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:02:19.774537 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- CORREÇÃO: Construímos a data como uma string 'YYYY-01-01' antes de usar a função DATE()
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:02:19.776320 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- CORREÇÃO: Construímos a data como uma string 'YYYY-01-01' antes de usar a função DATE()
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:02:19.776626 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:02:19.776940 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: ROLLBACK
[0m22:02:19.781127 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_cars'
[0m22:02:19.781408 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m22:02:19.783841 [debug] [Thread-1 (]: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^
[0m22:02:19.785268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6D59E90>]}
[0m22:02:19.785718 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model main.stg_cars ............................ [[31mERROR[0m in 0.04s]
[0m22:02:19.786109 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m22:02:19.786363 [debug] [Thread-1 (]: Began running node model.dbt_project.transform
[0m22:02:19.786706 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_cars' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^.
[0m22:02:19.787029 [info ] [Thread-1 (]: 2 of 4 START sql table model main.transform .................................... [RUN]
[0m22:02:19.787804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.transform)
[0m22:02:19.788047 [debug] [Thread-1 (]: Began compiling node model.dbt_project.transform
[0m22:02:19.788992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.transform"
[0m22:02:19.789463 [debug] [Thread-1 (]: Began executing node model.dbt_project.transform
[0m22:02:19.791254 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.transform"
[0m22:02:19.791739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.791986 [debug] [Thread-1 (]: On model.dbt_project.transform: BEGIN
[0m22:02:19.792204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:19.792588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:02:19.792832 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.793046 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

  
    
    

    create  table
      "database"."main"."transform__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:02:19.793917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:02:19.798025 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.798351 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform" rename to "transform__dbt_backup"
[0m22:02:19.798791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:02:19.800375 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.800617 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */
alter table "database"."main"."transform__dbt_tmp" rename to "transform"
[0m22:02:19.801006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:02:19.810449 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:02:19.810738 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.810970 [debug] [Thread-1 (]: On model.dbt_project.transform: COMMIT
[0m22:02:19.817170 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:02:19.820716 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.transform"
[0m22:02:19.820990 [debug] [Thread-1 (]: On model.dbt_project.transform: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.transform"} */

      drop table if exists "database"."main"."transform__dbt_backup" cascade
    
[0m22:02:19.929078 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m22:02:19.932666 [debug] [Thread-1 (]: On model.dbt_project.transform: Close
[0m22:02:19.933153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ee7d62-b0bd-4d32-8c9f-ef012c49c197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A7056AD0>]}
[0m22:02:19.933580 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.transform ............................... [[32mOK[0m in 0.15s]
[0m22:02:19.933954 [debug] [Thread-1 (]: Finished running node model.dbt_project.transform
[0m22:02:19.934237 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:02:19.934714 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.avg_price_by_manufacturer_year ....................... [[33mSKIP[0m]
[0m22:02:19.935349 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:02:19.935804 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m22:02:19.936250 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.car_mileage_segments ................................. [[33mSKIP[0m]
[0m22:02:19.936679 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m22:02:19.937758 [debug] [MainThread]: Using duckdb connection "master"
[0m22:02:19.937989 [debug] [MainThread]: On master: BEGIN
[0m22:02:19.938179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:19.938541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:02:19.938738 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.938916 [debug] [MainThread]: Using duckdb connection "master"
[0m22:02:19.939081 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.939366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:02:19.939573 [debug] [MainThread]: On master: Close
[0m22:02:19.939805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:19.939979 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:02:19.940134 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:02:19.940295 [debug] [MainThread]: Connection 'model.dbt_project.transform' was properly closed.
[0m22:02:19.940513 [info ] [MainThread]: 
[0m22:02:19.940727 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m22:02:19.941212 [debug] [MainThread]: Command end result
[0m22:02:19.954777 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:02:19.956179 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:02:19.959948 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:02:19.960189 [info ] [MainThread]: 
[0m22:02:19.960441 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:19.960653 [info ] [MainThread]: 
[0m22:02:19.960897 [error] [MainThread]: [31mFailure in model stg_cars (models\silver\stg_cars.sql)[0m
[0m22:02:19.961127 [error] [MainThread]:   Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^
[0m22:02:19.961324 [info ] [MainThread]: 
[0m22:02:19.961550 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.sql
[0m22:02:19.961736 [info ] [MainThread]: 
[0m22:02:19.961949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m22:02:19.962273 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:02:19.962752 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 22:02:19.962686 after 1.25 seconds
[0m22:02:19.963071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A66E7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A67731D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A64D2350>]}
[0m22:02:19.963329 [debug] [MainThread]: Flushing usage events
[0m22:02:20.535401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:48.787960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205484B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020545F15BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020548C2AFD0>]}


============================== 22:05:48.791299 | 4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c ==============================
[0m22:05:48.791299 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:05:48.791692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m22:05:48.935930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054866C2B0>]}
[0m22:05:48.978701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054A41E580>]}
[0m22:05:48.980473 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:05:49.087723 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:05:49.185819 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m22:05:49.186221 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\bronze\bronze.sql
[0m22:05:49.186491 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\bronze\schema.yml
[0m22:05:49.186900 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\transform\transform.sql
[0m22:05:49.512703 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:05:49.513071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054A47FB50>]}
[0m22:05:49.605085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054A9B7980>]}
[0m22:05:49.658623 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:05:49.660065 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:05:49.676056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054AB30210>]}
[0m22:05:49.676419 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:05:49.676673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054AD1C530>]}
[0m22:05:49.677923 [info ] [MainThread]: 
[0m22:05:49.678190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:49.678404 [info ] [MainThread]: 
[0m22:05:49.678718 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:49.682093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:05:49.715044 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:05:49.715329 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:05:49.715537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:49.731931 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:05:49.732825 [debug] [ThreadPool]: On list_database: Close
[0m22:05:49.733371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:05:49.733702 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:05:49.737915 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:05:49.738167 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:05:49.738372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:49.738917 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:05:49.739744 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:05:49.739961 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:05:49.740309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:05:49.740540 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:05:49.740748 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:05:49.741066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:05:49.741591 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:05:49.741805 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:05:49.741987 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:05:49.742268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:05:49.742477 [debug] [ThreadPool]: On create_database_main: Close
[0m22:05:49.743394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:05:49.746875 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:05:49.747117 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:05:49.747296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:49.747638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:05:49.748005 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:05:49.748242 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:05:49.755643 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:05:49.756919 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:05:49.757720 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:05:49.757951 [debug] [ThreadPool]: On list_database_main: Close
[0m22:05:49.758659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054AD92D50>]}
[0m22:05:49.758970 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.759164 [debug] [MainThread]: On master: BEGIN
[0m22:05:49.759344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:49.759658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:05:49.759879 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.760065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.760255 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.760529 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:05:49.760738 [debug] [MainThread]: On master: Close
[0m22:05:49.762652 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m22:05:49.763027 [info ] [Thread-1 (]: 1 of 4 START sql table model main.bronze ....................................... [RUN]
[0m22:05:49.763368 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m22:05:49.763599 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m22:05:49.767418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m22:05:49.767951 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m22:05:49.789697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m22:05:49.790502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:05:49.790786 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m22:05:49.791007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:49.791590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:49.791847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:05:49.792064 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
    
    

    create  table
      "database"."main"."bronze__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:05:49.792941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:05:49.796827 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:05:49.797106 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m22:05:49.797636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:05:49.806258 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:05:49.806535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:05:49.806759 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:05:49.814873 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m22:05:49.818224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:05:49.818503 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m22:05:49.819244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:05:49.820741 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m22:05:49.822301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054ADAEF10>]}
[0m22:05:49.822770 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.bronze .................................. [[32mOK[0m in 0.06s]
[0m22:05:49.823143 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m22:05:49.823398 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m22:05:49.823768 [info ] [Thread-1 (]: 2 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m22:05:49.824095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m22:05:49.824347 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m22:05:49.825895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m22:05:49.826422 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m22:05:49.828259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m22:05:49.828774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:05:49.829025 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m22:05:49.829256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:49.829642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:05:49.829894 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:05:49.830151 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- CORREÇÃO: Construímos a data como uma string 'YYYY-01-01' antes de usar a função DATE()
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:05:49.831991 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Geração de uma chave única para cada registro para garantir a integridade
    FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    -- CORREÇÃO: Construímos a data como uma string 'YYYY-01-01' antes de usar a função DATE()
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:05:49.832336 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:05:49.832644 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: ROLLBACK
[0m22:05:49.836833 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_cars'
[0m22:05:49.837103 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m22:05:49.839643 [debug] [Thread-1 (]: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^
[0m22:05:49.840011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8e42a4-5710-413d-a9c1-c5bfe2d62c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054B1A13B0>]}
[0m22:05:49.840440 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model main.stg_cars ............................ [[31mERROR[0m in 0.02s]
[0m22:05:49.840818 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m22:05:49.841210 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_cars' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^.
[0m22:05:49.842131 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:05:49.842438 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.avg_price_by_manufacturer_year ....................... [[33mSKIP[0m]
[0m22:05:49.842765 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:05:49.843029 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m22:05:49.843320 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.car_mileage_segments ................................. [[33mSKIP[0m]
[0m22:05:49.843632 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m22:05:49.844319 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.844547 [debug] [MainThread]: On master: BEGIN
[0m22:05:49.844744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:49.845102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:05:49.845309 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.845503 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.845679 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.845956 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:05:49.846182 [debug] [MainThread]: On master: Close
[0m22:05:49.846427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:49.846603 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:05:49.846770 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:05:49.846934 [debug] [MainThread]: Connection 'model.dbt_project.stg_cars' was properly closed.
[0m22:05:49.847147 [info ] [MainThread]: 
[0m22:05:49.847369 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m22:05:49.847921 [debug] [MainThread]: Command end result
[0m22:05:49.861159 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:05:49.862482 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:05:49.866227 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:05:49.866457 [info ] [MainThread]: 
[0m22:05:49.866702 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:49.866913 [info ] [MainThread]: 
[0m22:05:49.867157 [error] [MainThread]: [31mFailure in model stg_cars (models\silver\stg_cars.sql)[0m
[0m22:05:49.867406 [error] [MainThread]:   Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Scalar Function with name farm_fingerprint does not exist!
  Did you mean "age"?
  
  LINE 20:     FARM_FINGERPRINT(CONCAT(Model, "Year of manufacture", Mileage...
               ^
[0m22:05:49.867605 [info ] [MainThread]: 
[0m22:05:49.867832 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.sql
[0m22:05:49.868020 [info ] [MainThread]: 
[0m22:05:49.868222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m22:05:49.868554 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:05:49.868998 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 22:05:49.868933 after 1.16 seconds
[0m22:05:49.869264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054AC7BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054A996350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054A3D2350>]}
[0m22:05:49.869517 [debug] [MainThread]: Flushing usage events
[0m22:05:50.438022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:06.123283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB78ED42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB76935BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7964AFD0>]}


============================== 22:08:06.126526 | 079a9fda-2283-4247-ad0f-34b2e168d38a ==============================
[0m22:08:06.126526 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:08:06.127007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m22:08:06.268079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7908C2B0>]}
[0m22:08:06.312129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7AE3A580>]}
[0m22:08:06.313871 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:08:06.423774 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:08:06.526620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:08:06.527142 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\silver\stg_cars.sql
[0m22:08:06.793766 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:08:06.794144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7AE97A50>]}
[0m22:08:06.858193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B3B6E40>]}
[0m22:08:06.910058 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:08:06.911492 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:08:06.925888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7AFF7CB0>]}
[0m22:08:06.926210 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:08:06.926451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B65BAD0>]}
[0m22:08:06.927673 [info ] [MainThread]: 
[0m22:08:06.927939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:06.928147 [info ] [MainThread]: 
[0m22:08:06.928456 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:06.932120 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:08:06.964406 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:08:06.965153 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:08:06.965424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:06.980718 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:08:06.981767 [debug] [ThreadPool]: On list_database: Close
[0m22:08:06.982337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:08:06.982666 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:08:06.986654 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:08:06.986903 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:08:06.987142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:06.987667 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:08:06.988455 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:08:06.988675 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:08:06.988955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:08:06.989144 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:08:06.989330 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:08:06.989629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:08:06.990148 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:08:06.990373 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:08:06.990557 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:08:06.990876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:08:06.991103 [debug] [ThreadPool]: On create_database_main: Close
[0m22:08:06.991953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:08:06.995506 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:08:06.995741 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:08:06.995998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:06.996407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:08:06.996658 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:08:06.996884 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:08:07.003918 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:08:07.004734 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:08:07.005471 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:08:07.005702 [debug] [ThreadPool]: On list_database_main: Close
[0m22:08:07.006413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B69F350>]}
[0m22:08:07.006704 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:07.006895 [debug] [MainThread]: On master: BEGIN
[0m22:08:07.007097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:07.007570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:08:07.007809 [debug] [MainThread]: On master: COMMIT
[0m22:08:07.008014 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:07.008193 [debug] [MainThread]: On master: COMMIT
[0m22:08:07.008478 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:08:07.008686 [debug] [MainThread]: On master: Close
[0m22:08:07.010560 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m22:08:07.010914 [info ] [Thread-1 (]: 1 of 4 START sql table model main.bronze ....................................... [RUN]
[0m22:08:07.011256 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m22:08:07.011484 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m22:08:07.015270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m22:08:07.015795 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m22:08:07.038374 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m22:08:07.038960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.039217 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m22:08:07.039443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:07.039947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:08:07.040201 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.040435 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
    
    

    create  table
      "database"."main"."bronze__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:08:07.041290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:08:07.044847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.045123 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m22:08:07.045566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:08:07.047131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.047509 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m22:08:07.048213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:08:07.058412 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:08:07.058700 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.058919 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:08:07.065236 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:08:07.068474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:08:07.068728 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m22:08:07.069993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:08:07.071434 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m22:08:07.072787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B6F4680>]}
[0m22:08:07.073228 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.bronze .................................. [[32mOK[0m in 0.06s]
[0m22:08:07.073607 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m22:08:07.073865 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m22:08:07.074206 [info ] [Thread-1 (]: 2 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m22:08:07.074499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m22:08:07.074728 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m22:08:07.076237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m22:08:07.076745 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m22:08:07.078768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m22:08:07.079270 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:08:07.079531 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m22:08:07.079753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:07.080119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:08:07.080364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:08:07.080610 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Trocamos FARM_FINGERPRINT (BigQuery) por md5 (padrão/DuckDB) para gerar a chave única
    md5(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:08:07.081943 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Trocamos FARM_FINGERPRINT (BigQuery) por md5 (padrão/DuckDB) para gerar a chave única
    md5(CONCAT(Model, "Year of manufacture", Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos de dados para garantir consistência
    CAST("Engine size" AS FLOAT64) AS engine_size_liters,
    CAST("Year of manufacture" AS INT64) AS year_of_manufacture,
    CAST(Mileage AS INT64) AS mileage,
    CAST(Price AS NUMERIC) AS price_eur,

    -- Feature Engineering simples: calculando a idade do carro
    DATE_DIFF(CURRENT_DATE(), CAST(CONCAT("Year of manufacture", '-01-01') AS DATE), YEAR) AS car_age_years

FROM source
    );
  
  
[0m22:08:07.082269 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:08:07.082568 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: ROLLBACK
[0m22:08:07.086492 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_cars'
[0m22:08:07.086766 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m22:08:07.089194 [debug] [Thread-1 (]: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Type with name FLOAT64 does not exist!
  Did you mean "int64"?
[0m22:08:07.089523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079a9fda-2283-4247-ad0f-34b2e168d38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B6EC870>]}
[0m22:08:07.089922 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model main.stg_cars ............................ [[31mERROR[0m in 0.02s]
[0m22:08:07.090284 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m22:08:07.090668 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_cars' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Type with name FLOAT64 does not exist!
  Did you mean "int64"?.
[0m22:08:07.091552 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:08:07.091830 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.avg_price_by_manufacturer_year ....................... [[33mSKIP[0m]
[0m22:08:07.092139 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:08:07.092400 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m22:08:07.092684 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.car_mileage_segments ................................. [[33mSKIP[0m]
[0m22:08:07.092994 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m22:08:07.093716 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:07.093944 [debug] [MainThread]: On master: BEGIN
[0m22:08:07.094136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:07.094456 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:08:07.094665 [debug] [MainThread]: On master: COMMIT
[0m22:08:07.094849 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:07.095026 [debug] [MainThread]: On master: COMMIT
[0m22:08:07.095286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:08:07.095490 [debug] [MainThread]: On master: Close
[0m22:08:07.095727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:07.095907 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:08:07.096082 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:08:07.096241 [debug] [MainThread]: Connection 'model.dbt_project.stg_cars' was properly closed.
[0m22:08:07.096454 [info ] [MainThread]: 
[0m22:08:07.096677 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m22:08:07.097862 [debug] [MainThread]: Command end result
[0m22:08:07.110820 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:08:07.112079 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:08:07.116161 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:08:07.116400 [info ] [MainThread]: 
[0m22:08:07.116642 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:08:07.116863 [info ] [MainThread]: 
[0m22:08:07.117112 [error] [MainThread]: [31mFailure in model stg_cars (models\silver\stg_cars.sql)[0m
[0m22:08:07.117343 [error] [MainThread]:   Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Catalog Error: Type with name FLOAT64 does not exist!
  Did you mean "int64"?
[0m22:08:07.117525 [info ] [MainThread]: 
[0m22:08:07.117741 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.sql
[0m22:08:07.117928 [info ] [MainThread]: 
[0m22:08:07.118138 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m22:08:07.118456 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:08:07.118938 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 22:08:07.118870 after 1.09 seconds
[0m22:08:07.119211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B08C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7B0E4BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7ADF2350>]}
[0m22:08:07.119458 [debug] [MainThread]: Flushing usage events
[0m22:08:07.777047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:06.186905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC01F42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DBDC65BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC096AFD0>]}


============================== 22:11:06.190240 | f46327b9-0947-4f43-ab2f-47bd343bd10d ==============================
[0m22:11:06.190240 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:11:06.190621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m22:11:06.329859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC03A82B0>]}
[0m22:11:06.372107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2162580>]}
[0m22:11:06.373710 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:11:06.477856 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:11:06.585508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:06.586018 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\silver\stg_cars.sql
[0m22:11:06.849621 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:11:06.850001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC21B7E50>]}
[0m22:11:06.912541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC26528A0>]}
[0m22:11:06.964159 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:11:06.965880 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:11:06.979763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2297CB0>]}
[0m22:11:06.980101 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:11:06.980340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC28FF930>]}
[0m22:11:06.981906 [info ] [MainThread]: 
[0m22:11:06.982198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:11:06.982403 [info ] [MainThread]: 
[0m22:11:06.982724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:11:06.987281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:11:07.020352 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:11:07.020669 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:11:07.020885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:07.035563 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:11:07.036488 [debug] [ThreadPool]: On list_database: Close
[0m22:11:07.037002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:11:07.037333 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:11:07.041316 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:07.041556 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:11:07.041761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:07.042255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:07.043073 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:07.043288 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:11:07.043634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:07.043848 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:07.044032 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:11:07.044335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:07.044850 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:11:07.045063 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:07.045251 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:11:07.045527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:07.045747 [debug] [ThreadPool]: On create_database_main: Close
[0m22:11:07.057469 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:11:07.061056 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:11:07.061292 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:11:07.061473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:07.061808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:07.062021 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:11:07.062210 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:11:07.069610 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:11:07.070452 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:11:07.071197 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:11:07.071432 [debug] [ThreadPool]: On list_database_main: Close
[0m22:11:07.072207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC293AED0>]}
[0m22:11:07.072510 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:07.072701 [debug] [MainThread]: On master: BEGIN
[0m22:11:07.072880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:07.073185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:07.073390 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.073582 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:07.073753 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.074035 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:07.074250 [debug] [MainThread]: On master: Close
[0m22:11:07.080854 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m22:11:07.081214 [info ] [Thread-1 (]: 1 of 4 START sql table model main.bronze ....................................... [RUN]
[0m22:11:07.081669 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m22:11:07.081996 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m22:11:07.085760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m22:11:07.086275 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m22:11:07.108878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m22:11:07.109471 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.109749 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m22:11:07.109970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:07.110572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:07.110842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.111068 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
    
    

    create  table
      "database"."main"."bronze__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:11:07.111955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:07.115927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.116194 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m22:11:07.116618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:07.118235 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.118475 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m22:11:07.118867 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:07.128538 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:11:07.128804 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.129027 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:11:07.135902 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:11:07.139254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:07.139536 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m22:11:07.140822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:07.142292 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m22:11:07.143673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2994520>]}
[0m22:11:07.144114 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.bronze .................................. [[32mOK[0m in 0.06s]
[0m22:11:07.144491 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m22:11:07.144741 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m22:11:07.145082 [info ] [Thread-1 (]: 2 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m22:11:07.145362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m22:11:07.145594 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m22:11:07.147542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m22:11:07.148306 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m22:11:07.150405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m22:11:07.150954 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:07.151201 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m22:11:07.151421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:07.151800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:07.152047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:07.152298 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Corrigido: DuckDB usa md5 + cast para hex
    md5(CAST(Model || "Year of manufacture" || Mileage AS VARCHAR)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro (DuckDB não tem DATE_DIFF igual ao BQ)
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source;
    );
  
  
[0m22:11:07.152816 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    -- Seleciona os dados da fonte bruta (camada Bronze)
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Corrigido: DuckDB usa md5 + cast para hex
    md5(CAST(Model || "Year of manufacture" || Mileage AS VARCHAR)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro (DuckDB não tem DATE_DIFF igual ao BQ)
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source;
    );
  
  
[0m22:11:07.153121 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:11:07.153412 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: ROLLBACK
[0m22:11:07.157257 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_cars'
[0m22:11:07.157520 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m22:11:07.159844 [debug] [Thread-1 (]: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: syntax error at or near ";"
[0m22:11:07.160153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46327b9-0947-4f43-ab2f-47bd343bd10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2980870>]}
[0m22:11:07.160538 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model main.stg_cars ............................ [[31mERROR[0m in 0.01s]
[0m22:11:07.160894 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m22:11:07.161292 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_cars' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: syntax error at or near ";".
[0m22:11:07.162069 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:07.162348 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.avg_price_by_manufacturer_year ....................... [[33mSKIP[0m]
[0m22:11:07.162646 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:07.162901 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m22:11:07.163131 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.car_mileage_segments ................................. [[33mSKIP[0m]
[0m22:11:07.163396 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m22:11:07.164364 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:07.164581 [debug] [MainThread]: On master: BEGIN
[0m22:11:07.164800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:07.165216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:07.165438 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.165633 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:07.165810 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.166091 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:07.166309 [debug] [MainThread]: On master: Close
[0m22:11:07.166551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:07.166744 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:11:07.166908 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:11:07.167071 [debug] [MainThread]: Connection 'model.dbt_project.stg_cars' was properly closed.
[0m22:11:07.167282 [info ] [MainThread]: 
[0m22:11:07.167501 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m22:11:07.167994 [debug] [MainThread]: Command end result
[0m22:11:07.181029 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:11:07.182421 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:11:07.186237 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:11:07.186464 [info ] [MainThread]: 
[0m22:11:07.186696 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:11:07.186896 [info ] [MainThread]: 
[0m22:11:07.187127 [error] [MainThread]: [31mFailure in model stg_cars (models\silver\stg_cars.sql)[0m
[0m22:11:07.187351 [error] [MainThread]:   Runtime Error in model stg_cars (models\silver\stg_cars.sql)
  Parser Error: syntax error at or near ";"
[0m22:11:07.187536 [info ] [MainThread]: 
[0m22:11:07.187752 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.sql
[0m22:11:07.187944 [info ] [MainThread]: 
[0m22:11:07.188140 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m22:11:07.188461 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:11:07.188901 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 22:11:07.188835 after 1.11 seconds
[0m22:11:07.189146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2327D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2385950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2112350>]}
[0m22:11:07.189387 [debug] [MainThread]: Flushing usage events
[0m22:11:07.838342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:57.644978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B4042F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE08E55BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0BB7AFD0>]}


============================== 22:11:57.648454 | 9b69f338-b7ad-4581-8ab0-657379965cc4 ==============================
[0m22:11:57.648454 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:11:57.648824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m22:11:57.788522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B5BC2B0>]}
[0m22:11:57.830650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0D372580>]}
[0m22:11:57.832973 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:11:57.939666 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:11:58.042798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:58.043315 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\silver\stg_cars.sql
[0m22:11:58.324410 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:11:58.324802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0D3C3E50>]}
[0m22:11:58.389772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0D8868A0>]}
[0m22:11:58.442773 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:11:58.444227 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:11:58.460066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0D4C7CB0>]}
[0m22:11:58.460432 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:11:58.460672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DB2F930>]}
[0m22:11:58.461896 [info ] [MainThread]: 
[0m22:11:58.462177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:11:58.462383 [info ] [MainThread]: 
[0m22:11:58.462702 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:11:58.465920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:11:58.498967 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:11:58.499288 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:11:58.499516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:58.516239 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:11:58.517338 [debug] [ThreadPool]: On list_database: Close
[0m22:11:58.517832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:11:58.518153 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:11:58.522189 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:58.522444 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:11:58.522686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:58.523231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:11:58.524036 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:58.524257 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:11:58.524571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:58.524771 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:58.524952 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:11:58.525277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:58.525815 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:11:58.526037 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:11:58.526228 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:11:58.526555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:58.526803 [debug] [ThreadPool]: On create_database_main: Close
[0m22:11:58.527737 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:11:58.531558 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:11:58.531834 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:11:58.532018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:58.532351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:11:58.532543 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:11:58.532725 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:11:58.539544 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:11:58.540407 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:11:58.541182 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:11:58.541413 [debug] [ThreadPool]: On list_database_main: Close
[0m22:11:58.542232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DB22F90>]}
[0m22:11:58.542547 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:58.542740 [debug] [MainThread]: On master: BEGIN
[0m22:11:58.542927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:58.543259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:58.543461 [debug] [MainThread]: On master: COMMIT
[0m22:11:58.543651 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:58.543819 [debug] [MainThread]: On master: COMMIT
[0m22:11:58.544099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:58.544312 [debug] [MainThread]: On master: Close
[0m22:11:58.546232 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m22:11:58.546594 [info ] [Thread-1 (]: 1 of 4 START sql table model main.bronze ....................................... [RUN]
[0m22:11:58.546946 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m22:11:58.547180 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m22:11:58.550917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m22:11:58.551462 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m22:11:58.574269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m22:11:58.574943 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.575239 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m22:11:58.575462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:58.576005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:58.576258 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.576490 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
    
    

    create  table
      "database"."main"."bronze__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m22:11:58.577377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:58.581099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.581430 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m22:11:58.581996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.583694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.583950 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m22:11:58.584346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.594323 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:11:58.594604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.594830 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m22:11:58.601389 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:11:58.604919 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m22:11:58.605212 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m22:11:58.606563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:11:58.608138 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m22:11:58.609604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DBC4520>]}
[0m22:11:58.610048 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.bronze .................................. [[32mOK[0m in 0.06s]
[0m22:11:58.610435 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m22:11:58.610697 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m22:11:58.611048 [info ] [Thread-1 (]: 2 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m22:11:58.611344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m22:11:58.611582 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m22:11:58.613137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m22:11:58.613660 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m22:11:58.615902 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m22:11:58.616463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:58.616732 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m22:11:58.616951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:58.617363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.617588 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:58.617825 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Usando md5 + hex() para gerar string estável como ID
    hex(md5(Model || "Year of manufacture" || Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
    );
  
  
[0m22:11:58.645300 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m22:11:58.647182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:58.647454 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter table "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m22:11:58.647991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.649127 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m22:11:58.649404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:58.649626 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m22:11:58.721224 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m22:11:58.722814 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m22:11:58.723081 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop table if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m22:11:58.723529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.724423 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m22:11:58.724802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DF91E50>]}
[0m22:11:58.725207 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.stg_cars ................................ [[32mOK[0m in 0.11s]
[0m22:11:58.725571 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m22:11:58.726243 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:58.726558 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m22:11:58.726847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m22:11:58.727081 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:58.728844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.729696 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:58.731649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.732379 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.732669 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m22:11:58.732889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:58.733283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.733509 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.733734 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m22:11:58.738312 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:11:58.740323 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.740603 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m22:11:58.741013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.742043 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m22:11:58.742302 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.742518 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m22:11:58.746503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:11:58.747836 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m22:11:58.748138 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m22:11:58.748559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.749466 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m22:11:58.749839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DE4DB50>]}
[0m22:11:58.750290 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.02s]
[0m22:11:58.750665 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m22:11:58.750916 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m22:11:58.751211 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m22:11:58.751542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m22:11:58.751786 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m22:11:58.753308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m22:11:58.754107 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m22:11:58.756161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m22:11:58.756698 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m22:11:58.756960 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m22:11:58.757174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:58.757569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.757824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m22:11:58.758061 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m22:11:58.775011 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m22:11:58.776904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m22:11:58.777177 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m22:11:58.777657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.778665 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m22:11:58.778913 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m22:11:58.779134 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m22:11:58.845671 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m22:11:58.848285 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m22:11:58.848774 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m22:11:58.849245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:11:58.850145 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m22:11:58.850524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b69f338-b7ad-4581-8ab0-657379965cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DE80BB0>]}
[0m22:11:58.850932 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.10s]
[0m22:11:58.851302 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m22:11:58.852307 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:58.852535 [debug] [MainThread]: On master: BEGIN
[0m22:11:58.852724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:58.853066 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:58.853273 [debug] [MainThread]: On master: COMMIT
[0m22:11:58.853454 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:58.853632 [debug] [MainThread]: On master: COMMIT
[0m22:11:58.853919 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:11:58.854131 [debug] [MainThread]: On master: Close
[0m22:11:58.854378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:58.854553 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m22:11:58.854722 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:11:58.854881 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m22:11:58.855105 [info ] [MainThread]: 
[0m22:11:58.855333 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m22:11:58.855941 [debug] [MainThread]: Command end result
[0m22:11:58.869127 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:11:58.870611 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:11:58.874505 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:11:58.874744 [info ] [MainThread]: 
[0m22:11:58.874999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:58.875200 [info ] [MainThread]: 
[0m22:11:58.875416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:11:58.875743 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:11:58.876206 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 22:11:58.876142 after 1.35 seconds
[0m22:11:58.876464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DDA7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0DDA7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0ADA6E10>]}
[0m22:11:58.876713 [debug] [MainThread]: Flushing usage events
[0m22:11:59.444930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:12:01.107692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F53142F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F2D85BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F5A8AFD0>]}


============================== 22:12:01.111017 | 397f0a48-de5c-4404-bc4b-a0728f5a8de7 ==============================
[0m22:12:01.111017 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:12:01.111401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'D:\\dbt\\csv-duckbd-dbt\\dbt_project\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m22:12:01.252809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F54CC2B0>]}
[0m22:12:01.295602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F7282690>]}
[0m22:12:01.297488 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:12:01.405849 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:12:01.504234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:12:01.504561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:12:01.535129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F72D4350>]}
[0m22:12:01.588915 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:12:01.590457 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:12:01.721660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F78DE6C0>]}
[0m22:12:01.722073 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 429 macros
[0m22:12:01.722326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F8E10910>]}
[0m22:12:01.723771 [info ] [MainThread]: 
[0m22:12:01.724047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:12:01.724264 [info ] [MainThread]: 
[0m22:12:01.724584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:12:01.727774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m22:12:01.802475 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:12:01.802790 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:12:01.802989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:01.817839 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:12:01.818189 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:12:01.818407 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:12:01.825328 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:12:01.826350 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:12:01.827160 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:12:01.827399 [debug] [ThreadPool]: On list_database_main: Close
[0m22:12:01.828473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397f0a48-de5c-4404-bc4b-a0728f5a8de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F8DE3790>]}
[0m22:12:01.828822 [debug] [MainThread]: Using duckdb connection "master"
[0m22:12:01.829032 [debug] [MainThread]: On master: BEGIN
[0m22:12:01.829215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:01.829543 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:12:01.829742 [debug] [MainThread]: On master: COMMIT
[0m22:12:01.829925 [debug] [MainThread]: Using duckdb connection "master"
[0m22:12:01.830104 [debug] [MainThread]: On master: COMMIT
[0m22:12:01.830379 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:12:01.830573 [debug] [MainThread]: On master: Close
[0m22:12:01.833717 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m22:12:01.834057 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m22:12:01.834404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m22:12:01.834634 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m22:12:01.845451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m22:12:01.846168 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m22:12:01.858022 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m22:12:01.860549 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m22:12:01.860851 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m22:12:01.861078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:12:01.861639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:12:01.861995 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m22:12:01.862260 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m22:12:01.864590 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:12:01.867590 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m22:12:01.868162 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m22:12:01.868425 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m22:12:01.868851 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.03s]
[0m22:12:01.869359 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m22:12:01.869630 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m22:12:01.869929 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m22:12:01.870223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m22:12:01.870454 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m22:12:01.873849 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m22:12:01.874533 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m22:12:01.876244 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m22:12:01.881177 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m22:12:01.881495 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m22:12:01.881790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.882252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.882623 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m22:12:01.882954 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m22:12:01.885137 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:12:01.886143 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m22:12:01.886599 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m22:12:01.886851 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m22:12:01.887259 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.02s]
[0m22:12:01.887628 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m22:12:01.887879 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m22:12:01.888179 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m22:12:01.888512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m22:12:01.888759 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m22:12:01.930582 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:01.931142 [error] [Thread-1 (]: 3 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[31mERROR[0m in 0.04s]
[0m22:12:01.931513 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m22:12:01.931956 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m22:12:01.932347 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:12:01.932735 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m22:12:01.933579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m22:12:01.933866 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m22:12:01.937857 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:01.938194 [error] [Thread-1 (]: 4 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[31mERROR[0m in 0.00s]
[0m22:12:01.938526 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m22:12:01.938773 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m22:12:01.939071 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:12:01.939338 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m22:12:01.939709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m22:12:01.939953 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m22:12:01.944237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m22:12:01.944804 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m22:12:01.946137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m22:12:01.946674 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m22:12:01.946942 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m22:12:01.947266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.947712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.947966 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m22:12:01.948249 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m22:12:01.948945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.949977 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m22:12:01.950443 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m22:12:01.950701 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m22:12:01.951072 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.01s]
[0m22:12:01.951438 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m22:12:01.951691 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m22:12:01.952041 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m22:12:01.952368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m22:12:01.952611 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m22:12:01.955099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m22:12:01.955663 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m22:12:01.956968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m22:12:01.959164 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m22:12:01.959438 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m22:12:01.959659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.960050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.960293 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m22:12:01.960520 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m22:12:01.961273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.962158 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m22:12:01.962576 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m22:12:01.962808 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m22:12:01.963162 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.01s]
[0m22:12:01.963514 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m22:12:01.963761 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m22:12:01.964332 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m22:12:01.964818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m22:12:01.965125 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m22:12:01.967490 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m22:12:01.968245 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m22:12:01.969809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m22:12:01.970432 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m22:12:01.970721 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m22:12:01.970942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.971342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.971579 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m22:12:01.971810 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m22:12:01.972444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.973356 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m22:12:01.973791 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m22:12:01.974050 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m22:12:01.974421 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.01s]
[0m22:12:01.974777 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m22:12:01.975030 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m22:12:01.975296 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m22:12:01.975568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m22:12:01.975791 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m22:12:01.978002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m22:12:01.978542 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m22:12:01.979889 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m22:12:01.980638 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m22:12:01.980946 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m22:12:01.981166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.981723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:12:01.981984 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m22:12:01.982213 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m22:12:01.982817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.984033 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m22:12:01.984483 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m22:12:01.984738 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m22:12:01.985109 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.01s]
[0m22:12:01.985478 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m22:12:01.985773 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m22:12:01.986126 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m22:12:01.986453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m22:12:01.986701 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m22:12:01.989012 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m22:12:01.989598 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m22:12:01.990991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m22:12:01.991517 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m22:12:01.991784 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m22:12:01.992006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.992370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.992595 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m22:12:01.992830 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m22:12:01.993465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:01.994367 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m22:12:01.994785 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m22:12:01.995029 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m22:12:01.995389 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.01s]
[0m22:12:01.995744 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m22:12:01.995985 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m22:12:01.996251 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m22:12:01.996542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m22:12:01.996772 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m22:12:01.999687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m22:12:02.000253 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m22:12:02.001556 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m22:12:02.003773 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m22:12:02.004034 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m22:12:02.004253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.004635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.004879 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m22:12:02.005101 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m22:12:02.005684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.006582 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m22:12:02.007014 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m22:12:02.007306 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m22:12:02.007668 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.01s]
[0m22:12:02.008020 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m22:12:02.008267 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m22:12:02.008541 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m22:12:02.008817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m22:12:02.009041 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m22:12:02.011268 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m22:12:02.011758 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m22:12:02.013312 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m22:12:02.013828 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m22:12:02.014475 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m22:12:02.014728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.015299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:12:02.015565 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m22:12:02.015796 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m22:12:02.016391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.017312 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m22:12:02.017738 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m22:12:02.017971 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m22:12:02.018326 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.01s]
[0m22:12:02.018684 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m22:12:02.018936 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m22:12:02.019155 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m22:12:02.019431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m22:12:02.019668 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m22:12:02.021988 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m22:12:02.022559 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m22:12:02.024097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m22:12:02.026261 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m22:12:02.026517 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m22:12:02.026729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.027091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.027339 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m22:12:02.027568 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m22:12:02.028126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.029029 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m22:12:02.029446 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m22:12:02.029688 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m22:12:02.030051 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.01s]
[0m22:12:02.030398 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m22:12:02.030635 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m22:12:02.030970 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m22:12:02.031258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m22:12:02.031543 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m22:12:02.035380 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m22:12:02.035934 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m22:12:02.037247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m22:12:02.037767 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m22:12:02.038015 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m22:12:02.038237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.038626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.038858 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m22:12:02.039077 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:12:02.046581 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:12:02.047673 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m22:12:02.048177 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m22:12:02.048442 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m22:12:02.048845 [error] [Thread-1 (]: 13 of 14 FAIL 66 unique_car_mileage_segments_car_id ............................ [[31mFAIL 66[0m in 0.02s]
[0m22:12:02.049217 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m22:12:02.049478 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m22:12:02.049752 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m22:12:02.050035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m22:12:02.050272 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m22:12:02.052896 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m22:12:02.053625 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m22:12:02.054942 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m22:12:02.055750 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m22:12:02.056009 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m22:12:02.056218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.056615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:12:02.056834 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m22:12:02.057064 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:12:02.063935 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:12:02.065032 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m22:12:02.065601 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m22:12:02.065851 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m22:12:02.066231 [error] [Thread-1 (]: 14 of 14 FAIL 66 unique_stg_cars_car_id ........................................ [[31mFAIL 66[0m in 0.02s]
[0m22:12:02.066579 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m22:12:02.067394 [debug] [MainThread]: Using duckdb connection "master"
[0m22:12:02.067629 [debug] [MainThread]: On master: BEGIN
[0m22:12:02.067816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:12:02.068174 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:12:02.068377 [debug] [MainThread]: On master: COMMIT
[0m22:12:02.068580 [debug] [MainThread]: Using duckdb connection "master"
[0m22:12:02.068759 [debug] [MainThread]: On master: COMMIT
[0m22:12:02.069087 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:12:02.069307 [debug] [MainThread]: On master: Close
[0m22:12:02.069551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:02.069736 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m22:12:02.069899 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m22:12:02.070104 [info ] [MainThread]: 
[0m22:12:02.070320 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m22:12:02.071596 [debug] [MainThread]: Command end result
[0m22:12:02.086662 [debug] [MainThread]: Wrote artifact WritableManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m22:12:02.088209 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\dbt\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m22:12:02.092799 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\dbt\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m22:12:02.093051 [info ] [MainThread]: 
[0m22:12:02.093323 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m22:12:02.093538 [info ] [MainThread]: 
[0m22:12:02.093796 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)[0m
[0m22:12:02.094041 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:02.094239 [info ] [MainThread]: 
[0m22:12:02.094487 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)[0m
[0m22:12:02.094727 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:02.094917 [info ] [MainThread]: 
[0m22:12:02.095145 [error] [MainThread]: [31mFailure in test unique_car_mileage_segments_car_id (models\gold\gold_models.yml)[0m
[0m22:12:02.095375 [error] [MainThread]:   Got 66 results, configured to fail if != 0
[0m22:12:02.095552 [info ] [MainThread]: 
[0m22:12:02.095772 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\gold\gold_models.yml\unique_car_mileage_segments_car_id.sql
[0m22:12:02.095956 [info ] [MainThread]: 
[0m22:12:02.096176 [error] [MainThread]: [31mFailure in test unique_stg_cars_car_id (models\silver\stg_cars.yml)[0m
[0m22:12:02.096403 [error] [MainThread]:   Got 66 results, configured to fail if != 0
[0m22:12:02.096584 [info ] [MainThread]: 
[0m22:12:02.096799 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.yml\unique_stg_cars_car_id.sql
[0m22:12:02.096984 [info ] [MainThread]: 
[0m22:12:02.097188 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=14
[0m22:12:02.097673 [debug] [MainThread]: Command `python -m dbt.cli.main test` failed at 22:12:02.097608 after 1.08 seconds
[0m22:12:02.097935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F610DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F785DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142F785F3E0>]}
[0m22:12:02.098194 [debug] [MainThread]: Flushing usage events
[0m22:12:02.514730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:58.027183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6FF13890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6FEF2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD752E2210>]}


============================== 19:04:58.051891 | ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b ==============================
[0m19:04:58.051891 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:04:58.051891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:04:58.889922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD753BE590>]}
[0m19:04:59.042298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6FF26B50>]}
[0m19:04:59.095258 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:04:59.960945 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:05:00.207171 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:05:00.208181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD73BB5790>]}
[0m19:05:04.187871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75C5A9D0>]}
[0m19:05:04.296982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:05:04.319878 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:05:04.735213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75A44510>]}
[0m19:05:04.735213 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 428 macros
[0m19:05:04.735213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75C754D0>]}
[0m19:05:04.741686 [info ] [MainThread]: 
[0m19:05:04.741686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:04.743431 [info ] [MainThread]: 
[0m19:05:04.743431 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:05:04.753645 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:05:09.470987 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:05:09.471997 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:05:09.473004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:09.546000 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m19:05:09.550709 [debug] [ThreadPool]: On list_database: Close
[0m19:05:09.552964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:05:09.556808 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:05:09.568746 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:05:09.570741 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:05:09.570741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:09.575742 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:05:09.577248 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:05:09.578255 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:05:09.580437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:05:09.581489 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:05:09.583501 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:05:09.585811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:05:09.589338 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:05:09.590344 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:05:09.592343 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:05:09.593343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:05:09.594344 [debug] [ThreadPool]: On create_database_main: Close
[0m19:05:09.597344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:05:09.607373 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:05:09.608879 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:05:09.608879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:09.610339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:05:09.611458 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:05:09.611458 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:05:09.656947 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m19:05:09.659948 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:05:09.683577 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:05:09.683577 [debug] [ThreadPool]: On list_database_main: Close
[0m19:05:09.686614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75E20650>]}
[0m19:05:09.687614 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:09.688612 [debug] [MainThread]: On master: BEGIN
[0m19:05:09.689616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:09.690614 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:05:09.690614 [debug] [MainThread]: On master: COMMIT
[0m19:05:09.692023 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:09.693026 [debug] [MainThread]: On master: COMMIT
[0m19:05:09.693026 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:05:09.694532 [debug] [MainThread]: On master: Close
[0m19:05:09.702733 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:05:09.703796 [info ] [Thread-1 (]: 1 of 4 START sql table model main.bronze ....................................... [RUN]
[0m19:05:09.704801 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:05:09.705851 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:05:09.714406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:05:09.718638 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:05:09.764449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:05:09.768062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.769062 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:05:09.769062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:09.771540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:09.771540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.772544 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
    
    

    create  table
      "database"."main"."bronze__dbt_tmp"
  
    as (
      SELECT
  *,
  'teste' AS teste
FROM input
    );
  
  
[0m19:05:09.777049 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:05:09.783889 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.785891 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:05:09.789312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:05:09.793416 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.793416 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:05:09.795477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:09.816616 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:05:09.817664 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.818740 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:05:09.822271 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:05:09.911889 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:05:09.912916 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:05:09.915235 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:09.918351 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:05:09.932183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75BD01D0>]}
[0m19:05:09.934184 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.bronze .................................. [[32mOK[0m in 0.22s]
[0m19:05:09.935184 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:05:09.937184 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:05:09.938184 [info ] [Thread-1 (]: 2 of 4 START sql table model main.stg_cars ..................................... [RUN]
[0m19:05:09.938184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:05:09.939689 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:05:09.942919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:05:09.945448 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:05:09.950350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:05:09.954008 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:09.955009 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:05:09.955009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:09.956009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:09.957010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:09.958009 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
    
    

    create  table
      "database"."main"."stg_cars__dbt_tmp"
  
    as (
      -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- Usando md5 + hex() para gerar string estável como ID
    hex(md5(Model || "Year of manufacture" || Mileage)) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
    );
  
  
[0m19:05:10.026420 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m19:05:10.030658 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:10.032719 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter table "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:05:10.033750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:05:10.038347 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:10.038347 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter table "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:05:10.040409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:10.042471 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:05:10.043656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:10.043656 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:05:10.075472 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m19:05:10.079410 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:05:10.080811 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop table if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:05:10.085573 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:05:10.089000 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:05:10.090509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD75964850>]}
[0m19:05:10.091739 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.stg_cars ................................ [[32mOK[0m in 0.15s]
[0m19:05:10.092996 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:05:10.095536 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:05:10.096813 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:05:10.098007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:05:10.100602 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:05:10.106165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.109225 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:05:10.119360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.131694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.133769 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:05:10.137781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:10.145320 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:05:10.146320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.147321 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:05:10.192517 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m19:05:10.200231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.202616 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:05:10.205126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:10.210733 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.211738 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:05:10.212743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:05:10.214752 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:05:10.216755 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.217262 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:05:10.221669 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:10.228235 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:05:10.229245 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:05:10.231509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:10.233513 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:05:10.234606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7589BFD0>]}
[0m19:05:10.236846 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.14s]
[0m19:05:10.236846 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:05:10.238351 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:05:10.239422 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:05:10.240426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:05:10.241429 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:05:10.244445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:05:10.246671 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:05:10.253302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:05:10.255317 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.257326 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:05:10.257326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:10.259603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:10.259603 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.260635 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:05:10.294191 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m19:05:10.298342 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.299373 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:05:10.300399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:10.305458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.305458 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:05:10.307904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:05:10.309922 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:05:10.310940 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.310940 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:05:10.334230 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:05:10.339205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:05:10.340231 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:05:10.342573 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:10.343589 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:05:10.345097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee68c6ed-a20c-4e5f-aa59-2832cc7c4b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7589A010>]}
[0m19:05:10.346145 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.10s]
[0m19:05:10.347650 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:05:10.349725 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:10.350748 [debug] [MainThread]: On master: BEGIN
[0m19:05:10.350748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:10.352778 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:05:10.353952 [debug] [MainThread]: On master: COMMIT
[0m19:05:10.353952 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:10.355474 [debug] [MainThread]: On master: COMMIT
[0m19:05:10.356603 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:05:10.357609 [debug] [MainThread]: On master: Close
[0m19:05:10.358677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:10.358677 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:05:10.359687 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:05:10.359687 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:05:10.360705 [info ] [MainThread]: 
[0m19:05:10.361842 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m19:05:10.363227 [debug] [MainThread]: Command end result
[0m19:05:10.398336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:05:10.404143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:05:10.411844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:05:10.412872 [info ] [MainThread]: 
[0m19:05:10.413902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:10.414918 [info ] [MainThread]: 
[0m19:05:10.414918 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:05:10.424909 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 19:05:10.423884 after 12.67 seconds
[0m19:05:10.425939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD759BD690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD735734D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD732736D0>]}
[0m19:05:10.426971 [debug] [MainThread]: Flushing usage events
[0m19:05:11.152364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:16.145665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09157690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA090D32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0915C510>]}


============================== 19:05:16.152185 | ca0f75b1-c638-4166-826f-1397f9fc41a5 ==============================
[0m19:05:16.152185 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:05:16.153186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:16.550466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA092F4150>]}
[0m19:05:16.649043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA03D35910>]}
[0m19:05:16.653952 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:05:17.079936 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:05:17.302046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:17.303048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:17.364609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09711550>]}
[0m19:05:17.485904 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:05:17.489045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:05:17.555632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0996C3D0>]}
[0m19:05:17.558851 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 428 macros
[0m19:05:17.558851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09157590>]}
[0m19:05:17.563900 [info ] [MainThread]: 
[0m19:05:17.563900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:17.566254 [info ] [MainThread]: 
[0m19:05:17.566254 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:05:17.572295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:05:17.746847 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:05:17.747357 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:05:17.747357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:17.792382 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m19:05:17.792382 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:05:17.796268 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:05:17.816767 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m19:05:17.818771 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:05:17.821277 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:05:17.821277 [debug] [ThreadPool]: On list_database_main: Close
[0m19:05:17.822322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0f75b1-c638-4166-826f-1397f9fc41a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0999B9D0>]}
[0m19:05:17.822322 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:17.825794 [debug] [MainThread]: On master: BEGIN
[0m19:05:17.827026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:17.827026 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:05:17.829746 [debug] [MainThread]: On master: COMMIT
[0m19:05:17.829746 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:17.829746 [debug] [MainThread]: On master: COMMIT
[0m19:05:17.831871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:05:17.832885 [debug] [MainThread]: On master: Close
[0m19:05:17.838140 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:05:17.838532 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:05:17.838532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:05:17.840685 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:05:17.862098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:05:17.865111 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:05:17.887794 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:05:17.894638 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:05:17.894638 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:05:17.894638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:17.897146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:17.898589 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:05:17.898589 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:05:17.905276 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:05:17.912182 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:05:17.912182 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:05:17.912182 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:05:17.914523 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.08s]
[0m19:05:17.916186 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:05:17.916186 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:05:17.917804 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:05:17.918307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:05:17.918307 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:05:17.925953 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:05:17.930308 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:05:17.934063 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:05:17.937469 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:05:17.937469 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:05:17.939476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:17.939476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:17.939476 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:05:17.942610 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:05:17.948082 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:05:17.951723 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:05:17.951723 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:05:17.951723 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:05:17.954582 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.03s]
[0m19:05:17.954582 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:05:17.954582 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:05:17.954582 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:05:17.959663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:05:17.961180 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:05:18.076164 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:05:18.078378 [error] [Thread-1 (]: 3 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[31mERROR[0m in 0.12s]
[0m19:05:18.078378 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:05:18.080450 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:05:18.081455 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:05:18.081455 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:05:18.084919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:05:18.084919 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:05:18.092797 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:05:18.094730 [error] [Thread-1 (]: 4 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[31mERROR[0m in 0.01s]
[0m19:05:18.094730 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:05:18.094730 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:05:18.094730 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:05:18.098333 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:05:18.099474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:05:18.099474 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:05:18.109449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:05:18.112750 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:05:18.115293 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:05:18.118262 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:05:18.118262 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:05:18.120718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.121743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.121743 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:05:18.123487 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.125980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.128060 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:05:18.130067 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:05:18.131573 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:05:18.133624 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m19:05:18.135630 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:05:18.135630 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:05:18.135630 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:05:18.137638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:05:18.137638 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:05:18.148117 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:05:18.148117 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:05:18.152697 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:05:18.156238 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:05:18.157246 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:05:18.157246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.159461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.160712 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:05:18.160712 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.163553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.164585 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:05:18.166591 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:05:18.166591 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:05:18.166591 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:05:18.168598 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:05:18.168598 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:05:18.168598 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:05:18.168598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:05:18.168598 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:05:18.176162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:05:18.176162 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:05:18.180668 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:05:18.184937 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:05:18.184937 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:05:18.186870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.186870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.186870 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:05:18.188879 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.190349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.192724 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:05:18.192724 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:05:18.195473 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:05:18.195473 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.03s]
[0m19:05:18.197229 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:05:18.197229 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:05:18.197229 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:05:18.197229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:05:18.197229 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:05:18.206289 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:05:18.206289 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:05:18.209351 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:05:18.213338 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:05:18.213338 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:05:18.215275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.216791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.218080 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:05:18.218080 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.218080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.221609 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:05:18.221609 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:05:18.221609 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:05:18.221609 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.02s]
[0m19:05:18.221609 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:05:18.226314 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:05:18.226314 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:05:18.228025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:05:18.228025 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:05:18.234581 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:05:18.238459 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:05:18.241852 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:05:18.242760 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:05:18.242760 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:05:18.242760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.246354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.246354 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:05:18.247822 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.248980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.252211 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:05:18.252211 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:05:18.252211 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:05:18.254729 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m19:05:18.254729 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:05:18.254729 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:05:18.254729 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:05:18.254729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:05:18.254729 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:05:18.262906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:05:18.267618 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:05:18.271161 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:05:18.271161 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:05:18.271161 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:05:18.274609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.276040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:18.277210 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:05:18.277210 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.279341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.280847 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:05:18.282877 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:05:18.282877 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:05:18.284882 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.03s]
[0m19:05:18.284882 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:05:18.284882 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:05:18.286889 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:05:18.286889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:05:18.286889 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:05:18.292846 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:05:18.296677 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:05:18.300696 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:05:18.302200 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:05:18.303747 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:05:18.303747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.305753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.305753 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:05:18.305753 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.308994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.312805 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:05:18.313857 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:05:18.313857 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:05:18.313857 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:05:18.313857 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:05:18.313857 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:05:18.313857 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:05:18.313857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:05:18.320521 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:05:18.323557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:05:18.327535 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:05:18.331551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:05:18.334399 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:05:18.334399 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:05:18.335942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.335942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.337950 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:05:18.337950 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:05:18.339956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.339956 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:05:18.342849 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:05:18.342849 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:05:18.344960 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.03s]
[0m19:05:18.344960 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:05:18.347035 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:05:18.347035 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:05:18.349044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:05:18.349044 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:05:18.355803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:05:18.355803 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:05:18.361408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:05:18.361408 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:05:18.361408 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:05:18.366132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.366132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:05:18.366132 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:05:18.369449 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:05:18.387400 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m19:05:18.389724 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:05:18.389724 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:05:18.389724 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:05:18.392930 [error] [Thread-1 (]: 13 of 14 FAIL 66 unique_car_mileage_segments_car_id ............................ [[31mFAIL 66[0m in 0.05s]
[0m19:05:18.392930 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:05:18.392930 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:05:18.392930 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:05:18.392930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:05:18.398283 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:05:18.401328 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:05:18.406313 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:05:18.409629 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:05:18.413846 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:05:18.413846 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:05:18.413846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:18.417062 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:05:18.418628 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:05:18.419638 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:05:18.430521 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m19:05:18.432300 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:05:18.434056 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:05:18.434056 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:05:18.434056 [error] [Thread-1 (]: 14 of 14 FAIL 66 unique_stg_cars_car_id ........................................ [[31mFAIL 66[0m in 0.04s]
[0m19:05:18.434056 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:05:18.434056 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:18.439707 [debug] [MainThread]: On master: BEGIN
[0m19:05:18.439707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:18.440822 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:05:18.440822 [debug] [MainThread]: On master: COMMIT
[0m19:05:18.442871 [debug] [MainThread]: Using duckdb connection "master"
[0m19:05:18.442871 [debug] [MainThread]: On master: COMMIT
[0m19:05:18.442871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:05:18.442871 [debug] [MainThread]: On master: Close
[0m19:05:18.442871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:18.446566 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:05:18.446566 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:05:18.447868 [info ] [MainThread]: 
[0m19:05:18.447868 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:05:18.451405 [debug] [MainThread]: Command end result
[0m19:05:18.485877 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:05:18.487884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:05:18.494586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:05:18.494586 [info ] [MainThread]: 
[0m19:05:18.499148 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:05:18.499148 [info ] [MainThread]: 
[0m19:05:18.499148 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)[0m
[0m19:05:18.499148 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:05:18.499148 [info ] [MainThread]: 
[0m19:05:18.499148 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)[0m
[0m19:05:18.499148 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:05:18.499148 [info ] [MainThread]: 
[0m19:05:18.499148 [error] [MainThread]: [31mFailure in test unique_car_mileage_segments_car_id (models\gold\gold_models.yml)[0m
[0m19:05:18.504899 [error] [MainThread]:   Got 66 results, configured to fail if != 0
[0m19:05:18.504899 [info ] [MainThread]: 
[0m19:05:18.506522 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\gold\gold_models.yml\unique_car_mileage_segments_car_id.sql
[0m19:05:18.506522 [info ] [MainThread]: 
[0m19:05:18.507537 [error] [MainThread]: [31mFailure in test unique_stg_cars_car_id (models\silver\stg_cars.yml)[0m
[0m19:05:18.507537 [error] [MainThread]:   Got 66 results, configured to fail if != 0
[0m19:05:18.507537 [info ] [MainThread]: 
[0m19:05:18.509580 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.yml\unique_stg_cars_car_id.sql
[0m19:05:18.510692 [info ] [MainThread]: 
[0m19:05:18.510692 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=14
[0m19:05:18.511994 [debug] [MainThread]: Command `python -m dbt.cli.main test` failed at 19:05:18.511994 after 2.53 seconds
[0m19:05:18.511994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09126250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09157250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09156ED0>]}
[0m19:05:18.511994 [debug] [MainThread]: Flushing usage events
[0m19:05:19.036091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:29.633329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189425E24D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189425E2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189426279D0>]}


============================== 19:39:29.643041 | 5dfd4130-7ab0-4406-a913-2494aa68a713 ==============================
[0m19:39:29.643041 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:39:29.645184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:30.365457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189426C7CD0>]}
[0m19:39:30.500255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001893D267210>]}
[0m19:39:30.527839 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:39:31.263288 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:39:31.458901 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:39:31.461106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018940EB57D0>]}
[0m19:39:34.151597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942B12B50>]}
[0m19:39:34.320826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:39:34.328008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:39:34.408854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942F6FF90>]}
[0m19:39:34.410222 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 428 macros
[0m19:39:34.411534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942FB87D0>]}
[0m19:39:34.415534 [info ] [MainThread]: 
[0m19:39:34.416534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:34.416534 [info ] [MainThread]: 
[0m19:39:34.418041 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:39:34.428586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:39:34.692386 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:39:34.693388 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:39:34.695431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:34.767896 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m19:39:34.772454 [debug] [ThreadPool]: On list_database: Close
[0m19:39:34.773477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:39:34.776556 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:39:34.786700 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:39:34.788786 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:39:34.789780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:34.793667 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:39:34.796158 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:39:34.797159 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:39:34.798484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:39:34.799720 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:39:34.800722 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:39:34.802938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:39:34.805138 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:39:34.806149 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:39:34.807189 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:39:34.810127 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:39:34.811176 [debug] [ThreadPool]: On create_database_main: Close
[0m19:39:34.815124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:39:34.823701 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:39:34.825709 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:39:34.827126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:34.830670 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:39:34.831688 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:39:34.832700 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:39:34.891936 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m19:39:34.895619 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:39:34.898238 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:39:34.899244 [debug] [ThreadPool]: On list_database_main: Close
[0m19:39:34.902361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018944104B90>]}
[0m19:39:34.903379 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:34.904619 [debug] [MainThread]: On master: BEGIN
[0m19:39:34.905643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:34.907686 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:39:34.908688 [debug] [MainThread]: On master: COMMIT
[0m19:39:34.910392 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:34.911595 [debug] [MainThread]: On master: COMMIT
[0m19:39:34.913138 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:39:34.914516 [debug] [MainThread]: On master: Close
[0m19:39:34.926515 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:39:34.928931 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:39:34.931443 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:39:34.932450 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:39:34.949971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:39:34.953519 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:39:35.038088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:39:35.040091 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.041590 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:39:35.043675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:35.046119 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:39:35.047144 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.048168 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:39:35.077905 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m19:39:35.090085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.092755 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter table "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:39:35.097081 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:39:35.101845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.102869 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:39:35.105624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.225408 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:39:35.227472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.228470 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:39:35.261519 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m19:39:35.269598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:39:35.271152 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop table if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:39:35.275942 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:39:35.280427 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:39:35.285065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894440A050>]}
[0m19:39:35.287078 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.35s]
[0m19:39:35.288077 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:39:35.289472 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:39:35.290504 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:39:35.292475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:39:35.294515 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:39:35.299519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:39:35.302063 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:39:35.311208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:39:35.314236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.315510 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:39:35.316513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:35.317917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.318928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.320003 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Adicionando mais colunas ao md5 para garantir unicidade.
    -- Usei um separador '-' para evitar colisões entre colunas.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price"
    )) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
  );

[0m19:39:35.328608 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:39:35.335569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.337282 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter table "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:39:35.339113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.346164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.347610 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:39:35.349622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.352621 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:39:35.354621 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.356532 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:39:35.358930 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.364327 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:39:35.365334 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop table if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:39:35.368355 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.371896 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:39:35.372903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018944449090>]}
[0m19:39:35.375577 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.08s]
[0m19:39:35.377077 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:39:35.379602 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:39:35.380630 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:39:35.381914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:39:35.382960 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:39:35.387423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.388931 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:39:35.426019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.428047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.430446 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:39:35.431451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:35.432527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.433846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.433846 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:39:35.525732 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m19:39:35.531626 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.532701 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:39:35.534062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.539223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.540323 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:39:35.542456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.555000 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:39:35.555000 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.555000 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:39:35.559254 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.564598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:39:35.564598 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:39:35.564598 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.571680 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:39:35.571680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942DBC950>]}
[0m19:39:35.574914 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.19s]
[0m19:39:35.577021 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:39:35.580040 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:39:35.580546 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:39:35.582608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:39:35.583329 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:39:35.590371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:39:35.593179 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:39:35.596785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:39:35.601888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.601888 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:39:35.604916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:35.604916 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.604916 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.609273 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:39:35.730058 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m19:39:35.736891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.736891 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:39:35.740935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:39:35.747026 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.747026 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:39:35.751590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:35.754601 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:39:35.754601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.754601 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:39:35.810460 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m19:39:35.818799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:39:35.818799 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:39:35.822609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:35.826139 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:39:35.827203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd4130-7ab0-4406-a913-2494aa68a713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942E60710>]}
[0m19:39:35.829557 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.25s]
[0m19:39:35.829557 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:39:35.831569 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:35.834602 [debug] [MainThread]: On master: BEGIN
[0m19:39:35.835626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:35.836669 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:39:35.838907 [debug] [MainThread]: On master: COMMIT
[0m19:39:35.838907 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:35.838907 [debug] [MainThread]: On master: COMMIT
[0m19:39:35.841862 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:39:35.843116 [debug] [MainThread]: On master: Close
[0m19:39:35.844129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:35.844129 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:39:35.847412 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:39:35.847412 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:39:35.847412 [info ] [MainThread]: 
[0m19:39:35.847412 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m19:39:35.852406 [debug] [MainThread]: Command end result
[0m19:39:35.893851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:39:35.902347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:39:35.942114 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:39:35.943670 [info ] [MainThread]: 
[0m19:39:35.943670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:35.943670 [info ] [MainThread]: 
[0m19:39:35.948193 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:39:35.950331 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 19:39:35.950331 after 6.56 seconds
[0m19:39:35.950331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018940821B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942CD5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942D71A10>]}
[0m19:39:35.953918 [debug] [MainThread]: Flushing usage events
[0m19:39:36.621510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:41.447916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BDE2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BE347D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BE28AD0>]}


============================== 19:39:41.456943 | 93b1ed09-e9ca-484d-99cf-4a075af02b5f ==============================
[0m19:39:41.456943 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:39:41.457967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:39:41.806870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BE28F90>]}
[0m19:39:41.910876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023737A36050>]}
[0m19:39:41.913951 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:39:42.328527 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:39:42.691789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:42.692791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:42.770583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373D4331D0>]}
[0m19:39:42.887296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:39:42.891201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:39:42.953206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373D67BED0>]}
[0m19:39:42.954211 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 428 macros
[0m19:39:42.955211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373D2D4210>]}
[0m19:39:42.958210 [info ] [MainThread]: 
[0m19:39:42.959211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:42.959211 [info ] [MainThread]: 
[0m19:39:42.960214 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:39:42.967312 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:39:43.143373 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:39:43.144461 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:39:43.144975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:43.197003 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:39:43.198006 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:39:43.199010 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:39:43.220970 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m19:39:43.224009 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:39:43.225296 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:39:43.225296 [debug] [ThreadPool]: On list_database_main: Close
[0m19:39:43.227463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b1ed09-e9ca-484d-99cf-4a075af02b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373D432F90>]}
[0m19:39:43.229507 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:43.229507 [debug] [MainThread]: On master: BEGIN
[0m19:39:43.230791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:43.231809 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:39:43.232822 [debug] [MainThread]: On master: COMMIT
[0m19:39:43.234069 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:43.235081 [debug] [MainThread]: On master: COMMIT
[0m19:39:43.236081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:39:43.237126 [debug] [MainThread]: On master: Close
[0m19:39:43.242858 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:39:43.243879 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:39:43.244904 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:39:43.245916 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:39:43.265094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:39:43.267168 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:39:43.291078 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:39:43.293649 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:39:43.294689 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:39:43.294689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:43.295681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.298043 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:39:43.299044 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:39:43.322208 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:39:43.327864 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:39:43.328890 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:39:43.329917 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:39:43.330930 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.09s]
[0m19:39:43.330930 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:39:43.332292 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:39:43.333657 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:39:43.335162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:39:43.335162 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:39:43.343074 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:39:43.344103 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:39:43.346621 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:39:43.349487 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:39:43.350937 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:39:43.352135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.353143 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:43.354390 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:39:43.354390 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:39:43.360994 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:39:43.363045 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:39:43.364299 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:39:43.364299 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:39:43.365770 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.03s]
[0m19:39:43.368350 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:39:43.369555 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:39:43.370581 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:39:43.371608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:39:43.372622 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:39:43.388816 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:43.389983 [error] [Thread-1 (]: 3 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[31mERROR[0m in 0.02s]
[0m19:39:43.391008 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:39:43.391008 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:39:43.392418 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:43.393439 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:39:43.395721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:39:43.395721 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:39:43.403682 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:43.404706 [error] [Thread-1 (]: 4 of 14 ERROR dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[31mERROR[0m in 0.01s]
[0m19:39:43.405717 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:39:43.406813 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:39:43.406813 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:43.408220 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:39:43.409622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:39:43.410135 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:39:43.418929 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:39:43.421615 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:39:43.425124 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:39:43.426247 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:39:43.427249 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:39:43.428246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.428246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.429584 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:39:43.429584 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.431366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.434884 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:39:43.435904 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:39:43.437151 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:39:43.438497 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m19:39:43.439512 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:39:43.439512 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:39:43.440521 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:39:43.442036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:39:43.443171 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:39:43.450423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:39:43.454204 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:39:43.456728 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:39:43.457752 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:39:43.458982 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:39:43.460014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.461363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.461363 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:39:43.462386 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.464880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.466884 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:39:43.467890 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:39:43.468884 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:39:43.470888 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:39:43.471883 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:39:43.472884 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:39:43.473884 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:39:43.474389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:39:43.474389 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:39:43.479395 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:39:43.480396 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:39:43.485542 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:39:43.489011 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:39:43.489011 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:39:43.490481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.491472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.491472 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:39:43.492545 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.493567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.496513 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:39:43.497519 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:39:43.497519 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:39:43.498534 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.02s]
[0m19:39:43.501992 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:39:43.501992 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:39:43.503149 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:39:43.504176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:39:43.505219 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:39:43.510466 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:39:43.512666 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:39:43.516722 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:39:43.520237 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:39:43.520237 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:39:43.521699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.522707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.524206 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:39:43.524206 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.525217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.527638 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:39:43.528684 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:39:43.530052 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:39:43.530052 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.03s]
[0m19:39:43.531064 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:39:43.532073 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:39:43.533486 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:39:43.534638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:39:43.535651 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:39:43.540106 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:39:43.542651 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:39:43.545669 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:39:43.546677 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:39:43.548149 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:39:43.549726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.551737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:39:43.553184 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:39:43.554449 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.555464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.557906 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:39:43.559413 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:39:43.559413 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:39:43.560576 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m19:39:43.561994 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:39:43.561994 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:39:43.563076 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:39:43.564133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:39:43.564133 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:39:43.571665 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:39:43.572676 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:39:43.576162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:39:43.578211 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:39:43.579237 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:39:43.579237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.580836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.581902 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:39:43.583388 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.644652 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m19:39:43.646726 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:39:43.647744 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:39:43.647744 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:39:43.648923 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.09s]
[0m19:39:43.651362 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:39:43.653358 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:39:43.654358 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:39:43.655867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:39:43.656870 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:39:43.662250 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:39:43.663280 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:39:43.667132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:39:43.669136 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:39:43.670137 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:39:43.671136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.672135 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:43.673137 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:39:43.674504 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.676512 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:43.679737 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:39:43.680745 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:39:43.681755 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:39:43.683929 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:39:43.685061 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:39:43.687533 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:39:43.687533 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:39:43.689007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:39:43.689007 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:39:43.694285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:39:43.695313 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:39:43.699019 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:39:43.701546 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:39:43.702555 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:39:43.703729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.707173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:39:43.707173 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:39:43.708679 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:39:43.711077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.712257 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:39:43.713493 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:39:43.714520 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:39:43.715533 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.03s]
[0m19:39:43.716974 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:39:43.718755 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:39:43.719292 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:39:43.720692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:39:43.721196 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:39:43.730384 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:39:43.731586 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:39:43.735143 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:39:43.737342 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:39:43.738355 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:39:43.739354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.739354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:39:43.740859 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:39:43.741890 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:43.776726 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m19:39:43.778879 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:39:43.779904 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:39:43.779904 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:39:43.780916 [error] [Thread-1 (]: 13 of 14 FAIL 11 unique_car_mileage_segments_car_id ............................ [[31mFAIL 11[0m in 0.06s]
[0m19:39:43.782236 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:39:43.783242 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:39:43.785279 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:39:43.786289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:39:43.787286 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:39:43.792399 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:39:43.792399 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:39:43.796154 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:39:43.798167 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:39:43.799174 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:39:43.801620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:43.803133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:39:43.803133 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:39:43.804649 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:43.899191 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m19:39:43.902924 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:39:43.903950 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:39:43.904976 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:39:43.907008 [error] [Thread-1 (]: 14 of 14 FAIL 11 unique_stg_cars_car_id ........................................ [[31mFAIL 11[0m in 0.12s]
[0m19:39:43.908008 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:39:43.909447 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:43.911273 [debug] [MainThread]: On master: BEGIN
[0m19:39:43.911273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:43.912594 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:39:43.912594 [debug] [MainThread]: On master: COMMIT
[0m19:39:43.913946 [debug] [MainThread]: Using duckdb connection "master"
[0m19:39:43.913946 [debug] [MainThread]: On master: COMMIT
[0m19:39:43.915352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:39:43.916700 [debug] [MainThread]: On master: Close
[0m19:39:43.918025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:43.919030 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:39:43.920067 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:39:43.920067 [info ] [MainThread]: 
[0m19:39:43.921980 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:39:43.925146 [debug] [MainThread]: Command end result
[0m19:39:43.976901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:39:43.980267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:39:43.990971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:39:43.990971 [info ] [MainThread]: 
[0m19:39:43.991991 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:39:43.993016 [info ] [MainThread]: 
[0m19:39:43.993016 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)[0m
[0m19:39:43.994034 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:43.995042 [info ] [MainThread]: 
[0m19:39:43.995042 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)[0m
[0m19:39:43.995042 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0 (models\silver\stg_cars.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:43.996547 [info ] [MainThread]: 
[0m19:39:43.997577 [error] [MainThread]: [31mFailure in test unique_car_mileage_segments_car_id (models\gold\gold_models.yml)[0m
[0m19:39:43.997577 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:39:43.998712 [info ] [MainThread]: 
[0m19:39:43.998712 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\gold\gold_models.yml\unique_car_mileage_segments_car_id.sql
[0m19:39:43.999716 [info ] [MainThread]: 
[0m19:39:44.001742 [error] [MainThread]: [31mFailure in test unique_stg_cars_car_id (models\silver\stg_cars.yml)[0m
[0m19:39:44.002737 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:39:44.004053 [info ] [MainThread]: 
[0m19:39:44.004053 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.yml\unique_stg_cars_car_id.sql
[0m19:39:44.005174 [info ] [MainThread]: 
[0m19:39:44.005174 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=14
[0m19:39:44.007148 [debug] [MainThread]: Command `python -m dbt.cli.main test` failed at 19:39:44.007148 after 2.72 seconds
[0m19:39:44.007148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BACFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373BE63410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373AF135D0>]}
[0m19:39:44.008410 [debug] [MainThread]: Flushing usage events
[0m19:39:44.553563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:17.737470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B2E2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B2E2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B2E2490>]}


============================== 19:47:17.744850 | 893003d7-77f4-4151-b38a-c57ff7838e30 ==============================
[0m19:47:17.744850 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:47:17.747729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:18.294874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '893003d7-77f4-4151-b38a-c57ff7838e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B3259D0>]}
[0m19:47:18.430851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '893003d7-77f4-4151-b38a-c57ff7838e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B4C6D50>]}
[0m19:47:18.439997 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:47:19.097448 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:47:19.099503 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 19:47:19.099503 after 1.55 seconds
[0m19:47:19.100502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B353D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B352F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B569410>]}
[0m19:47:19.101992 [debug] [MainThread]: Flushing usage events
[0m19:47:19.764193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:04.149038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D55741C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D53A88510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D557AA0D0>]}


============================== 19:50:04.156950 | 50997d8b-073f-40e3-a025-ac9708649bf2 ==============================
[0m19:50:04.156950 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:50:04.158065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:50:04.650282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50997d8b-073f-40e3-a025-ac9708649bf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D55821950>]}
[0m19:50:04.787147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50997d8b-073f-40e3-a025-ac9708649bf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5043EBD0>]}
[0m19:50:04.792031 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:50:05.295522 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:50:05.297530 [debug] [MainThread]: Command `dbt run` failed at 19:50:05.297530 after 1.29 seconds
[0m19:50:05.299497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D557BFB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D557BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D558BFF50>]}
[0m19:50:05.299497 [debug] [MainThread]: Flushing usage events
[0m19:50:05.885775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:12.553803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD742B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD7AA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD7AAA90>]}


============================== 19:50:12.558904 | 0f310c68-55dd-460b-926b-5ba6d19b8cd7 ==============================
[0m19:50:12.558904 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:50:12.563018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:12.958213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f310c68-55dd-460b-926b-5ba6d19b8cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD822590>]}
[0m19:50:13.066292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f310c68-55dd-460b-926b-5ba6d19b8cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6A843F190>]}
[0m19:50:13.070364 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:50:13.532621 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:50:13.535710 [debug] [MainThread]: Command `dbt test` failed at 19:50:13.535710 after 1.10 seconds
[0m19:50:13.535710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD735F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6AD4D62D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6A76C5C50>]}
[0m19:50:13.537250 [debug] [MainThread]: Flushing usage events
[0m19:50:14.086869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:26.904496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCE40AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCE81B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCE813D0>]}


============================== 19:50:26.912561 | 948a5807-bdd2-47f1-a80c-419ae8ee80fa ==============================
[0m19:50:26.912561 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:50:26.914806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:27.225904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '948a5807-bdd2-47f1-a80c-419ae8ee80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCE82290>]}
[0m19:50:27.441555 [debug] [MainThread]: Set downloads directory='C:\Users\wes\AppData\Local\Temp\dbt-downloads-by98h5s2'
[0m19:50:27.443853 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:50:27.857745 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:50:27.860610 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m19:50:27.910567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m19:50:27.912128 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m19:50:27.915250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '948a5807-bdd2-47f1-a80c-419ae8ee80fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBE07ED50>]}
[0m19:50:27.927342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m19:50:27.953997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m19:50:27.982343 [info ] [MainThread]: Updating lock file in file path: C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project/package-lock.yml
[0m19:50:28.033002 [debug] [MainThread]: Set downloads directory='C:\Users\wes\AppData\Local\Temp\dbt-downloads-6_ge86wu'
[0m19:50:28.045380 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m19:50:28.950179 [info ] [MainThread]: Installed from version 0.10.3
[0m19:50:28.951745 [info ] [MainThread]: Updated version available: 0.10.4
[0m19:50:28.952280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '948a5807-bdd2-47f1-a80c-419ae8ee80fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCFE2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBE07FF90>]}
[0m19:50:28.953962 [info ] [MainThread]: Installing calogica/dbt_date
[0m19:50:29.380293 [info ] [MainThread]: Installed from version 0.10.1
[0m19:50:29.382804 [info ] [MainThread]: Up to date!
[0m19:50:29.382804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '948a5807-bdd2-47f1-a80c-419ae8ee80fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCF28750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCEAA110>]}
[0m19:50:29.384832 [info ] [MainThread]: 
[0m19:50:29.384832 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m19:50:29.389558 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:50:29.393524 [debug] [MainThread]: Command `dbt deps` succeeded at 19:50:29.392489 after 2.64 seconds
[0m19:50:29.393524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCBD6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCBD6A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CB7DF5C10>]}
[0m19:50:29.396648 [debug] [MainThread]: Flushing usage events
[0m19:50:29.926096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:44.647830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928B640450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928B6AA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928B6842D0>]}


============================== 19:50:44.653891 | 11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8 ==============================
[0m19:50:44.653891 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:50:44.655912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:45.136775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928B8070D0>]}
[0m19:50:45.267948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292863AA990>]}
[0m19:50:45.271289 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:50:45.838100 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:50:45.980690 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:50:45.980690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029289FB2190>]}
[0m19:50:50.396478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D081D50>]}
[0m19:50:50.627889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:50:50.636443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:50:50.673529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292862BB710>]}
[0m19:50:50.673529 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:50:50.676022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D1526D0>]}
[0m19:50:50.678028 [info ] [MainThread]: 
[0m19:50:50.678028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:50.682380 [info ] [MainThread]: 
[0m19:50:50.684349 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:50:50.688295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:50:50.811200 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:50:50.812211 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:50:50.812211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:50.860151 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m19:50:50.865793 [debug] [ThreadPool]: On list_database: Close
[0m19:50:50.865793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:50:50.868998 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:50:50.878567 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:50:50.878567 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:50:50.880574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:50.883447 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:50:50.888890 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:50:50.888890 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:50:50.888890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:50.888890 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:50:50.888890 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:50:50.888890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:50.894227 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:50:50.895588 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:50:50.895588 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:50:50.895588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:50.897916 [debug] [ThreadPool]: On create_database_main: Close
[0m19:50:50.897916 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:50:50.907650 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:50:50.908154 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:50:50.908154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:50.909899 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:50:50.909899 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:50:50.909899 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:50:50.950890 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m19:50:50.950890 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:50:50.954971 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:50:50.957635 [debug] [ThreadPool]: On list_database_main: Close
[0m19:50:50.958640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D08DC90>]}
[0m19:50:50.961464 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:50.961464 [debug] [MainThread]: On master: BEGIN
[0m19:50:50.961464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:50.963913 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:50.963913 [debug] [MainThread]: On master: COMMIT
[0m19:50:50.963913 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:50.963913 [debug] [MainThread]: On master: COMMIT
[0m19:50:50.963913 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:50.963913 [debug] [MainThread]: On master: Close
[0m19:50:50.975832 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:50:50.975832 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:50:50.975832 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:50:50.979007 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:50:50.983740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:50:50.983740 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:50:51.025469 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:50:51.025469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.025469 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:50:51.025469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:51.029968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.030966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.030966 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:50:51.036451 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:51.038246 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.038246 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:50:51.048032 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.049481 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.054514 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:50:51.054514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:51.069983 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:50:51.069983 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.069983 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:50:51.075816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.080689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:50:51.080689 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:50:51.080689 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.091489 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:50:51.091489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D348710>]}
[0m19:50:51.096096 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.12s]
[0m19:50:51.097403 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:50:51.100080 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:50:51.100080 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:50:51.103343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:50:51.104360 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:50:51.110242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:50:51.110752 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:50:51.118382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:50:51.121668 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.121668 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:50:51.121668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:51.121668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.126174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.126174 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Adicionando mais colunas ao md5 para garantir unicidade.
    -- Usei um separador '-' para evitar colisões entre colunas.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price"
    )) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
  );

[0m19:50:51.136062 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:50:51.143085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.145087 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:50:51.145593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:51.149106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.153489 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:50:51.153489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:51.156674 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:50:51.158614 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.158614 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:50:51.160621 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.168405 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:50:51.168935 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:50:51.171595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.173646 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:50:51.174659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D32A690>]}
[0m19:50:51.175682 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.07s]
[0m19:50:51.177831 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:50:51.179449 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:50:51.179969 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:50:51.181569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:50:51.183147 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:50:51.186831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.188385 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:50:51.245652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.249609 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.252132 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:50:51.252132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:51.252132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.252132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.255601 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:50:51.326408 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m19:50:51.334754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.334754 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:50:51.334754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.334754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.334754 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:50:51.345905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.349134 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:50:51.349134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.349134 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:50:51.356151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.356151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:50:51.361214 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:50:51.361214 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.366821 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:50:51.366821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D1506D0>]}
[0m19:50:51.366821 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.19s]
[0m19:50:51.366821 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:50:51.366821 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:50:51.366821 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:50:51.366821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:50:51.366821 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:50:51.377628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:50:51.380240 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:50:51.385976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:50:51.387989 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.387989 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:50:51.387989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:51.387989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.387989 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.387989 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:50:51.464833 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m19:50:51.464833 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.472189 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:50:51.473701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.478771 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.478771 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:50:51.480518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:51.484109 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:50:51.484109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.484109 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:50:51.505483 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:50:51.514530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:50:51.514530 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:50:51.518041 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:51.518041 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:50:51.518041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc2b3a-e03c-443b-bd3f-f6d707a7b3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928D4878D0>]}
[0m19:50:51.518041 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.15s]
[0m19:50:51.518041 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:50:51.518041 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:51.518041 [debug] [MainThread]: On master: BEGIN
[0m19:50:51.526973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:51.526973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:51.528530 [debug] [MainThread]: On master: COMMIT
[0m19:50:51.530318 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:51.530318 [debug] [MainThread]: On master: COMMIT
[0m19:50:51.530318 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:51.530318 [debug] [MainThread]: On master: Close
[0m19:50:51.530318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:51.530318 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:50:51.536837 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:50:51.537342 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:50:51.537342 [info ] [MainThread]: 
[0m19:50:51.537342 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m19:50:51.537342 [debug] [MainThread]: Command end result
[0m19:50:51.582070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:50:51.590896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:50:51.601603 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:50:51.601603 [info ] [MainThread]: 
[0m19:50:51.601603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:51.601603 [info ] [MainThread]: 
[0m19:50:51.601603 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:50:51.601603 [debug] [MainThread]: Command `dbt run` succeeded at 19:50:51.601603 after 7.12 seconds
[0m19:50:51.601603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292856C5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292856C5C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029285644DD0>]}
[0m19:50:51.611039 [debug] [MainThread]: Flushing usage events
[0m19:50:52.147176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:34.487567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F9AD3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F9AD3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F9AD2CD0>]}


============================== 19:51:34.496954 | 94968a3f-3608-43f5-86a4-16d2f031bdac ==============================
[0m19:51:34.496954 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:51:34.497984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:35.002223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F9CECF10>]}
[0m19:51:35.148573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F46B6A90>]}
[0m19:51:35.155316 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:51:35.722233 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:51:36.122583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:36.122583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:36.189103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB1ED5D0>]}
[0m19:51:36.401511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:51:36.404539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:51:36.440517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB0CB0D0>]}
[0m19:51:36.441828 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:51:36.443906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB07DFD0>]}
[0m19:51:36.446999 [info ] [MainThread]: 
[0m19:51:36.447991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:36.448993 [info ] [MainThread]: 
[0m19:51:36.450283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:36.457997 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:51:36.568481 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:51:36.569507 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:51:36.569507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:36.629615 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m19:51:36.632133 [debug] [ThreadPool]: On list_database: Close
[0m19:51:36.633134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:51:36.634616 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:51:36.642957 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:51:36.645434 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:51:36.646944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:36.648985 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:51:36.650987 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:51:36.650987 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:51:36.651987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:36.652988 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:51:36.652988 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:51:36.653987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:36.654989 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:51:36.655988 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:51:36.657501 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:51:36.658533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:36.658533 [debug] [ThreadPool]: On create_database_main: Close
[0m19:51:36.663595 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:51:36.669732 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:51:36.670763 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:51:36.671773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:36.671773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:51:36.673261 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:51:36.674288 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:51:36.697286 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:51:36.699351 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:51:36.700393 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:51:36.700906 [debug] [ThreadPool]: On list_database_main: Close
[0m19:51:36.702968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB342B90>]}
[0m19:51:36.702968 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:36.704350 [debug] [MainThread]: On master: BEGIN
[0m19:51:36.705489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:36.706776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:36.707782 [debug] [MainThread]: On master: COMMIT
[0m19:51:36.708919 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:36.709925 [debug] [MainThread]: On master: COMMIT
[0m19:51:36.711844 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:36.713876 [debug] [MainThread]: On master: Close
[0m19:51:36.717960 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:51:36.719816 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:51:36.720324 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:51:36.721343 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:51:36.730753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:51:36.732286 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:51:36.772734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:51:36.774760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.774760 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:51:36.777082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:36.780488 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:36.780488 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.781915 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:51:36.783135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.790817 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.791843 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:51:36.794245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.800865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.801377 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:51:36.802385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:36.818997 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:51:36.820366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.821708 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:51:36.843303 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:51:36.854803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:51:36.855833 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:51:36.859915 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:36.863878 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:51:36.866941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB6A7B90>]}
[0m19:51:36.867953 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.14s]
[0m19:51:36.867953 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:51:36.869427 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:51:36.869427 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:51:36.870948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:51:36.871990 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:51:36.877116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:51:36.880092 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:51:36.886267 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:51:36.887810 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.888316 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:51:36.888316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:36.890336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.890336 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.891350 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Adicionando mais colunas ao md5 para garantir unicidade.
    -- Usei um separador '-' para evitar colisões entre colunas.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price"
    )) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
  );

[0m19:51:36.896929 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:36.902082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.903127 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:51:36.905407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.911841 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.913389 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:51:36.914934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.917469 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:51:36.917975 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.918990 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:51:36.920277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.926147 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:51:36.928359 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:51:36.930757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.932791 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:51:36.933804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB1EADD0>]}
[0m19:51:36.934840 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.06s]
[0m19:51:36.934840 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:51:36.937272 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:51:36.938286 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:51:36.938790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:51:36.939304 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:51:36.945673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:36.948128 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:51:36.973828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:36.977572 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:36.979067 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:51:36.980402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:36.981716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:36.984231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:36.985247 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:51:37.049639 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:51:37.055975 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:37.055975 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:51:37.057007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:37.062839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:37.063366 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:51:37.065417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:37.070978 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:51:37.071483 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:37.071483 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:51:37.075527 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:37.081395 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:51:37.082402 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:51:37.084445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:37.086497 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:51:37.087537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB4F6890>]}
[0m19:51:37.088565 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.15s]
[0m19:51:37.089592 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:51:37.090613 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:51:37.090613 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:51:37.091624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:51:37.094290 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:51:37.099413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:51:37.100956 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:51:37.105556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:51:37.106082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.107100 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:51:37.108261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:37.111670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:37.112697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.113713 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:51:37.187822 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m19:51:37.191382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.192406 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:51:37.194561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:37.198690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.200198 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:51:37.200198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:37.202834 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:51:37.203843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.204854 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:51:37.264399 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m19:51:37.269612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:51:37.270799 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:51:37.272941 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:37.276258 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:51:37.278195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94968a3f-3608-43f5-86a4-16d2f031bdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB6F0710>]}
[0m19:51:37.281711 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.19s]
[0m19:51:37.283735 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:51:37.285952 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:37.286967 [debug] [MainThread]: On master: BEGIN
[0m19:51:37.286967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:37.289350 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:37.289350 [debug] [MainThread]: On master: COMMIT
[0m19:51:37.290350 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:37.290350 [debug] [MainThread]: On master: COMMIT
[0m19:51:37.291484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:37.293737 [debug] [MainThread]: On master: Close
[0m19:51:37.295216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:37.297307 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:51:37.298368 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:51:37.298368 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:51:37.300074 [info ] [MainThread]: 
[0m19:51:37.300074 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m19:51:37.302123 [debug] [MainThread]: Command end result
[0m19:51:37.349285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:51:37.352922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:51:37.361544 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:51:37.362842 [info ] [MainThread]: 
[0m19:51:37.363886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:37.365364 [info ] [MainThread]: 
[0m19:51:37.366660 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:51:37.368404 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 19:51:37.367890 after 3.06 seconds
[0m19:51:37.368404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F7C83810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB5DF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F9AD2AD0>]}
[0m19:51:37.369522 [debug] [MainThread]: Flushing usage events
[0m19:51:38.168462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:42.672757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB557D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB0E7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB557D90>]}


============================== 19:51:42.678514 | 8bac72e4-c82f-45c3-8c60-1714bffd0377 ==============================
[0m19:51:42.678514 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:51:42.679576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:43.033837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB5263D0>]}
[0m19:51:43.130676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C618EA10>]}
[0m19:51:43.135794 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:51:43.560835 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:51:43.836318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:43.837367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:43.897720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CBBED390>]}
[0m19:51:44.100570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:51:44.105601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:51:44.171642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB6C0B10>]}
[0m19:51:44.175139 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:51:44.175139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB71C810>]}
[0m19:51:44.177592 [info ] [MainThread]: 
[0m19:51:44.179728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:44.179728 [info ] [MainThread]: 
[0m19:51:44.181358 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:44.188415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:51:44.292629 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:51:44.292629 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:51:44.292629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:44.352044 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m19:51:44.352044 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:51:44.352044 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:51:44.377105 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:51:44.380229 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:51:44.381250 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:51:44.381250 [debug] [ThreadPool]: On list_database_main: Close
[0m19:51:44.383810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bac72e4-c82f-45c3-8c60-1714bffd0377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB69DB10>]}
[0m19:51:44.385983 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.387942 [debug] [MainThread]: On master: BEGIN
[0m19:51:44.387942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:44.389694 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:44.389694 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.390709 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.390709 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.392365 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:44.392365 [debug] [MainThread]: On master: Close
[0m19:51:44.397712 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:51:44.397712 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:51:44.401608 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:51:44.401608 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:51:44.424411 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:51:44.424411 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:51:44.455685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:51:44.455685 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:51:44.455685 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:51:44.455685 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:44.460537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.461587 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:51:44.461587 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:51:44.488793 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m19:51:44.495364 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:51:44.497388 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:51:44.497388 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:51:44.497388 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.10s]
[0m19:51:44.500622 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:51:44.500622 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:51:44.503417 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:51:44.503417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:51:44.505613 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:51:44.512829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:51:44.515204 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:51:44.521242 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:51:44.521242 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:51:44.521242 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:51:44.525184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.525184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.525184 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:51:44.528342 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:51:44.532581 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:51:44.536518 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:51:44.536518 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:51:44.536518 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:51:44.539932 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.04s]
[0m19:51:44.539932 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:51:44.539932 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:51:44.539932 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:51:44.544970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:51:44.545975 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:51:44.567582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:51:44.569308 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:51:44.572081 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:51:44.577709 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:51:44.577709 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: BEGIN
[0m19:51:44.577709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.577709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.580420 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:51:44.580420 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and car_age_years >= 0 and car_age_years <= 100
)
 as expression


    from "database"."main"."stg_cars"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:51:44.586077 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:51:44.588095 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: ROLLBACK
[0m19:51:44.590104 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2'
[0m19:51:44.590104 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: Close
[0m19:51:44.592110 [info ] [Thread-1 (]: 3 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[32mPASS[0m in 0.05s]
[0m19:51:44.593615 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:51:44.593615 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:51:44.593615 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:51:44.593615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:51:44.593615 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:51:44.603945 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:51:44.605479 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:51:44.610121 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:51:44.610121 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:51:44.610121 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: BEGIN
[0m19:51:44.614920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.614920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.614920 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:51:44.617386 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price_eur >= 0
)
 as expression


    from "database"."main"."stg_cars"
    where
        price_eur >= 0
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:51:44.624800 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:51:44.626842 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: ROLLBACK
[0m19:51:44.626842 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617'
[0m19:51:44.626842 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: Close
[0m19:51:44.626842 [info ] [Thread-1 (]: 4 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[32mPASS[0m in 0.03s]
[0m19:51:44.631802 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:51:44.631802 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:51:44.631802 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:51:44.635215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:51:44.636231 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:51:44.643565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:51:44.646607 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:51:44.651870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:51:44.653338 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:51:44.655570 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:51:44.655570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.657345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.657345 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:51:44.657345 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.660212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.663093 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:51:44.663093 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:51:44.663093 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:51:44.663093 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m19:51:44.666294 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:51:44.668448 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:51:44.668448 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:51:44.668448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:51:44.671825 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:51:44.678859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:51:44.680890 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:51:44.684263 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:51:44.685611 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:51:44.687618 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:51:44.687618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.689623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.689623 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:51:44.691655 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.693664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.693664 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:51:44.693664 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:51:44.693664 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:51:44.699919 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:51:44.700831 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:51:44.702304 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:51:44.702304 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:51:44.705328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:51:44.705328 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:51:44.710901 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:51:44.712947 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:51:44.716695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:51:44.716695 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:51:44.716695 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:51:44.721249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.721249 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:44.721249 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:51:44.724230 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.724230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.726973 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:51:44.728934 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:51:44.728934 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:51:44.728934 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.02s]
[0m19:51:44.728934 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:51:44.732347 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:51:44.733493 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:51:44.734114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:51:44.734114 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:51:44.740803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:51:44.742812 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:51:44.745528 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:51:44.745528 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:51:44.749189 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:51:44.749189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.750837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.751892 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:51:44.753400 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.755365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.757430 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:51:44.757430 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:51:44.757430 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:51:44.757430 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.02s]
[0m19:51:44.757430 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:51:44.757430 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:51:44.764312 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:51:44.764312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:51:44.765922 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:51:44.773253 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:51:44.774767 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:51:44.774767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:51:44.780254 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:51:44.780254 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:51:44.782095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.783402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.784180 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:51:44.785716 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.785716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.790402 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:51:44.791727 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:51:44.791727 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:51:44.793534 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m19:51:44.793534 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:51:44.796351 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:51:44.796351 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:51:44.797943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:51:44.797943 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:51:44.805197 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:51:44.805983 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:51:44.811800 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:51:44.814155 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:51:44.815371 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:51:44.815371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.818620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:44.818620 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:51:44.822222 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.886329 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:51:44.888336 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:51:44.888336 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:51:44.888336 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:51:44.892364 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.09s]
[0m19:51:44.892364 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:51:44.892364 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:51:44.894837 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:51:44.896367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:51:44.896367 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:51:44.902601 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:51:44.905037 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:51:44.907787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:51:44.910822 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:51:44.912032 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:51:44.913537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.913537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.915478 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:51:44.915478 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.918988 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:44.920041 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:51:44.920041 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:51:44.920041 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:51:44.924396 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:51:44.925935 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:51:44.927459 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:51:44.927459 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:51:44.929368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:51:44.929368 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:51:44.935978 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:51:44.936983 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:51:44.938524 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:51:44.938524 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:51:44.944175 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:51:44.945532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.945532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.945532 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:51:44.947845 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:51:44.950259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.953604 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:51:44.954721 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:51:44.956253 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:51:44.956253 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.03s]
[0m19:51:44.959505 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:51:44.961022 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:51:44.961022 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:51:44.961022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:51:44.961022 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:51:44.973582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:51:44.973582 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:51:44.978669 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:51:44.978669 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:51:44.978669 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:51:44.978669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.983279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.984418 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:51:44.985953 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:45.027187 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m19:51:45.027187 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:51:45.030682 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:51:45.030682 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:51:45.030682 [error] [Thread-1 (]: 13 of 14 FAIL 11 unique_car_mileage_segments_car_id ............................ [[31mFAIL 11[0m in 0.07s]
[0m19:51:45.030682 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:51:45.033337 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:51:45.034535 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:51:45.034535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:51:45.034535 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:51:45.041299 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:51:45.041299 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:51:45.049351 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:51:45.051386 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:51:45.052451 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:51:45.052451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:45.054368 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:45.056563 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:51:45.057577 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:45.148048 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m19:51:45.152888 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:51:45.152888 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:51:45.154895 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:51:45.155901 [error] [Thread-1 (]: 14 of 14 FAIL 11 unique_stg_cars_car_id ........................................ [[31mFAIL 11[0m in 0.12s]
[0m19:51:45.157188 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:51:45.160143 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:45.160143 [debug] [MainThread]: On master: BEGIN
[0m19:51:45.162151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:45.162151 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:45.162151 [debug] [MainThread]: On master: COMMIT
[0m19:51:45.180267 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:45.180267 [debug] [MainThread]: On master: COMMIT
[0m19:51:45.188379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:45.188379 [debug] [MainThread]: On master: Close
[0m19:51:45.191029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:45.191029 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:51:45.191029 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:51:45.193231 [info ] [MainThread]: 
[0m19:51:45.193231 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m19:51:45.196539 [debug] [MainThread]: Command end result
[0m19:51:45.238552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:51:45.246968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:51:45.254985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:51:45.254985 [info ] [MainThread]: 
[0m19:51:45.254985 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:51:45.259677 [info ] [MainThread]: 
[0m19:51:45.259677 [error] [MainThread]: [31mFailure in test unique_car_mileage_segments_car_id (models\gold\gold_models.yml)[0m
[0m19:51:45.261127 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:51:45.261127 [info ] [MainThread]: 
[0m19:51:45.261127 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\gold\gold_models.yml\unique_car_mileage_segments_car_id.sql
[0m19:51:45.263147 [info ] [MainThread]: 
[0m19:51:45.263147 [error] [MainThread]: [31mFailure in test unique_stg_cars_car_id (models\silver\stg_cars.yml)[0m
[0m19:51:45.263147 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:51:45.263147 [info ] [MainThread]: 
[0m19:51:45.265351 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.yml\unique_stg_cars_car_id.sql
[0m19:51:45.265351 [info ] [MainThread]: 
[0m19:51:45.265351 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=14
[0m19:51:45.268068 [debug] [MainThread]: Command `python -m dbt.cli.main test` failed at 19:51:45.268068 after 2.73 seconds
[0m19:51:45.269203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB577ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CB5778D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C96C4050>]}
[0m19:51:45.269203 [debug] [MainThread]: Flushing usage events
[0m19:51:45.825516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:31.208177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576740210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576740B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576742490>]}


============================== 19:53:31.214574 | 30bef987-7c8f-449b-baab-df8cf4fff913 ==============================
[0m19:53:31.214574 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:53:31.217588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:53:31.677888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576905610>]}
[0m19:53:31.805239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576A51910>]}
[0m19:53:31.810974 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:53:32.296276 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:53:32.561927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:32.563452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:32.627877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576DCDBD0>]}
[0m19:53:32.748522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:53:32.751988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:53:32.781975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576E3F050>]}
[0m19:53:32.784507 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:53:32.785509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255767BC890>]}
[0m19:53:32.788069 [info ] [MainThread]: 
[0m19:53:32.788665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:32.788665 [info ] [MainThread]: 
[0m19:53:32.789979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:53:32.798752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:53:32.994288 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:53:32.995299 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:53:32.996299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:33.024140 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m19:53:33.025513 [debug] [ThreadPool]: On list_database: Close
[0m19:53:33.027824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:53:33.029101 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:53:33.036904 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:53:33.037914 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:53:33.037914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:33.039938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:53:33.041446 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:53:33.042494 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:53:33.045032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:53:33.046147 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:53:33.046147 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:53:33.047403 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:53:33.048786 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:53:33.050295 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:53:33.050295 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:53:33.051992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:53:33.051992 [debug] [ThreadPool]: On create_database_main: Close
[0m19:53:33.054550 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:53:33.062546 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:53:33.063739 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:53:33.063739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:33.065202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:53:33.066206 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:53:33.066206 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:53:33.086185 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:53:33.088764 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:53:33.089768 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:53:33.090842 [debug] [ThreadPool]: On list_database_main: Close
[0m19:53:33.093330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025576784C90>]}
[0m19:53:33.094837 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:33.094837 [debug] [MainThread]: On master: BEGIN
[0m19:53:33.096390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:33.097837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:33.097837 [debug] [MainThread]: On master: COMMIT
[0m19:53:33.098843 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:33.098843 [debug] [MainThread]: On master: COMMIT
[0m19:53:33.099852 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:33.100947 [debug] [MainThread]: On master: Close
[0m19:53:33.105473 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:53:33.106490 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:53:33.108944 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:53:33.110292 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:53:33.118701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:53:33.120718 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:53:33.159939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:53:33.162309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.162309 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:53:33.163441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:33.164911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.164911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.165940 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:53:33.167029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.178148 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.179177 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:53:33.180162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.185688 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.185688 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:53:33.186753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.202497 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:53:33.203859 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.204919 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:53:33.235030 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m19:53:33.243446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:53:33.245388 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:53:33.246614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.250586 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:53:33.252595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025577269390>]}
[0m19:53:33.253600 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.14s]
[0m19:53:33.255103 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:53:33.256110 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:53:33.257558 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:53:33.259976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:53:33.261124 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:53:33.265227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:53:33.267559 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:53:33.272380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:53:33.274891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.274891 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:53:33.276397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:33.278777 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:33.278777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.280044 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
)

SELECT
    -- CORREÇÃO: Adicionando mais colunas ao md5 para garantir unicidade.
    -- Usei um separador '-' para evitar colisões entre colunas.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price"
    )) AS car_id,

    -- Renomeando e padronizando colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,

    -- Conversão de tipos no padrão DuckDB
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Calculando idade do carro
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source
  );

[0m19:53:33.282519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.286573 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.286573 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:53:33.287950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:53:33.292478 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.293515 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:53:33.295012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.297493 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:53:33.297493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.298965 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:53:33.301457 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:33.305256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:53:33.306537 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:53:33.308491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.311220 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:53:33.313471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025577363450>]}
[0m19:53:33.313471 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.05s]
[0m19:53:33.315505 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:53:33.317814 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:53:33.319870 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:53:33.320903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:53:33.322342 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:53:33.329304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.330841 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:53:33.354633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.356632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.357634 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:53:33.358633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:33.361634 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:33.362167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.363181 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:53:33.420753 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m19:53:33.426662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.427668 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:53:33.428860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.434174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.435669 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:53:33.437471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:53:33.445028 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:53:33.446561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.447608 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:53:33.478620 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m19:53:33.482169 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:53:33.483613 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:53:33.485910 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:33.487970 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:53:33.487970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025577278690>]}
[0m19:53:33.489475 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.17s]
[0m19:53:33.491618 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:53:33.493044 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:53:33.494050 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:53:33.495057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:53:33.496309 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:53:33.498640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:53:33.501261 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:53:33.505466 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:53:33.506492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.507519 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:53:33.507519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:33.509648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.510652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.512160 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:53:33.595939 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m19:53:33.599591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.599591 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:53:33.599591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:53:33.612799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.613935 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:53:33.613935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:33.617330 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:53:33.617330 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.617330 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:53:33.676135 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m19:53:33.681661 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:53:33.681661 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:53:33.683458 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:33.686794 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:53:33.687824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30bef987-7c8f-449b-baab-df8cf4fff913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025577397D90>]}
[0m19:53:33.687824 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.19s]
[0m19:53:33.691274 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:53:33.692776 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:33.692776 [debug] [MainThread]: On master: BEGIN
[0m19:53:33.692776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:33.692776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:33.692776 [debug] [MainThread]: On master: COMMIT
[0m19:53:33.697605 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:33.697605 [debug] [MainThread]: On master: COMMIT
[0m19:53:33.697605 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:33.697605 [debug] [MainThread]: On master: Close
[0m19:53:33.700399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:33.700399 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:53:33.700399 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:53:33.702729 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:53:33.702729 [info ] [MainThread]: 
[0m19:53:33.703959 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m19:53:33.707327 [debug] [MainThread]: Command end result
[0m19:53:33.763773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:53:33.767862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:53:33.777160 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:53:33.779249 [info ] [MainThread]: 
[0m19:53:33.780291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:33.781316 [info ] [MainThread]: 
[0m19:53:33.782346 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:53:33.784396 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:33.784396 after 2.73 seconds
[0m19:53:33.786141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255764D60D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255706C5C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255706C5C90>]}
[0m19:53:33.786141 [debug] [MainThread]: Flushing usage events
[0m19:53:34.543824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:50.442622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBD43A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBAD6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBD429D0>]}


============================== 19:53:50.449612 | 0d7046eb-e2a3-48ad-98d2-78efe42f36e5 ==============================
[0m19:53:50.449612 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:53:50.449612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:53:50.909986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBC6DC50>]}
[0m19:53:51.055169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246C7A39C90>]}
[0m19:53:51.061090 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:53:51.636628 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:53:51.936498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:51.937553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:51.999508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CD428E10>]}
[0m19:53:52.130752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:53:52.134668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:53:52.243691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBDABD50>]}
[0m19:53:52.244708 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:53:52.246920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CD254350>]}
[0m19:53:52.250416 [info ] [MainThread]: 
[0m19:53:52.251925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:52.252948 [info ] [MainThread]: 
[0m19:53:52.254271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:53:52.261459 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:53:52.367003 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:53:52.368214 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:53:52.368214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:52.425277 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m19:53:52.425277 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:53:52.426287 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:53:52.445631 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:53:52.447961 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:53:52.450271 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:53:52.450271 [debug] [ThreadPool]: On list_database_main: Close
[0m19:53:52.452296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7046eb-e2a3-48ad-98d2-78efe42f36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBFCAD10>]}
[0m19:53:52.453499 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:52.454517 [debug] [MainThread]: On master: BEGIN
[0m19:53:52.454517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:52.455571 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:52.456575 [debug] [MainThread]: On master: COMMIT
[0m19:53:52.456575 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:52.457842 [debug] [MainThread]: On master: COMMIT
[0m19:53:52.459292 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:52.459292 [debug] [MainThread]: On master: Close
[0m19:53:52.466020 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:53:52.467080 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:53:52.468489 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:53:52.469649 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:53:52.494324 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:53:52.498389 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:53:52.520805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:53:52.522864 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:53:52.523872 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:53:52.525097 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:52.526108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.527118 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:53:52.527118 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:53:52.533071 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:53:52.538419 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:53:52.539924 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:53:52.540955 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:53:52.541955 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.07s]
[0m19:53:52.543639 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:53:52.544654 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:53:52.545759 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:53:52.547031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:53:52.548221 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:53:52.555290 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:53:52.556309 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:53:52.559875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:53:52.562980 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:53:52.565379 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:53:52.566588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.567596 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:52.569813 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:53:52.569813 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:53:52.577160 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:53:52.580923 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:53:52.582639 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:53:52.583661 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:53:52.584944 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.04s]
[0m19:53:52.587129 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:53:52.588169 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:53:52.589874 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:53:52.591583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:53:52.593123 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:53:52.620037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:53:52.621571 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:53:52.627010 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:53:52.629709 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:53:52.631387 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: BEGIN
[0m19:53:52.632432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.634007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.634540 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:53:52.635572 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and car_age_years >= 0 and car_age_years <= 100
)
 as expression


    from "database"."main"."stg_cars"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:53:52.639234 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:53:52.641440 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: ROLLBACK
[0m19:53:52.642618 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2'
[0m19:53:52.642618 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: Close
[0m19:53:52.644173 [info ] [Thread-1 (]: 3 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[32mPASS[0m in 0.05s]
[0m19:53:52.646758 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:53:52.648443 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:53:52.648443 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:53:52.649456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:53:52.650834 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:53:52.657488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:53:52.659538 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:53:52.663970 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:53:52.665967 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:53:52.666967 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: BEGIN
[0m19:53:52.667968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.669476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.669476 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:53:52.670779 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price_eur >= 0
)
 as expression


    from "database"."main"."stg_cars"
    where
        price_eur >= 0
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:53:52.675344 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:53:52.677421 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: ROLLBACK
[0m19:53:52.678930 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617'
[0m19:53:52.681407 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: Close
[0m19:53:52.682525 [info ] [Thread-1 (]: 4 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[32mPASS[0m in 0.03s]
[0m19:53:52.684009 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:53:52.685211 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:53:52.685211 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:53:52.687474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:53:52.688472 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:53:52.698514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:53:52.701060 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:53:52.706063 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:53:52.708472 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:53:52.708472 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:53:52.710435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.710941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.712464 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:53:52.713500 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.714738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.716831 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:53:52.718842 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:53:52.719991 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:53:52.720990 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m19:53:52.722743 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:53:52.723751 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:53:52.723751 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:53:52.726355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:53:52.727380 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:53:52.735193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:53:52.736202 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:53:52.741100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:53:52.743126 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:53:52.744323 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:53:52.745331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.747863 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:53:52.749069 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:53:52.750074 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.752496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.756131 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:53:52.757543 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:53:52.757543 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:53:52.759075 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:53:52.760599 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:53:52.763670 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:53:52.765221 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:53:52.766734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:53:52.766734 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:53:52.773662 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:53:52.775705 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:53:52.779815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:53:52.782605 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:53:52.782605 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:53:52.784060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.785573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.786756 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:53:52.786756 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.789562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.791692 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:53:52.792702 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:53:52.793708 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:53:52.793708 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.03s]
[0m19:53:52.796133 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:53:52.799726 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:53:52.800926 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:53:52.803396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:53:52.804731 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:53:52.848241 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:53:52.850756 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:53:52.856763 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:53:52.859136 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:53:52.860142 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:53:52.862261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.864818 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:53:52.866829 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:53:52.869318 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.871874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.873880 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:53:52.877399 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:53:52.878395 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:53:52.881909 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.08s]
[0m19:53:52.883923 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:53:52.884922 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:53:52.885923 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:53:52.886924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:53:52.888144 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:53:52.894295 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:53:52.895303 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:53:52.902843 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:53:52.904607 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:53:52.904607 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:53:52.905911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.907011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.908017 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:53:52.909020 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.910028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.912031 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:53:52.914609 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:53:52.915608 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:53:52.915608 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m19:53:52.917091 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:53:52.918392 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:53:52.919589 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:53:52.919589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:53:52.921098 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:53:52.927664 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:53:52.929667 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:53:52.935570 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:53:52.936577 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:53:52.937803 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:53:52.938815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:52.939822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:52.940832 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:53:52.941839 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:53:52.983242 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m19:53:52.985243 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:53:52.986243 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:53:52.986243 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:53:52.987243 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.07s]
[0m19:53:52.988499 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:53:52.989506 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:53:52.990525 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:53:52.992571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:53:52.993594 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:53:52.999755 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:53:53.001811 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:53:53.005864 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:53:53.008219 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:53:53.009232 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:53:53.010264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:53.011278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:53.012283 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:53:53.014682 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:53:53.017967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:53.019974 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:53:53.021333 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:53:53.022464 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:53:53.023479 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:53:53.025498 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:53:53.026803 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:53:53.027809 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:53:53.028919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:53:53.030304 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:53:53.035907 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:53:53.036916 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:53:53.039939 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:53:53.042510 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:53:53.042510 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:53:53.043519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:53.044532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:53.045748 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:53:53.046782 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:53:53.049827 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:53:53.052345 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:53:53.053440 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:53:53.054449 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:53:53.055460 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.03s]
[0m19:53:53.056469 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:53:53.057797 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:53:53.058814 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:53:53.059824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:53:53.061300 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:53:53.069948 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:53:53.072143 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:53:53.075198 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:53:53.076379 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:53:53.077409 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:53:53.078416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:53.078416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:53.079756 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:53:53.080763 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:53:53.101134 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m19:53:53.103144 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:53:53.104144 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:53:53.105145 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:53:53.105649 [error] [Thread-1 (]: 13 of 14 FAIL 11 unique_car_mileage_segments_car_id ............................ [[31mFAIL 11[0m in 0.05s]
[0m19:53:53.106928 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:53:53.107944 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:53:53.108958 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:53:53.109973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:53:53.111293 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:53:53.117804 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:53:53.118806 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:53:53.124365 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:53:53.125365 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:53:53.126868 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:53:53.126868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:53.128240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:53.130881 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:53:53.132025 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:53:53.222710 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m19:53:53.225837 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:53:53.225837 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:53:53.226890 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:53:53.227922 [error] [Thread-1 (]: 14 of 14 FAIL 11 unique_stg_cars_car_id ........................................ [[31mFAIL 11[0m in 0.12s]
[0m19:53:53.231088 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:53:53.232119 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:53.233646 [debug] [MainThread]: On master: BEGIN
[0m19:53:53.234702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:53.235734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:53.235734 [debug] [MainThread]: On master: COMMIT
[0m19:53:53.236765 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:53.236765 [debug] [MainThread]: On master: COMMIT
[0m19:53:53.237796 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:53.238827 [debug] [MainThread]: On master: Close
[0m19:53:53.238827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:53.239858 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:53:53.239858 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:53:53.240890 [info ] [MainThread]: 
[0m19:53:53.241921 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m19:53:53.245487 [debug] [MainThread]: Command end result
[0m19:53:53.294629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:53:53.300324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:53:53.309311 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:53:53.310343 [info ] [MainThread]: 
[0m19:53:53.311374 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:53:53.312405 [info ] [MainThread]: 
[0m19:53:53.313437 [error] [MainThread]: [31mFailure in test unique_car_mileage_segments_car_id (models\gold\gold_models.yml)[0m
[0m19:53:53.314468 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:53:53.315499 [info ] [MainThread]: 
[0m19:53:53.316530 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\gold\gold_models.yml\unique_car_mileage_segments_car_id.sql
[0m19:53:53.317584 [info ] [MainThread]: 
[0m19:53:53.319091 [error] [MainThread]: [31mFailure in test unique_stg_cars_car_id (models\silver\stg_cars.yml)[0m
[0m19:53:53.320118 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m19:53:53.321118 [info ] [MainThread]: 
[0m19:53:53.322253 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\silver\stg_cars.yml\unique_stg_cars_car_id.sql
[0m19:53:53.324367 [info ] [MainThread]: 
[0m19:53:53.325398 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=14
[0m19:53:53.328471 [debug] [MainThread]: Command `dbt test` failed at 19:53:53.327443 after 3.04 seconds
[0m19:53:53.329985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBD35DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CAF28E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246CBC6CD90>]}
[0m19:53:53.332045 [debug] [MainThread]: Flushing usage events
[0m19:53:53.885840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:51.544444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA4705D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA470810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA471650>]}


============================== 19:55:51.550300 | f1d8e2c9-dcdc-43db-a2d0-febd242fc445 ==============================
[0m19:55:51.550300 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:55:51.551789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:55:51.987633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA4AA690>]}
[0m19:55:52.104700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C51994D0>]}
[0m19:55:52.108814 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:55:52.595768 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:55:52.941893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:52.942988 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\silver\stg_cars.sql
[0m19:55:53.679628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA4414D0>]}
[0m19:55:53.828804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:55:53.834223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:55:53.863711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CA97BAD0>]}
[0m19:55:53.865097 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:55:53.866564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C8DBB950>]}
[0m19:55:53.870404 [info ] [MainThread]: 
[0m19:55:53.872416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:53.873922 [info ] [MainThread]: 
[0m19:55:53.876338 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:55:53.886028 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:55:53.994754 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:55:53.994754 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:55:53.995781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:54.021675 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:55:54.022679 [debug] [ThreadPool]: On list_database: Close
[0m19:55:54.024530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:55:54.025733 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:55:54.035459 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:55:54.036480 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:55:54.037518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:54.038873 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:55:54.040877 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:55:54.041876 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:55:54.042877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:55:54.042877 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:55:54.044382 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:55:54.045386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:55:54.046389 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:55:54.047753 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:55:54.048759 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:55:54.048759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:55:54.051211 [debug] [ThreadPool]: On create_database_main: Close
[0m19:55:54.052255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:55:54.060609 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:55:54.061614 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:55:54.061614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:54.063064 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:54.063064 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:55:54.064501 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:55:54.085763 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:55:54.087953 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:55:54.088970 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:55:54.089959 [debug] [ThreadPool]: On list_database_main: Close
[0m19:55:54.091263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CAE50FD0>]}
[0m19:55:54.092694 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.093698 [debug] [MainThread]: On master: BEGIN
[0m19:55:54.093698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:54.094701 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:54.095701 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.095701 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.095701 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.097743 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:55:54.097743 [debug] [MainThread]: On master: Close
[0m19:55:54.103994 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:55:54.105102 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:55:54.106562 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:55:54.106562 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:55:54.114626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:55:54.117108 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:55:54.160228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:55:54.161446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.162811 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:55:54.162811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:54.163825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.164848 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.166189 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:55:54.168527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.176425 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.176425 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:55:54.178814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.184329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.185332 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:55:54.186748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:55:54.198948 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:55:54.199960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.202393 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:55:54.233515 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m19:55:54.242187 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:55:54.242187 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:55:54.245577 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:55:54.249804 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:55:54.251970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CC216110>]}
[0m19:55:54.252997 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.14s]
[0m19:55:54.255020 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:55:54.256019 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:55:54.256019 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:55:54.258569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:55:54.258569 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:55:54.263369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:55:54.264397 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:55:54.272412 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:55:54.274409 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.275410 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:55:54.276885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:54.277936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.278450 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.279476 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
),

-- Esta etapa usa ROW_NUMBER para numerar linhas que são completamente idênticas,
-- garantindo um desempate para a criação da chave primária.
source_ranked AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY
                "Manufacturer",
                "Model",
                "Year of manufacture",
                "Mileage",
                "Fuel type",
                "Engine size",
                "Price"
            ORDER BY
                (SELECT NULL) -- A ordem não é relevante, apenas o número sequencial.
        ) as duplicate_rank
    FROM source
)

SELECT
    -- A chave primária agora inclui o 'duplicate_rank' para garantir 100% de unicidade.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price" || '-' ||
        duplicate_rank
    )) AS car_id,

    -- Renomeação e conversão de tipos das colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Cálculo da idade do veículo
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source_ranked
  );

[0m19:55:54.286636 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:55:54.292183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.293186 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:55:54.293186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:55:54.300888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.301904 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:55:54.303015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.305106 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:55:54.307114 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.307114 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:55:54.309615 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:55:54.314023 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:55:54.315318 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:55:54.317549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.319587 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:55:54.320587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CC3A1990>]}
[0m19:55:54.322110 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.06s]
[0m19:55:54.324132 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:55:54.325148 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:55:54.326199 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:55:54.327698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:55:54.327698 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:55:54.331831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.334981 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:55:54.362241 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.363745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.364785 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:55:54.365791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:54.368792 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:55:54.369790 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.370790 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:55:54.457458 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m19:55:54.461991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.462992 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:55:54.463992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.470653 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.471678 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:55:54.473687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.481543 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:55:54.482673 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.484047 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:55:54.487414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.491938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:55:54.491938 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:55:54.494446 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:55:54.497339 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:55:54.498384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CC344190>]}
[0m19:55:54.499443 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.17s]
[0m19:55:54.501577 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:55:54.502614 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:55:54.503682 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:55:54.505268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:55:54.506357 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:55:54.510589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:55:54.512175 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:55:54.520156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:55:54.522443 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.523809 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:55:54.524868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:54.525933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.526465 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.527487 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:55:54.609106 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m19:55:54.614246 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.614246 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:55:54.616256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:55:54.621128 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.622277 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:55:54.623504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:55:54.625897 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:55:54.626918 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.626918 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:55:54.659603 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m19:55:54.662785 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:55:54.663835 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:55:54.665807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:55:54.667856 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:55:54.668888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8e2c9-dcdc-43db-a2d0-febd242fc445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CC230910>]}
[0m19:55:54.670402 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.16s]
[0m19:55:54.672886 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:55:54.674438 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.675829 [debug] [MainThread]: On master: BEGIN
[0m19:55:54.676844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:54.676844 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:54.678060 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.678060 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.679074 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.680096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:55:54.681090 [debug] [MainThread]: On master: Close
[0m19:55:54.682115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:54.682115 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:55:54.683115 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:55:54.684127 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:55:54.686470 [info ] [MainThread]: 
[0m19:55:54.686983 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m19:55:54.689204 [debug] [MainThread]: Command end result
[0m19:55:54.737229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:55:54.742277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:55:54.750197 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:55:54.751355 [info ] [MainThread]: 
[0m19:55:54.752423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:54.753854 [info ] [MainThread]: 
[0m19:55:54.755027 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:55:54.757729 [debug] [MainThread]: Command `dbt run` succeeded at 19:55:54.756621 after 3.39 seconds
[0m19:55:54.757729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C44B5C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C4434E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C4434F10>]}
[0m19:55:54.758742 [debug] [MainThread]: Flushing usage events
[0m19:55:55.335986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:08.625171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39042B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E390ABB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E390A9C50>]}


============================== 19:56:08.630208 | 537f309e-7a1a-49ee-9bca-371eb33328d6 ==============================
[0m19:56:08.630208 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:08.632634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:56:09.078210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E390AA690>]}
[0m19:56:09.210846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E33D3E7D0>]}
[0m19:56:09.215941 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:56:09.724361 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:10.058824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:10.058824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:10.119744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39693990>]}
[0m19:56:10.241160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:10.244558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:10.354801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E390F1950>]}
[0m19:56:10.355806 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:56:10.356805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39540590>]}
[0m19:56:10.360507 [info ] [MainThread]: 
[0m19:56:10.361513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:10.362300 [info ] [MainThread]: 
[0m19:56:10.363805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:10.373382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:56:10.483887 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:10.484890 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:56:10.485890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:10.536601 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:56:10.537736 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:10.538758 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:56:10.559564 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:56:10.561845 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:56:10.562855 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:56:10.562855 [debug] [ThreadPool]: On list_database_main: Close
[0m19:56:10.566381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537f309e-7a1a-49ee-9bca-371eb33328d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3953A410>]}
[0m19:56:10.567413 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:10.567413 [debug] [MainThread]: On master: BEGIN
[0m19:56:10.568879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:10.570376 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:10.571574 [debug] [MainThread]: On master: COMMIT
[0m19:56:10.571574 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:10.572763 [debug] [MainThread]: On master: COMMIT
[0m19:56:10.573786 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:10.573786 [debug] [MainThread]: On master: Close
[0m19:56:10.579983 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:10.580989 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:56:10.582004 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:56:10.583148 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:10.610298 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:10.612337 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:10.635463 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:10.637699 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:10.638731 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:56:10.639739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:10.639739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.641248 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:10.642284 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:56:10.645778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:10.652823 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:56:10.654827 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:56:10.655827 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:56:10.656828 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.07s]
[0m19:56:10.658169 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:10.659179 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:10.659179 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:56:10.660367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:56:10.661378 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:10.671231 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:10.673242 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:10.678032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:10.680318 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:10.681669 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:56:10.682860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.684948 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:10.687414 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:10.688411 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:56:10.693410 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:56:10.695917 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:56:10.696919 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:56:10.697920 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:56:10.699060 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.04s]
[0m19:56:10.701264 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:10.702729 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:10.703749 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:56:10.705255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:56:10.707332 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:10.729301 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:10.731517 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:10.738129 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:10.740612 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:10.742073 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: BEGIN
[0m19:56:10.743081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.744083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.745083 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:10.746084 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and car_age_years >= 0 and car_age_years <= 100
)
 as expression


    from "database"."main"."stg_cars"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:56:10.749968 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:10.752302 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: ROLLBACK
[0m19:56:10.754346 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2'
[0m19:56:10.754346 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: Close
[0m19:56:10.756372 [info ] [Thread-1 (]: 3 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[32mPASS[0m in 0.05s]
[0m19:56:10.757583 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:10.758588 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:10.759615 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:56:10.760634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:56:10.761644 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:10.769727 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:10.771784 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:10.775422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:10.778482 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:10.779994 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: BEGIN
[0m19:56:10.781313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.783324 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:10.784325 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:10.787610 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price_eur >= 0
)
 as expression


    from "database"."main"."stg_cars"
    where
        price_eur >= 0
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:56:10.793516 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:56:10.796522 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: ROLLBACK
[0m19:56:10.797521 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617'
[0m19:56:10.798523 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: Close
[0m19:56:10.802031 [info ] [Thread-1 (]: 4 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[32mPASS[0m in 0.04s]
[0m19:56:10.804589 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:10.805791 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:10.807824 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:56:10.811000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:56:10.812502 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:10.823283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:10.825835 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:10.831028 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:10.833555 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:10.834880 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:56:10.836007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.838067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.838067 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:10.839084 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:56:10.841243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.842648 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:56:10.844152 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:56:10.845228 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:56:10.846256 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.04s]
[0m19:56:10.847276 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:10.848779 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:10.850091 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:56:10.853479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:56:10.854504 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:10.861751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:10.862750 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:10.867741 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:10.870008 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:10.872048 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:56:10.873041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.875181 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:10.876165 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:10.877495 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:56:10.878512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.881562 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:56:10.882573 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:56:10.883876 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:56:10.886438 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:56:10.888505 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:10.889520 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:10.890662 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:56:10.891685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:56:10.892884 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:10.897463 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:10.899663 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:10.905110 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:10.907129 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:10.908128 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:56:10.909425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.910443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.911461 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:10.911461 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:56:10.913488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.915511 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:56:10.918435 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:56:10.919613 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:56:10.921722 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.03s]
[0m19:56:10.925234 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:10.926248 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:10.926248 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:56:10.927286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:56:10.928298 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:10.934894 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:10.937253 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:10.942218 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:10.943216 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:10.944235 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:56:10.944235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.945710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.945710 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:10.947156 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:56:10.949404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.952458 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:56:10.955119 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:56:10.956842 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:56:10.958390 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.03s]
[0m19:56:10.959945 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:10.959945 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:10.961483 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:56:10.963015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:56:10.963015 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:10.977096 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:10.978386 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:10.985688 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:10.987688 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:10.988688 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:56:10.989693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:10.991688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.991688 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:10.993194 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:56:10.995225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:10.997223 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:56:10.998222 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:56:10.998222 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:56:11.000225 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.04s]
[0m19:56:11.002683 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:11.004195 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:11.005308 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:56:11.007338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:56:11.008672 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:11.016910 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:11.020242 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:11.026122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:11.028414 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:11.028414 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:56:11.029692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.031002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:11.031002 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:11.032005 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:56:11.076948 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m19:56:11.079546 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:56:11.080561 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:56:11.080561 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:56:11.081646 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.07s]
[0m19:56:11.083798 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:11.084815 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:11.084815 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:56:11.087264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:56:11.087264 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:11.093863 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:11.094889 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:11.098205 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:11.100816 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:11.102041 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:56:11.102041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.104065 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:11.105231 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:11.105231 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:56:11.109589 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:11.111634 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:56:11.112661 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:56:11.112661 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:56:11.113674 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:56:11.115712 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:11.117643 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:11.118649 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:56:11.121157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:56:11.122188 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:11.127192 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:11.129192 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:11.132193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:11.133700 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:11.135706 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:56:11.136706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.161329 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:11.163843 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:11.164891 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:56:11.172457 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:56:11.176979 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:56:11.177987 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:56:11.178989 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:56:11.180989 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.06s]
[0m19:56:11.183990 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:11.185501 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:11.186074 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:56:11.189736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:56:11.190734 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:11.204533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:11.208047 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:11.212422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:11.213428 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:11.214661 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:56:11.214661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.215775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:11.217280 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:11.218312 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:56:11.235567 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m19:56:11.238595 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:56:11.239102 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:56:11.240120 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:56:11.241142 [info ] [Thread-1 (]: 13 of 14 PASS unique_car_mileage_segments_car_id ............................... [[32mPASS[0m in 0.05s]
[0m19:56:11.243183 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:11.244197 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:11.245355 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:56:11.247385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:56:11.248411 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:11.258803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:11.260319 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:11.263384 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:11.265427 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:11.265427 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:56:11.266438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.268553 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:11.269578 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:11.270571 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:56:11.350521 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m19:56:11.354891 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:56:11.356404 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:56:11.356404 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:56:11.357410 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_cars_car_id ........................................... [[32mPASS[0m in 0.11s]
[0m19:56:11.358418 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:11.360432 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:11.360432 [debug] [MainThread]: On master: BEGIN
[0m19:56:11.361439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:11.362442 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:11.363447 [debug] [MainThread]: On master: COMMIT
[0m19:56:11.363447 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:11.364451 [debug] [MainThread]: On master: COMMIT
[0m19:56:11.364451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:11.365459 [debug] [MainThread]: On master: Close
[0m19:56:11.366460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:11.366968 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:56:11.366968 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:56:11.368219 [info ] [MainThread]: 
[0m19:56:11.369227 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m19:56:11.373260 [debug] [MainThread]: Command end result
[0m19:56:11.418735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:11.424311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:11.431997 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:56:11.433007 [info ] [MainThread]: 
[0m19:56:11.434359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:11.435368 [info ] [MainThread]: 
[0m19:56:11.437369 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m19:56:11.439797 [debug] [MainThread]: Command `dbt test` succeeded at 19:56:11.438366 after 2.96 seconds
[0m19:56:11.439797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32FF5C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32FF5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32F74E90>]}
[0m19:56:11.439797 [debug] [MainThread]: Flushing usage events
[0m19:56:12.006579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:34.348253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03037790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB030ABB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB030A9F10>]}


============================== 19:56:34.354438 | 72a257ab-543d-464a-b5b0-52b312a2013f ==============================
[0m19:56:34.354438 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:34.356941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:34.846221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03116C90>]}
[0m19:56:34.970773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFDD8F1D0>]}
[0m19:56:34.977099 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:56:35.494463 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:35.782727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:35.782727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:35.845747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB035E04D0>]}
[0m19:56:35.979548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:35.983631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:36.023038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB0360FC90>]}
[0m19:56:36.024129 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:56:36.026134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF1D0090>]}
[0m19:56:36.028140 [info ] [MainThread]: 
[0m19:56:36.029454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:36.031577 [info ] [MainThread]: 
[0m19:56:36.032848 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:36.041945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m19:56:36.230599 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m19:56:36.231104 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m19:56:36.232109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:36.257541 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:56:36.260542 [debug] [ThreadPool]: On list_database: Close
[0m19:56:36.261543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m19:56:36.263054 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m19:56:36.272322 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:56:36.273321 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m19:56:36.273833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:36.276903 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:56:36.278972 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:56:36.279990 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m19:56:36.281011 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:36.281011 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:56:36.282039 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m19:56:36.283071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:36.284568 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:56:36.285577 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m19:56:36.287009 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m19:56:36.288023 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:36.289198 [debug] [ThreadPool]: On create_database_main: Close
[0m19:56:36.291649 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:56:36.299901 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:36.300921 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:56:36.300921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:36.302296 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:36.303592 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:36.303592 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:56:36.326724 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:56:36.329337 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:56:36.330370 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:56:36.331400 [debug] [ThreadPool]: On list_database_main: Close
[0m19:56:36.333628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB035BF610>]}
[0m19:56:36.334652 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:36.335667 [debug] [MainThread]: On master: BEGIN
[0m19:56:36.335667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:36.337180 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:36.339246 [debug] [MainThread]: On master: COMMIT
[0m19:56:36.340268 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:36.340268 [debug] [MainThread]: On master: COMMIT
[0m19:56:36.342340 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:36.343363 [debug] [MainThread]: On master: Close
[0m19:56:36.349577 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m19:56:36.350664 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m19:56:36.352714 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m19:56:36.353729 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m19:56:36.361766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m19:56:36.363790 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m19:56:36.405940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m19:56:36.406956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.409605 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m19:56:36.410639 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:36.413224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:36.413224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.414494 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m19:56:36.415513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.425847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.427083 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m19:56:36.428100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:36.433212 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.433717 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m19:56:36.434746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:36.452301 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:56:36.452301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.453314 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m19:56:36.484855 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m19:56:36.493485 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m19:56:36.494516 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m19:56:36.497045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.500128 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m19:56:36.503232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03C2BCD0>]}
[0m19:56:36.505918 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.15s]
[0m19:56:36.506936 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m19:56:36.507927 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m19:56:36.509080 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m19:56:36.511730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m19:56:36.513922 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m19:56:36.519508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m19:56:36.521944 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m19:56:36.529343 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m19:56:36.530395 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.531405 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m19:56:36.532406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:36.533895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.535313 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.536341 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
),

-- Esta etapa usa ROW_NUMBER para numerar linhas que são completamente idênticas,
-- garantindo um desempate para a criação da chave primária.
source_ranked AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY
                "Manufacturer",
                "Model",
                "Year of manufacture",
                "Mileage",
                "Fuel type",
                "Engine size",
                "Price"
            ORDER BY
                (SELECT NULL) -- A ordem não é relevante, apenas o número sequencial.
        ) as duplicate_rank
    FROM source
)

SELECT
    -- A chave primária agora inclui o 'duplicate_rank' para garantir 100% de unicidade.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price" || '-' ||
        duplicate_rank
    )) AS car_id,

    -- Renomeação e conversão de tipos das colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Cálculo da idade do veículo
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source_ranked
  );

[0m19:56:36.538888 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:36.545335 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.546336 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m19:56:36.547335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:36.552882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.554207 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m19:56:36.555221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.558671 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:56:36.559692 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.561121 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m19:56:36.563147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.567301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m19:56:36.568332 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m19:56:36.570378 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.572935 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m19:56:36.573956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03C41350>]}
[0m19:56:36.575971 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.06s]
[0m19:56:36.578153 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m19:56:36.579156 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:56:36.580575 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m19:56:36.582527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m19:56:36.583569 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m19:56:36.593149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.595516 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m19:56:36.618540 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.621047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.622051 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m19:56:36.622051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:36.623558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.626165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.627589 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m19:56:36.700519 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m19:56:36.704545 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.705547 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m19:56:36.707836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.712880 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.713885 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m19:56:36.714892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:36.721428 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:56:36.722466 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.722466 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m19:56:36.752195 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m19:56:36.754708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m19:56:36.756122 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m19:56:36.759236 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:36.761294 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m19:56:36.762326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03711810>]}
[0m19:56:36.763852 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.18s]
[0m19:56:36.764916 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m19:56:36.764916 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m19:56:36.765947 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m19:56:36.768036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m19:56:36.768036 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m19:56:36.772091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m19:56:36.773129 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m19:56:36.778027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m19:56:36.780082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.781112 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m19:56:36.781112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:36.783412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.784438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.785439 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m19:56:36.850326 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:56:36.854341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.855345 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m19:56:36.856751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:36.863022 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.864025 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m19:56:36.865028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:36.867440 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:56:36.867440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.868444 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m19:56:36.928275 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m19:56:36.932568 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m19:56:36.933776 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m19:56:36.935923 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:36.937957 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m19:56:36.939064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a257ab-543d-464a-b5b0-52b312a2013f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03C93050>]}
[0m19:56:36.941077 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.17s]
[0m19:56:36.942084 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m19:56:36.945109 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:36.945616 [debug] [MainThread]: On master: BEGIN
[0m19:56:36.946625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:36.947789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:36.948342 [debug] [MainThread]: On master: COMMIT
[0m19:56:36.948884 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:36.949418 [debug] [MainThread]: On master: COMMIT
[0m19:56:36.950482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:36.951011 [debug] [MainThread]: On master: Close
[0m19:56:36.952083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:36.952610 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m19:56:36.953148 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:56:36.953704 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m19:56:36.954738 [info ] [MainThread]: 
[0m19:56:36.956863 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m19:56:36.959546 [debug] [MainThread]: Command end result
[0m19:56:37.009868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:37.015436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:37.022131 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:56:37.023644 [info ] [MainThread]: 
[0m19:56:37.025728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:37.026797 [info ] [MainThread]: 
[0m19:56:37.027803 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:56:37.030466 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:37.028958 after 2.82 seconds
[0m19:56:37.030466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFCFF5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFCF74E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFCF74ED0>]}
[0m19:56:37.031595 [debug] [MainThread]: Flushing usage events
[0m19:56:37.546111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:43.484173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984A27F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984DC6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984D81F10>]}


============================== 19:56:43.489457 | ea48daa2-5b11-4265-8cb0-d7221a96571d ==============================
[0m19:56:43.489457 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:43.491495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:56:43.839498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013986049290>]}
[0m19:56:43.932850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984F01E10>]}
[0m19:56:43.932850 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:56:44.360229 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:44.636188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:44.639432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:44.692367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984E61CD0>]}
[0m19:56:44.810162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:44.812299 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:44.916429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001398603D310>]}
[0m19:56:44.916429 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m19:56:44.923989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001398633FCD0>]}
[0m19:56:44.925491 [info ] [MainThread]: 
[0m19:56:44.925491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:44.929459 [info ] [MainThread]: 
[0m19:56:44.931745 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:44.936764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m19:56:45.050102 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:45.052400 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m19:56:45.052400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:45.105202 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:56:45.105202 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m19:56:45.105202 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m19:56:45.126791 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:56:45.130134 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m19:56:45.130134 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m19:56:45.133146 [debug] [ThreadPool]: On list_database_main: Close
[0m19:56:45.133544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea48daa2-5b11-4265-8cb0-d7221a96571d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139860CC550>]}
[0m19:56:45.137455 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:45.137455 [debug] [MainThread]: On master: BEGIN
[0m19:56:45.137455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:45.140063 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:45.140063 [debug] [MainThread]: On master: COMMIT
[0m19:56:45.141538 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:45.141538 [debug] [MainThread]: On master: COMMIT
[0m19:56:45.143106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:45.143106 [debug] [MainThread]: On master: Close
[0m19:56:45.147757 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:45.149995 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m19:56:45.152219 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:56:45.153224 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:45.171453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:45.171453 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:45.200477 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:45.201489 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:45.201489 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m19:56:45.201489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:45.206008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.206008 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m19:56:45.206008 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m19:56:45.211999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:45.214198 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m19:56:45.218354 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m19:56:45.219799 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m19:56:45.219799 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.07s]
[0m19:56:45.222722 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m19:56:45.222722 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:45.222722 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m19:56:45.225856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m19:56:45.225856 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:45.235024 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:45.237002 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:45.238646 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:45.242764 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:45.244471 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m19:56:45.244471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.244471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.244471 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m19:56:45.244471 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m19:56:45.254450 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:56:45.259404 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m19:56:45.259404 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m19:56:45.259404 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m19:56:45.259404 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.04s]
[0m19:56:45.263244 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m19:56:45.265254 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:45.266778 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m19:56:45.268871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m19:56:45.270696 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:45.292429 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:45.292429 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:45.297268 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:45.297268 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:45.300115 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: BEGIN
[0m19:56:45.302705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.302705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.302705 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m19:56:45.306187 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and car_age_years >= 0 and car_age_years <= 100
)
 as expression


    from "database"."main"."stg_cars"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:56:45.309380 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:45.309380 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: ROLLBACK
[0m19:56:45.309380 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2'
[0m19:56:45.309380 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: Close
[0m19:56:45.309380 [info ] [Thread-1 (]: 3 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[32mPASS[0m in 0.04s]
[0m19:56:45.309380 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m19:56:45.316607 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:45.318851 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m19:56:45.320575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m19:56:45.323392 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:45.329441 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:45.331538 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:45.337113 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:45.339812 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:45.339812 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: BEGIN
[0m19:56:45.339812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.339812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.339812 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m19:56:45.345981 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price_eur >= 0
)
 as expression


    from "database"."main"."stg_cars"
    where
        price_eur >= 0
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:56:45.350684 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:56:45.353779 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: ROLLBACK
[0m19:56:45.353779 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617'
[0m19:56:45.356808 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: Close
[0m19:56:45.358816 [info ] [Thread-1 (]: 4 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[32mPASS[0m in 0.04s]
[0m19:56:45.358816 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m19:56:45.361322 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:45.361322 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m19:56:45.361322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m19:56:45.361322 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:45.372127 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:45.375074 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:45.379364 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:45.382402 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:45.382402 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m19:56:45.383978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.385730 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:45.388449 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m19:56:45.388954 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.391600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.394486 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m19:56:45.394486 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m19:56:45.394486 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m19:56:45.394486 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m19:56:45.397439 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m19:56:45.397439 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:45.400234 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m19:56:45.401779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m19:56:45.404509 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:45.409992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:45.411353 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:45.414531 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:45.417337 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:45.418346 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m19:56:45.421203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.422654 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:45.425071 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m19:56:45.425071 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.426821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.429687 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m19:56:45.429687 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m19:56:45.431025 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m19:56:45.431025 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m19:56:45.433608 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m19:56:45.433608 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:45.436158 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m19:56:45.437107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m19:56:45.438987 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:45.441798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:45.441798 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:45.448311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:45.452436 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:45.454486 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m19:56:45.454486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.457209 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:45.458747 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m19:56:45.458747 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.460880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.460880 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m19:56:45.460880 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m19:56:45.460880 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m19:56:45.465441 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.03s]
[0m19:56:45.467985 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m19:56:45.467985 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:45.470535 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m19:56:45.472544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m19:56:45.475015 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:45.480816 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:45.480816 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:45.487962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:45.489477 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:45.489477 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m19:56:45.492359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.492938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.492938 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m19:56:45.492938 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.496125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.496125 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m19:56:45.496125 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m19:56:45.500139 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m19:56:45.503405 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.03s]
[0m19:56:45.503405 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m19:56:45.505552 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:45.505552 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m19:56:45.505552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m19:56:45.508651 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:45.512963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:45.512963 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:45.523995 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:45.525904 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:45.526927 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m19:56:45.527944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.528971 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.528971 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m19:56:45.529999 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.531031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.533570 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m19:56:45.535655 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m19:56:45.537543 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m19:56:45.539152 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m19:56:45.541205 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m19:56:45.542433 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:45.543451 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m19:56:45.544444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m19:56:45.544444 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:45.549547 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:45.553349 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:45.559294 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:45.560884 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:45.560884 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m19:56:45.560884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.563043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.564055 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m19:56:45.564055 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.642832 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m19:56:45.649100 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m19:56:45.649100 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m19:56:45.650469 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m19:56:45.650469 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.11s]
[0m19:56:45.654522 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m19:56:45.654522 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:45.656538 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m19:56:45.656538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m19:56:45.656538 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:45.665646 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:45.665646 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:45.671046 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:45.672819 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:45.674194 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m19:56:45.674194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.674194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.674194 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m19:56:45.674194 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.680206 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:45.682285 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m19:56:45.682285 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m19:56:45.682285 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m19:56:45.684855 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m19:56:45.687930 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m19:56:45.687930 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:45.687930 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m19:56:45.687930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m19:56:45.687930 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:45.696861 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:45.698582 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:45.703879 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:45.705986 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:45.705986 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m19:56:45.705986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.710010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.710010 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m19:56:45.711759 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m19:56:45.713199 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:45.716357 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m19:56:45.720079 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m19:56:45.720079 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m19:56:45.725856 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.04s]
[0m19:56:45.727908 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m19:56:45.727908 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:45.730445 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m19:56:45.733137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m19:56:45.734282 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:45.744430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:45.746172 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:45.750402 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:45.753063 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:45.753593 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m19:56:45.754848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.756446 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:45.757516 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m19:56:45.758050 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:56:45.772135 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:56:45.774932 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m19:56:45.775993 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m19:56:45.776515 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m19:56:45.777546 [info ] [Thread-1 (]: 13 of 14 PASS unique_car_mileage_segments_car_id ............................... [[32mPASS[0m in 0.05s]
[0m19:56:45.778579 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m19:56:45.778579 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:45.780628 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m19:56:45.782175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m19:56:45.782709 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:45.788875 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:45.788875 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:45.801767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:45.804882 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:45.806722 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m19:56:45.809177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:45.809177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:45.809177 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m19:56:45.809177 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:56:45.893481 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m19:56:45.894485 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m19:56:45.899589 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m19:56:45.901597 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m19:56:45.901597 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_cars_car_id ........................................... [[32mPASS[0m in 0.12s]
[0m19:56:45.901597 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m19:56:45.905261 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:45.906736 [debug] [MainThread]: On master: BEGIN
[0m19:56:45.906736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:45.908742 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:45.908742 [debug] [MainThread]: On master: COMMIT
[0m19:56:45.908742 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:45.910553 [debug] [MainThread]: On master: COMMIT
[0m19:56:45.910553 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:45.911724 [debug] [MainThread]: On master: Close
[0m19:56:45.911724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:45.911724 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m19:56:45.911724 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m19:56:45.914296 [info ] [MainThread]: 
[0m19:56:45.914296 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m19:56:45.918835 [debug] [MainThread]: Command end result
[0m19:56:45.964704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m19:56:45.969157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m19:56:45.974283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m19:56:45.974283 [info ] [MainThread]: 
[0m19:56:45.979796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:45.980845 [info ] [MainThread]: 
[0m19:56:45.980845 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m19:56:45.980845 [debug] [MainThread]: Command `dbt test` succeeded at 19:56:45.980845 after 2.61 seconds
[0m19:56:45.984194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984A38050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013984C15150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013980005690>]}
[0m19:56:45.984194 [debug] [MainThread]: Flushing usage events
[0m19:56:46.543178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:41.566275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B3DD950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B424110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B3DE810>]}


============================== 20:00:41.574334 | 45c25c2f-20d1-4f15-a8d6-a6cebfb67117 ==============================
[0m20:00:41.574334 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:00:41.574334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:00:42.041484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B556390>]}
[0m20:00:42.177636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D67146BD0>]}
[0m20:00:42.182663 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:00:42.760685 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:00:43.142442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:43.142442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:43.217004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D69520590>]}
[0m20:00:43.440654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m20:00:43.445106 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m20:00:43.477073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BBE2790>]}
[0m20:00:43.477073 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m20:00:43.480914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BB1C6D0>]}
[0m20:00:43.483527 [info ] [MainThread]: 
[0m20:00:43.484564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:43.486574 [info ] [MainThread]: 
[0m20:00:43.487525 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:00:43.497716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:00:43.630809 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:00:43.631833 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:00:43.631833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:43.674322 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m20:00:43.676865 [debug] [ThreadPool]: On list_database: Close
[0m20:00:43.677867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:00:43.679298 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:00:43.688240 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:00:43.690781 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:00:43.692152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:43.694627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:00:43.697141 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:00:43.698176 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:00:43.699179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:00:43.699179 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:00:43.700179 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:00:43.701181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:00:43.703181 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:00:43.704181 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:00:43.705656 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:00:43.706665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:00:43.709189 [debug] [ThreadPool]: On create_database_main: Close
[0m20:00:43.711212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:00:43.719395 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:00:43.720712 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:00:43.721833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:43.724077 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:00:43.725087 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:00:43.726080 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:00:43.750518 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:00:43.752027 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:00:43.754320 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:00:43.756366 [debug] [ThreadPool]: On list_database_main: Close
[0m20:00:43.758839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BEB4B90>]}
[0m20:00:43.760221 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:43.760221 [debug] [MainThread]: On master: BEGIN
[0m20:00:43.761223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:43.762719 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:43.763738 [debug] [MainThread]: On master: COMMIT
[0m20:00:43.764752 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:43.764752 [debug] [MainThread]: On master: COMMIT
[0m20:00:43.766191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:43.766191 [debug] [MainThread]: On master: Close
[0m20:00:43.774017 [debug] [Thread-1 (]: Began running node model.dbt_project.bronze
[0m20:00:43.775027 [info ] [Thread-1 (]: 1 of 4 START sql view model main.bronze ........................................ [RUN]
[0m20:00:43.776255 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.bronze'
[0m20:00:43.777427 [debug] [Thread-1 (]: Began compiling node model.dbt_project.bronze
[0m20:00:43.784424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.bronze"
[0m20:00:43.787470 [debug] [Thread-1 (]: Began executing node model.dbt_project.bronze
[0m20:00:43.827938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.bronze"
[0m20:00:43.829079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.830096 [debug] [Thread-1 (]: On model.dbt_project.bronze: BEGIN
[0m20:00:43.831091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:43.832384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.832384 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.833397 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

  
  create view "database"."main"."bronze__dbt_tmp" as (
    SELECT
  *,
  'teste' AS teste
FROM input
  );

[0m20:00:43.834457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.844102 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.845127 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze" rename to "bronze__dbt_backup"
[0m20:00:43.846635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.851729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.852730 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */
alter view "database"."main"."bronze__dbt_tmp" rename to "bronze"
[0m20:00:43.853801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.869018 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m20:00:43.870418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.871426 [debug] [Thread-1 (]: On model.dbt_project.bronze: COMMIT
[0m20:00:43.895398 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:00:43.904017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.bronze"
[0m20:00:43.906421 [debug] [Thread-1 (]: On model.dbt_project.bronze: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.bronze"} */

      drop view if exists "database"."main"."bronze__dbt_backup" cascade
    
[0m20:00:43.909438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:43.912947 [debug] [Thread-1 (]: On model.dbt_project.bronze: Close
[0m20:00:43.914947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BFB83D0>]}
[0m20:00:43.915948 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.bronze ................................... [[32mOK[0m in 0.14s]
[0m20:00:43.916948 [debug] [Thread-1 (]: Finished running node model.dbt_project.bronze
[0m20:00:43.917951 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_cars
[0m20:00:43.918953 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_cars ...................................... [RUN]
[0m20:00:43.920950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.bronze, now model.dbt_project.stg_cars)
[0m20:00:43.922390 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_cars
[0m20:00:43.927970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_cars"
[0m20:00:43.928997 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_cars
[0m20:00:43.933876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_cars"
[0m20:00:43.935921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.937386 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: BEGIN
[0m20:00:43.937386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:43.940078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:43.940078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.941107 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

  
  create view "database"."main"."stg_cars__dbt_tmp" as (
    -- models/silver/stg_cars.sql

WITH source AS (
    SELECT * FROM "database"."bronze"."raw_cars"
),

-- Esta etapa usa ROW_NUMBER para numerar linhas que são completamente idênticas,
-- garantindo um desempate para a criação da chave primária.
source_ranked AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY
                "Manufacturer",
                "Model",
                "Year of manufacture",
                "Mileage",
                "Fuel type",
                "Engine size",
                "Price"
            ORDER BY
                (SELECT NULL) -- A ordem não é relevante, apenas o número sequencial.
        ) as duplicate_rank
    FROM source
)

SELECT
    -- A chave primária agora inclui o 'duplicate_rank' para garantir 100% de unicidade.
    hex(md5(
        "Manufacturer" || '-' ||
        "Model" || '-' ||
        "Year of manufacture" || '-' ||
        "Mileage" || '-' ||
        "Fuel type" || '-' ||
        "Engine size" || '-' ||
        "Price" || '-' ||
        duplicate_rank
    )) AS car_id,

    -- Renomeação e conversão de tipos das colunas
    "Manufacturer" AS manufacturer,
    "Model" AS model,
    "Fuel type" AS fuel_type,
    CAST("Engine size" AS DOUBLE) AS engine_size_liters,
    CAST("Year of manufacture" AS INTEGER) AS year_of_manufacture,
    CAST(Mileage AS BIGINT) AS mileage,
    CAST(Price AS DECIMAL(18,2)) AS price_eur,

    -- Cálculo da idade do veículo
    EXTRACT(YEAR FROM CURRENT_DATE) - CAST("Year of manufacture" AS INTEGER) AS car_age_years

FROM source_ranked
  );

[0m20:00:43.944364 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:43.948459 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.948459 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars" rename to "stg_cars__dbt_backup"
[0m20:00:43.949861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:00:43.955548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.956568 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */
alter view "database"."main"."stg_cars__dbt_tmp" rename to "stg_cars"
[0m20:00:43.957979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.961253 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m20:00:43.961253 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.962272 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: COMMIT
[0m20:00:43.965104 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:43.968310 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_cars"
[0m20:00:43.969346 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_cars"} */

      drop view if exists "database"."main"."stg_cars__dbt_backup" cascade
    
[0m20:00:43.971760 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:43.975611 [debug] [Thread-1 (]: On model.dbt_project.stg_cars: Close
[0m20:00:43.976618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B66B510>]}
[0m20:00:43.977635 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.stg_cars ................................. [[32mOK[0m in 0.06s]
[0m20:00:43.977635 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_cars
[0m20:00:43.979022 [debug] [Thread-1 (]: Began running node model.dbt_project.avg_price_by_manufacturer_year
[0m20:00:43.980485 [info ] [Thread-1 (]: 3 of 4 START sql table model main.avg_price_by_manufacturer_year ............... [RUN]
[0m20:00:43.981502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_cars, now model.dbt_project.avg_price_by_manufacturer_year)
[0m20:00:43.982509 [debug] [Thread-1 (]: Began compiling node model.dbt_project.avg_price_by_manufacturer_year
[0m20:00:43.987121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:43.990330 [debug] [Thread-1 (]: Began executing node model.dbt_project.avg_price_by_manufacturer_year
[0m20:00:44.014631 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.015632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.017137 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: BEGIN
[0m20:00:44.018221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.020256 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.021418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.023749 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

  
    
    

    create  table
      "database"."main"."avg_price_by_manufacturer_year__dbt_tmp"
  
    as (
      -- models/gold/avg_price_by_manufacturer_year.sql

SELECT
    manufacturer,
    year_of_manufacture,
    COUNT(car_id) AS total_cars,
    ROUND(AVG(price_eur), 2) AS average_price_eur
FROM
    "database"."main"."stg_cars"
GROUP BY
    manufacturer,
    year_of_manufacture
ORDER BY
    manufacturer,
    year_of_manufacture DESC
    );
  
  
[0m20:00:44.213584 [debug] [Thread-1 (]: SQL status: OK in 0.190 seconds
[0m20:00:44.223537 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.224543 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year" rename to "avg_price_by_manufacturer_year__dbt_backup"
[0m20:00:44.230320 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:00:44.235364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.237365 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */
alter table "database"."main"."avg_price_by_manufacturer_year__dbt_tmp" rename to "avg_price_by_manufacturer_year"
[0m20:00:44.238362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.247197 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m20:00:44.248206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.249212 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: COMMIT
[0m20:00:44.251757 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.255833 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.avg_price_by_manufacturer_year"
[0m20:00:44.256867 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.avg_price_by_manufacturer_year"} */

      drop table if exists "database"."main"."avg_price_by_manufacturer_year__dbt_backup" cascade
    
[0m20:00:44.260037 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.262547 [debug] [Thread-1 (]: On model.dbt_project.avg_price_by_manufacturer_year: Close
[0m20:00:44.263590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BF083D0>]}
[0m20:00:44.264595 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.avg_price_by_manufacturer_year .......... [[32mOK[0m in 0.28s]
[0m20:00:44.264595 [debug] [Thread-1 (]: Finished running node model.dbt_project.avg_price_by_manufacturer_year
[0m20:00:44.265599 [debug] [Thread-1 (]: Began running node model.dbt_project.car_mileage_segments
[0m20:00:44.266607 [info ] [Thread-1 (]: 4 of 4 START sql table model main.car_mileage_segments ......................... [RUN]
[0m20:00:44.267616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.avg_price_by_manufacturer_year, now model.dbt_project.car_mileage_segments)
[0m20:00:44.269063 [debug] [Thread-1 (]: Began compiling node model.dbt_project.car_mileage_segments
[0m20:00:44.272087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.car_mileage_segments"
[0m20:00:44.274679 [debug] [Thread-1 (]: Began executing node model.dbt_project.car_mileage_segments
[0m20:00:44.279726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.car_mileage_segments"
[0m20:00:44.280734 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.281745 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: BEGIN
[0m20:00:44.282763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.283759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.284266 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.285275 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

  
    
    

    create  table
      "database"."main"."car_mileage_segments__dbt_tmp"
  
    as (
      -- models/gold/car_mileage_segments.sql

SELECT
    car_id,
    manufacturer,
    model,
    year_of_manufacture,
    mileage,
    price_eur,
    CASE
        WHEN mileage <= 40000 THEN 'Baixa KM'
        WHEN mileage > 40000 AND mileage <= 100000 THEN 'Média KM'
        ELSE 'Alta KM'
    END AS mileage_segment
FROM
    "database"."main"."stg_cars"
    );
  
  
[0m20:00:44.354080 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m20:00:44.358609 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.359660 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments" rename to "car_mileage_segments__dbt_backup"
[0m20:00:44.361683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.365764 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.365764 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */
alter table "database"."main"."car_mileage_segments__dbt_tmp" rename to "car_mileage_segments"
[0m20:00:44.367111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:00:44.370631 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m20:00:44.370631 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.371658 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: COMMIT
[0m20:00:44.403268 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m20:00:44.406341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.car_mileage_segments"
[0m20:00:44.407381 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "model.dbt_project.car_mileage_segments"} */

      drop table if exists "database"."main"."car_mileage_segments__dbt_backup" cascade
    
[0m20:00:44.409438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.411980 [debug] [Thread-1 (]: On model.dbt_project.car_mileage_segments: Close
[0m20:00:44.411980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c25c2f-20d1-4f15-a8d6-a6cebfb67117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B8E3010>]}
[0m20:00:44.414063 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.car_mileage_segments .................... [[32mOK[0m in 0.14s]
[0m20:00:44.414063 [debug] [Thread-1 (]: Finished running node model.dbt_project.car_mileage_segments
[0m20:00:44.416570 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:44.417585 [debug] [MainThread]: On master: BEGIN
[0m20:00:44.417585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:44.419613 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:00:44.421643 [debug] [MainThread]: On master: COMMIT
[0m20:00:44.422642 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:44.422642 [debug] [MainThread]: On master: COMMIT
[0m20:00:44.423997 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:44.425008 [debug] [MainThread]: On master: Close
[0m20:00:44.426027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:44.427036 [debug] [MainThread]: Connection 'create_database_main' was properly closed.
[0m20:00:44.427036 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m20:00:44.428043 [debug] [MainThread]: Connection 'model.dbt_project.car_mileage_segments' was properly closed.
[0m20:00:44.428043 [info ] [MainThread]: 
[0m20:00:44.429059 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m20:00:44.431234 [debug] [MainThread]: Command end result
[0m20:00:44.478245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m20:00:44.482358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m20:00:44.489474 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m20:00:44.490483 [info ] [MainThread]: 
[0m20:00:44.490987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:44.490987 [info ] [MainThread]: 
[0m20:00:44.492010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:00:44.494260 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 20:00:44.494260 after 3.12 seconds
[0m20:00:44.495284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B0D6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B3CF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B3CEB90>]}
[0m20:00:44.495284 [debug] [MainThread]: Flushing usage events
[0m20:00:45.153687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:49.652971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D7E00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D7D2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D857410>]}


============================== 20:00:49.657975 | 7e6acfe7-ca4e-493d-9f3f-db46781ae2c6 ==============================
[0m20:00:49.657975 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:00:49.658976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\wes\\Documents\\New folder\\csv-duckbd-dbt\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:00:50.020856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D8AE190>]}
[0m20:00:50.126255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B683CEDD0>]}
[0m20:00:50.130582 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:00:50.581533 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:00:50.916797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:50.919384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:50.977362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6DE83010>]}
[0m20:00:51.178572 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m20:00:51.186101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m20:00:51.251273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D9C0310>]}
[0m20:00:51.253508 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 695 macros
[0m20:00:51.253508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6DCD84D0>]}
[0m20:00:51.256925 [info ] [MainThread]: 
[0m20:00:51.257952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:51.257952 [info ] [MainThread]: 
[0m20:00:51.258936 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:00:51.267693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:00:51.373589 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:00:51.373589 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:00:51.374614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:51.409997 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m20:00:51.409997 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:00:51.411168 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:00:51.432890 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:00:51.436068 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:00:51.438225 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:00:51.438225 [debug] [ThreadPool]: On list_database_main: Close
[0m20:00:51.442155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e6acfe7-ca4e-493d-9f3f-db46781ae2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6DD78090>]}
[0m20:00:51.443412 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:51.443412 [debug] [MainThread]: On master: BEGIN
[0m20:00:51.444417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:51.445703 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:51.446830 [debug] [MainThread]: On master: COMMIT
[0m20:00:51.446830 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:51.448255 [debug] [MainThread]: On master: COMMIT
[0m20:00:51.450458 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:51.450458 [debug] [MainThread]: On master: Close
[0m20:00:51.457114 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m20:00:51.458162 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [RUN]
[0m20:00:51.459319 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m20:00:51.460336 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m20:00:51.481687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m20:00:51.483715 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m20:00:51.509329 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m20:00:51.511368 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m20:00:51.513415 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: BEGIN
[0m20:00:51.514413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:51.516983 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:51.518000 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"
[0m20:00:51.519341 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        mileage_segment as value_field,
        count(*) as n_records

    from "database"."main"."car_mileage_segments"
    group by mileage_segment

)

select *
from all_values
where value_field not in (
    'Baixa KM','Média KM','Alta KM'
)



  
  
      
    ) dbt_internal_test
[0m20:00:51.540606 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:00:51.544608 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: ROLLBACK
[0m20:00:51.547632 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43'
[0m20:00:51.547632 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43: Close
[0m20:00:51.547632 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM  [[32mPASS[0m in 0.09s]
[0m20:00:51.550988 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43
[0m20:00:51.550988 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m20:00:51.550988 [info ] [Thread-1 (]: 2 of 14 START test accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid .. [RUN]
[0m20:00:51.554552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_car_mileage_segments_mileage_segment__Baixa_KM__M_dia_KM__Alta_KM.d7936d5f43, now test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6)
[0m20:00:51.554552 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m20:00:51.562489 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m20:00:51.564907 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m20:00:51.572567 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m20:00:51.572567 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m20:00:51.574574 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: BEGIN
[0m20:00:51.574574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.576581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.576581 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"
[0m20:00:51.576581 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        fuel_type as value_field,
        count(*) as n_records

    from "database"."main"."stg_cars"
    group by fuel_type

)

select *
from all_values
where value_field not in (
    'Petrol','Diesel','Hybrid'
)



  
  
      
    ) dbt_internal_test
[0m20:00:51.582687 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:00:51.588284 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: ROLLBACK
[0m20:00:51.588284 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6'
[0m20:00:51.588284 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6: Close
[0m20:00:51.590342 [info ] [Thread-1 (]: 2 of 14 PASS accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid ........ [[32mPASS[0m in 0.04s]
[0m20:00:51.590342 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6
[0m20:00:51.590342 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m20:00:51.590342 [info ] [Thread-1 (]: 3 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [RUN]
[0m20:00:51.594212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_stg_cars_fuel_type__Petrol__Diesel__Hybrid.996914f1e6, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2)
[0m20:00:51.595541 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m20:00:51.616439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m20:00:51.618446 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m20:00:51.622470 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m20:00:51.624497 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m20:00:51.624497 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: BEGIN
[0m20:00:51.626502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.627518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.627518 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"
[0m20:00:51.629825 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and car_age_years >= 0 and car_age_years <= 100
)
 as expression


    from "database"."main"."stg_cars"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m20:00:51.633095 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:00:51.635656 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: ROLLBACK
[0m20:00:51.635656 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2'
[0m20:00:51.639911 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2: Close
[0m20:00:51.639911 [info ] [Thread-1 (]: 3 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0  [[32mPASS[0m in 0.05s]
[0m20:00:51.641560 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2
[0m20:00:51.641560 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m20:00:51.641560 [info ] [Thread-1 (]: 4 of 14 START test dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [RUN]
[0m20:00:51.643573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_car_age_years__100__0.bd9895dbe2, now test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617)
[0m20:00:51.643573 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m20:00:51.652044 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m20:00:51.654551 [debug] [Thread-1 (]: Began executing node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m20:00:51.656575 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m20:00:51.656575 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m20:00:51.660265 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: BEGIN
[0m20:00:51.662167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.664243 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:51.665250 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"
[0m20:00:51.667083 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price_eur >= 0
)
 as expression


    from "database"."main"."stg_cars"
    where
        price_eur >= 0
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m20:00:51.673428 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:00:51.673428 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: ROLLBACK
[0m20:00:51.676973 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617'
[0m20:00:51.676973 [debug] [Thread-1 (]: On test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617: Close
[0m20:00:51.678898 [info ] [Thread-1 (]: 4 of 14 PASS dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0  [[32mPASS[0m in 0.03s]
[0m20:00:51.678898 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617
[0m20:00:51.680901 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m20:00:51.680901 [info ] [Thread-1 (]: 5 of 14 START test not_null_avg_price_by_manufacturer_year_average_price_eur ... [RUN]
[0m20:00:51.680901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_expectations_expect_column_values_to_be_between_stg_cars_price_eur__0__price_eur_0.4cbd4ef617, now test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644)
[0m20:00:51.684077 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m20:00:51.689903 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m20:00:51.693421 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m20:00:51.700021 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m20:00:51.701911 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m20:00:51.701911 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: BEGIN
[0m20:00:51.701911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.701911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.701911 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"
[0m20:00:51.706351 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select average_price_eur
from "database"."main"."avg_price_by_manufacturer_year"
where average_price_eur is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.707927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.710037 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: ROLLBACK
[0m20:00:51.710037 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644'
[0m20:00:51.710037 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644: Close
[0m20:00:51.712250 [info ] [Thread-1 (]: 5 of 14 PASS not_null_avg_price_by_manufacturer_year_average_price_eur ......... [[32mPASS[0m in 0.03s]
[0m20:00:51.712250 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644
[0m20:00:51.715525 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m20:00:51.715525 [info ] [Thread-1 (]: 6 of 14 START test not_null_avg_price_by_manufacturer_year_manufacturer ........ [RUN]
[0m20:00:51.715525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_average_price_eur.27b1d1e644, now test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a)
[0m20:00:51.718547 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m20:00:51.722540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m20:00:51.727077 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m20:00:51.733971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m20:00:51.735484 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m20:00:51.735484 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: BEGIN
[0m20:00:51.735484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.738445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.739963 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"
[0m20:00:51.739963 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."avg_price_by_manufacturer_year"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.742008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.744202 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: ROLLBACK
[0m20:00:51.745610 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a'
[0m20:00:51.745610 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a: Close
[0m20:00:51.745610 [info ] [Thread-1 (]: 6 of 14 PASS not_null_avg_price_by_manufacturer_year_manufacturer .............. [[32mPASS[0m in 0.03s]
[0m20:00:51.749538 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a
[0m20:00:51.750559 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m20:00:51.751581 [info ] [Thread-1 (]: 7 of 14 START test not_null_avg_price_by_manufacturer_year_year_of_manufacture . [RUN]
[0m20:00:51.751581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_manufacturer.85d886093a, now test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2)
[0m20:00:51.751581 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m20:00:51.755724 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m20:00:51.759830 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m20:00:51.764850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m20:00:51.766869 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m20:00:51.767881 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: BEGIN
[0m20:00:51.767881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.767881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.771824 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"
[0m20:00:51.771824 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year_of_manufacture
from "database"."main"."avg_price_by_manufacturer_year"
where year_of_manufacture is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.771824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.775909 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: ROLLBACK
[0m20:00:51.775909 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2'
[0m20:00:51.775909 [debug] [Thread-1 (]: On test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2: Close
[0m20:00:51.775909 [info ] [Thread-1 (]: 7 of 14 PASS not_null_avg_price_by_manufacturer_year_year_of_manufacture ....... [[32mPASS[0m in 0.02s]
[0m20:00:51.778973 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2
[0m20:00:51.781743 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m20:00:51.782251 [info ] [Thread-1 (]: 8 of 14 START test not_null_car_mileage_segments_car_id ........................ [RUN]
[0m20:00:51.784000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_avg_price_by_manufacturer_year_year_of_manufacture.72c17215e2, now test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb)
[0m20:00:51.784000 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m20:00:51.790019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m20:00:51.795618 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m20:00:51.800162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m20:00:51.803683 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m20:00:51.803683 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: BEGIN
[0m20:00:51.803683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.806787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.806787 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"
[0m20:00:51.808614 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."car_mileage_segments"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.808614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.814384 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: ROLLBACK
[0m20:00:51.830491 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb'
[0m20:00:51.832242 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb: Close
[0m20:00:51.833671 [info ] [Thread-1 (]: 8 of 14 PASS not_null_car_mileage_segments_car_id .............................. [[32mPASS[0m in 0.05s]
[0m20:00:51.835680 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb
[0m20:00:51.835680 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m20:00:51.837873 [info ] [Thread-1 (]: 9 of 14 START test not_null_car_mileage_segments_mileage_segment ............... [RUN]
[0m20:00:51.839240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_car_id.9b0807c9bb, now test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f)
[0m20:00:51.840343 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m20:00:51.842667 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m20:00:51.848597 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m20:00:51.852766 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m20:00:51.852766 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m20:00:51.852766 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: BEGIN
[0m20:00:51.857083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.857083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.858686 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"
[0m20:00:51.858686 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mileage_segment
from "database"."main"."car_mileage_segments"
where mileage_segment is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.860203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.863411 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: ROLLBACK
[0m20:00:51.863411 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f'
[0m20:00:51.865210 [debug] [Thread-1 (]: On test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f: Close
[0m20:00:51.866310 [info ] [Thread-1 (]: 9 of 14 PASS not_null_car_mileage_segments_mileage_segment ..................... [[32mPASS[0m in 0.03s]
[0m20:00:51.867824 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f
[0m20:00:51.869403 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m20:00:51.869403 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_cars_car_id ................................... [RUN]
[0m20:00:51.871377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_car_mileage_segments_mileage_segment.b69540483f, now test.dbt_project.not_null_stg_cars_car_id.54cac9a576)
[0m20:00:51.872382 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m20:00:51.877437 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m20:00:51.878446 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m20:00:51.886105 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m20:00:51.888228 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m20:00:51.889261 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: BEGIN
[0m20:00:51.890304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.891332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.891332 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"
[0m20:00:51.892357 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_car_id.54cac9a576"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_id
from "database"."main"."stg_cars"
where car_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.937352 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m20:00:51.937352 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: ROLLBACK
[0m20:00:51.942669 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_car_id.54cac9a576'
[0m20:00:51.942669 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_car_id.54cac9a576: Close
[0m20:00:51.944413 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_cars_car_id ......................................... [[32mPASS[0m in 0.07s]
[0m20:00:51.945825 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_car_id.54cac9a576
[0m20:00:51.945825 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m20:00:51.945825 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_cars_manufacturer ............................. [RUN]
[0m20:00:51.945825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_car_id.54cac9a576, now test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b)
[0m20:00:51.949880 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m20:00:51.953107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m20:00:51.953107 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m20:00:51.958798 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m20:00:51.962515 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m20:00:51.963559 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: BEGIN
[0m20:00:51.965621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.965621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:51.968029 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"
[0m20:00:51.969808 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturer
from "database"."main"."stg_cars"
where manufacturer is null



  
  
      
    ) dbt_internal_test
[0m20:00:51.972318 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:51.974332 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: ROLLBACK
[0m20:00:51.974332 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b'
[0m20:00:51.977940 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b: Close
[0m20:00:51.977940 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_cars_manufacturer ................................... [[32mPASS[0m in 0.03s]
[0m20:00:51.979095 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b
[0m20:00:51.979095 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m20:00:51.982921 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_cars_model .................................... [RUN]
[0m20:00:51.984937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_manufacturer.1be80ac11b, now test.dbt_project.not_null_stg_cars_model.9522518c9f)
[0m20:00:51.984937 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m20:00:51.986469 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m20:00:51.986469 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m20:00:51.995875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m20:00:51.997435 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m20:00:51.999971 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: BEGIN
[0m20:00:51.999971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:51.999971 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:52.002892 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_cars_model.9522518c9f"
[0m20:00:52.004598 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_cars_model.9522518c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "database"."main"."stg_cars"
where model is null



  
  
      
    ) dbt_internal_test
[0m20:00:52.006498 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:52.008063 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: ROLLBACK
[0m20:00:52.008063 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_cars_model.9522518c9f'
[0m20:00:52.008063 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_cars_model.9522518c9f: Close
[0m20:00:52.008063 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_cars_model .......................................... [[32mPASS[0m in 0.03s]
[0m20:00:52.012455 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_cars_model.9522518c9f
[0m20:00:52.012455 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m20:00:52.012455 [info ] [Thread-1 (]: 13 of 14 START test unique_car_mileage_segments_car_id ......................... [RUN]
[0m20:00:52.012455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_cars_model.9522518c9f, now test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05)
[0m20:00:52.016922 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m20:00:52.021855 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m20:00:52.021855 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m20:00:52.028945 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m20:00:52.030327 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m20:00:52.032335 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: BEGIN
[0m20:00:52.034347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:52.034347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:52.036357 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"
[0m20:00:52.037363 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."car_mileage_segments"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:52.054017 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:00:52.054017 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: ROLLBACK
[0m20:00:52.057464 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05'
[0m20:00:52.057464 [debug] [Thread-1 (]: On test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05: Close
[0m20:00:52.057464 [info ] [Thread-1 (]: 13 of 14 PASS unique_car_mileage_segments_car_id ............................... [[32mPASS[0m in 0.05s]
[0m20:00:52.059727 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05
[0m20:00:52.060756 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m20:00:52.060756 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_cars_car_id ..................................... [RUN]
[0m20:00:52.060756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_car_mileage_segments_car_id.9ea2e8bf05, now test.dbt_project.unique_stg_cars_car_id.7544a8f0e9)
[0m20:00:52.062499 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m20:00:52.070451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m20:00:52.070451 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m20:00:52.076509 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m20:00:52.078515 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m20:00:52.079235 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: BEGIN
[0m20:00:52.081333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:52.081333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:52.083217 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"
[0m20:00:52.083217 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "duckdb_profile", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_cars_car_id.7544a8f0e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    car_id as unique_field,
    count(*) as n_records

from "database"."main"."stg_cars"
where car_id is not null
group by car_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:52.151088 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m20:00:52.155949 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: ROLLBACK
[0m20:00:52.159484 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9'
[0m20:00:52.159484 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_cars_car_id.7544a8f0e9: Close
[0m20:00:52.159484 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_cars_car_id ........................................... [[32mPASS[0m in 0.10s]
[0m20:00:52.159484 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_cars_car_id.7544a8f0e9
[0m20:00:52.163446 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:52.163446 [debug] [MainThread]: On master: BEGIN
[0m20:00:52.166386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:52.167915 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:00:52.167915 [debug] [MainThread]: On master: COMMIT
[0m20:00:52.167915 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:52.167915 [debug] [MainThread]: On master: COMMIT
[0m20:00:52.167915 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:52.167915 [debug] [MainThread]: On master: Close
[0m20:00:52.167915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:52.167915 [debug] [MainThread]: Connection 'list_database_main' was properly closed.
[0m20:00:52.167915 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_cars_car_id.7544a8f0e9' was properly closed.
[0m20:00:52.167915 [info ] [MainThread]: 
[0m20:00:52.167915 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m20:00:52.177042 [debug] [MainThread]: Command end result
[0m20:00:52.232525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\manifest.json
[0m20:00:52.237633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\semantic_manifest.json
[0m20:00:52.246452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\wes\Documents\New folder\csv-duckbd-dbt\dbt_project\target\run_results.json
[0m20:00:52.249468 [info ] [MainThread]: 
[0m20:00:52.249468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:52.251837 [info ] [MainThread]: 
[0m20:00:52.251837 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m20:00:52.251837 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 20:00:52.251837 after 2.74 seconds
[0m20:00:52.255982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D7D2A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D7D3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6D7D2450>]}
[0m20:00:52.255982 [debug] [MainThread]: Flushing usage events
[0m20:00:52.791388 [debug] [MainThread]: An error was encountered while trying to flush usage events
